function DN(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function LN(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var zx={exports:{}},Vc={},qx={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mo=Symbol.for("react.element"),ON=Symbol.for("react.portal"),VN=Symbol.for("react.fragment"),MN=Symbol.for("react.strict_mode"),FN=Symbol.for("react.profiler"),UN=Symbol.for("react.provider"),BN=Symbol.for("react.context"),$N=Symbol.for("react.forward_ref"),zN=Symbol.for("react.suspense"),qN=Symbol.for("react.memo"),WN=Symbol.for("react.lazy"),sg=Symbol.iterator;function HN(t){return t===null||typeof t!="object"?null:(t=sg&&t[sg]||t["@@iterator"],typeof t=="function"?t:null)}var Wx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Hx=Object.assign,Gx={};function ki(t,e,r){this.props=t,this.context=e,this.refs=Gx,this.updater=r||Wx}ki.prototype.isReactComponent={};ki.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ki.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Kx(){}Kx.prototype=ki.prototype;function nm(t,e,r){this.props=t,this.context=e,this.refs=Gx,this.updater=r||Wx}var sm=nm.prototype=new Kx;sm.constructor=nm;Hx(sm,ki.prototype);sm.isPureReactComponent=!0;var ig=Array.isArray,Qx=Object.prototype.hasOwnProperty,im={current:null},Xx={key:!0,ref:!0,__self:!0,__source:!0};function Yx(t,e,r){var n,s={},i=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Qx.call(e,n)&&!Xx.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:mo,type:t,key:i,ref:o,props:s,_owner:im.current}}function GN(t,e){return{$$typeof:mo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function am(t){return typeof t=="object"&&t!==null&&t.$$typeof===mo}function KN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var ag=/\/+/g;function Gu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?KN(""+t.key):e.toString(36)}function El(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case mo:case ON:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+Gu(o,0):n,ig(s)?(r="",t!=null&&(r=t.replace(ag,"$&/")+"/"),El(s,e,r,"",function(d){return d})):s!=null&&(am(s)&&(s=GN(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(ag,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",ig(t))for(var l=0;l<t.length;l++){i=t[l];var u=n+Gu(i,l);o+=El(i,e,r,u,s)}else if(u=HN(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=n+Gu(i,l++),o+=El(i,e,r,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Zo(t,e,r){if(t==null)return t;var n=[],s=0;return El(t,n,"","",function(i){return e.call(r,i,s++)}),n}function QN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Pt={current:null},jl={transition:null},XN={ReactCurrentDispatcher:Pt,ReactCurrentBatchConfig:jl,ReactCurrentOwner:im};function Jx(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:Zo,forEach:function(t,e,r){Zo(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Zo(t,function(){e++}),e},toArray:function(t){return Zo(t,function(e){return e})||[]},only:function(t){if(!am(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=ki;fe.Fragment=VN;fe.Profiler=FN;fe.PureComponent=nm;fe.StrictMode=MN;fe.Suspense=zN;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XN;fe.act=Jx;fe.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Hx({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=im.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Qx.call(e,u)&&!Xx.hasOwnProperty(u)&&(n[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:mo,type:t.type,key:s,ref:i,props:n,_owner:o}};fe.createContext=function(t){return t={$$typeof:BN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:UN,_context:t},t.Consumer=t};fe.createElement=Yx;fe.createFactory=function(t){var e=Yx.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:$N,render:t}};fe.isValidElement=am;fe.lazy=function(t){return{$$typeof:WN,_payload:{_status:-1,_result:t},_init:QN}};fe.memo=function(t,e){return{$$typeof:qN,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=jl.transition;jl.transition={};try{t()}finally{jl.transition=e}};fe.unstable_act=Jx;fe.useCallback=function(t,e){return Pt.current.useCallback(t,e)};fe.useContext=function(t){return Pt.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return Pt.current.useDeferredValue(t)};fe.useEffect=function(t,e){return Pt.current.useEffect(t,e)};fe.useId=function(){return Pt.current.useId()};fe.useImperativeHandle=function(t,e,r){return Pt.current.useImperativeHandle(t,e,r)};fe.useInsertionEffect=function(t,e){return Pt.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return Pt.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return Pt.current.useMemo(t,e)};fe.useReducer=function(t,e,r){return Pt.current.useReducer(t,e,r)};fe.useRef=function(t){return Pt.current.useRef(t)};fe.useState=function(t){return Pt.current.useState(t)};fe.useSyncExternalStore=function(t,e,r){return Pt.current.useSyncExternalStore(t,e,r)};fe.useTransition=function(){return Pt.current.useTransition()};fe.version="18.3.1";qx.exports=fe;var T=qx.exports;const Zx=LN(T),YN=DN({__proto__:null,default:Zx},[T]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JN=T,ZN=Symbol.for("react.element"),eE=Symbol.for("react.fragment"),tE=Object.prototype.hasOwnProperty,rE=JN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nE={key:!0,ref:!0,__self:!0,__source:!0};function ey(t,e,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)tE.call(e,n)&&!nE.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:ZN,type:t,key:i,ref:o,props:s,_owner:rE.current}}Vc.Fragment=eE;Vc.jsx=ey;Vc.jsxs=ey;zx.exports=Vc;var a=zx.exports,Ld={},ty={exports:{}},Yt={},ry={exports:{}},ny={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,H){var q=O.length;O.push(H);e:for(;0<q;){var J=q-1>>>1,A=O[J];if(0<s(A,H))O[J]=H,O[q]=A,q=J;else break e}}function r(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var H=O[0],q=O.pop();if(q!==H){O[0]=q;e:for(var J=0,A=O.length,Q=A>>>1;J<Q;){var ae=2*(J+1)-1,le=O[ae],ee=ae+1,ue=O[ee];if(0>s(le,q))ee<A&&0>s(ue,le)?(O[J]=ue,O[ee]=q,J=ee):(O[J]=le,O[ae]=q,J=ae);else if(ee<A&&0>s(ue,q))O[J]=ue,O[ee]=q,J=ee;else break e}}return H}function s(O,H){var q=O.sortIndex-H.sortIndex;return q!==0?q:O.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],h=1,f=null,p=3,b=!1,_=!1,k=!1,P=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(O){for(var H=r(d);H!==null;){if(H.callback===null)n(d);else if(H.startTime<=O)n(d),H.sortIndex=H.expirationTime,e(u,H);else break;H=r(d)}}function R(O){if(k=!1,S(O),!_)if(r(u)!==null)_=!0,V(M);else{var H=r(d);H!==null&&L(R,H.startTime-O)}}function M(O,H){_=!1,k&&(k=!1,N(x),x=-1),b=!0;var q=p;try{for(S(H),f=r(u);f!==null&&(!(f.expirationTime>H)||O&&!D());){var J=f.callback;if(typeof J=="function"){f.callback=null,p=f.priorityLevel;var A=J(f.expirationTime<=H);H=t.unstable_now(),typeof A=="function"?f.callback=A:f===r(u)&&n(u),S(H)}else n(u);f=r(u)}if(f!==null)var Q=!0;else{var ae=r(d);ae!==null&&L(R,ae.startTime-H),Q=!1}return Q}finally{f=null,p=q,b=!1}}var $=!1,E=null,x=-1,v=5,y=-1;function D(){return!(t.unstable_now()-y<v)}function I(){if(E!==null){var O=t.unstable_now();y=O;var H=!0;try{H=E(!0,O)}finally{H?j():($=!1,E=null)}}else $=!1}var j;if(typeof w=="function")j=function(){w(I)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,B=te.port2;te.port1.onmessage=I,j=function(){B.postMessage(null)}}else j=function(){P(I,0)};function V(O){E=O,$||($=!0,j())}function L(O,H){x=P(function(){O(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){_||b||(_=!0,V(M))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(O){switch(p){case 1:case 2:case 3:var H=3;break;default:H=p}var q=p;p=H;try{return O()}finally{p=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,H){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var q=p;p=O;try{return H()}finally{p=q}},t.unstable_scheduleCallback=function(O,H,q){var J=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?J+q:J):q=J,O){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=q+A,O={id:h++,callback:H,priorityLevel:O,startTime:q,expirationTime:A,sortIndex:-1},q>J?(O.sortIndex=q,e(d,O),r(u)===null&&O===r(d)&&(k?(N(x),x=-1):k=!0,L(R,q-J))):(O.sortIndex=A,e(u,O),_||b||(_=!0,V(M))),O},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(O){var H=p;return function(){var q=p;p=H;try{return O.apply(this,arguments)}finally{p=q}}}})(ny);ry.exports=ny;var sE=ry.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iE=T,Qt=sE;function X(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sy=new Set,Va={};function Es(t,e){di(t,e),di(t+"Capture",e)}function di(t,e){for(Va[t]=e,t=0;t<e.length;t++)sy.add(e[t])}var Hr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Od=Object.prototype.hasOwnProperty,aE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,og={},lg={};function oE(t){return Od.call(lg,t)?!0:Od.call(og,t)?!1:aE.test(t)?lg[t]=!0:(og[t]=!0,!1)}function lE(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function cE(t,e,r,n){if(e===null||typeof e>"u"||lE(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function At(t,e,r,n,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){lt[t]=new At(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];lt[e]=new At(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){lt[t]=new At(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){lt[t]=new At(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){lt[t]=new At(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){lt[t]=new At(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){lt[t]=new At(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){lt[t]=new At(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){lt[t]=new At(t,5,!1,t.toLowerCase(),null,!1,!1)});var om=/[\-:]([a-z])/g;function lm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(om,lm);lt[e]=new At(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(om,lm);lt[e]=new At(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(om,lm);lt[e]=new At(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){lt[t]=new At(t,1,!1,t.toLowerCase(),null,!1,!1)});lt.xlinkHref=new At("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){lt[t]=new At(t,1,!1,t.toLowerCase(),null,!0,!0)});function cm(t,e,r,n){var s=lt.hasOwnProperty(e)?lt[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(cE(e,r,s,n)&&(r=null),n||s===null?oE(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var en=iE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,el=Symbol.for("react.element"),$s=Symbol.for("react.portal"),zs=Symbol.for("react.fragment"),um=Symbol.for("react.strict_mode"),Vd=Symbol.for("react.profiler"),iy=Symbol.for("react.provider"),ay=Symbol.for("react.context"),dm=Symbol.for("react.forward_ref"),Md=Symbol.for("react.suspense"),Fd=Symbol.for("react.suspense_list"),hm=Symbol.for("react.memo"),dn=Symbol.for("react.lazy"),oy=Symbol.for("react.offscreen"),cg=Symbol.iterator;function ta(t){return t===null||typeof t!="object"?null:(t=cg&&t[cg]||t["@@iterator"],typeof t=="function"?t:null)}var Me=Object.assign,Ku;function da(t){if(Ku===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Ku=e&&e[1]||""}return`
`+Ku+t}var Qu=!1;function Xu(t,e){if(!t||Qu)return"";Qu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Qu=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?da(t):""}function uE(t){switch(t.tag){case 5:return da(t.type);case 16:return da("Lazy");case 13:return da("Suspense");case 19:return da("SuspenseList");case 0:case 2:case 15:return t=Xu(t.type,!1),t;case 11:return t=Xu(t.type.render,!1),t;case 1:return t=Xu(t.type,!0),t;default:return""}}function Ud(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zs:return"Fragment";case $s:return"Portal";case Vd:return"Profiler";case um:return"StrictMode";case Md:return"Suspense";case Fd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ay:return(t.displayName||"Context")+".Consumer";case iy:return(t._context.displayName||"Context")+".Provider";case dm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case hm:return e=t.displayName||null,e!==null?e:Ud(t.type)||"Memo";case dn:e=t._payload,t=t._init;try{return Ud(t(e))}catch{}}return null}function dE(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ud(e);case 8:return e===um?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ly(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function hE(t){var e=ly(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function tl(t){t._valueTracker||(t._valueTracker=hE(t))}function cy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=ly(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Gl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Bd(t,e){var r=e.checked;return Me({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function ug(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Vn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function uy(t,e){e=e.checked,e!=null&&cm(t,"checked",e,!1)}function $d(t,e){uy(t,e);var r=Vn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?zd(t,e.type,r):e.hasOwnProperty("defaultValue")&&zd(t,e.type,Vn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function dg(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function zd(t,e,r){(e!=="number"||Gl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ha=Array.isArray;function ti(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Vn(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function qd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return Me({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function hg(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(X(92));if(ha(r)){if(1<r.length)throw Error(X(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Vn(r)}}function dy(t,e){var r=Vn(e.value),n=Vn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function mg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function hy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?hy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var rl,my=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(rl=rl||document.createElement("div"),rl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ma(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ba={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mE=["Webkit","ms","Moz","O"];Object.keys(ba).forEach(function(t){mE.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ba[e]=ba[t]})});function fy(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||ba.hasOwnProperty(t)&&ba[t]?(""+e).trim():e+"px"}function py(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=fy(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var fE=Me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hd(t,e){if(e){if(fE[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function Gd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kd=null;function mm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Qd=null,ri=null,ni=null;function fg(t){if(t=go(t)){if(typeof Qd!="function")throw Error(X(280));var e=t.stateNode;e&&(e=$c(e),Qd(t.stateNode,t.type,e))}}function gy(t){ri?ni?ni.push(t):ni=[t]:ri=t}function xy(){if(ri){var t=ri,e=ni;if(ni=ri=null,fg(t),e)for(t=0;t<e.length;t++)fg(e[t])}}function yy(t,e){return t(e)}function vy(){}var Yu=!1;function wy(t,e,r){if(Yu)return t(e,r);Yu=!0;try{return yy(t,e,r)}finally{Yu=!1,(ri!==null||ni!==null)&&(vy(),xy())}}function Fa(t,e){var r=t.stateNode;if(r===null)return null;var n=$c(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(X(231,e,typeof r));return r}var Xd=!1;if(Hr)try{var ra={};Object.defineProperty(ra,"passive",{get:function(){Xd=!0}}),window.addEventListener("test",ra,ra),window.removeEventListener("test",ra,ra)}catch{Xd=!1}function pE(t,e,r,n,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(h){this.onError(h)}}var Na=!1,Kl=null,Ql=!1,Yd=null,gE={onError:function(t){Na=!0,Kl=t}};function xE(t,e,r,n,s,i,o,l,u){Na=!1,Kl=null,pE.apply(gE,arguments)}function yE(t,e,r,n,s,i,o,l,u){if(xE.apply(this,arguments),Na){if(Na){var d=Kl;Na=!1,Kl=null}else throw Error(X(198));Ql||(Ql=!0,Yd=d)}}function js(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function _y(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function pg(t){if(js(t)!==t)throw Error(X(188))}function vE(t){var e=t.alternate;if(!e){if(e=js(t),e===null)throw Error(X(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return pg(s),t;if(i===n)return pg(s),e;i=i.sibling}throw Error(X(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(X(189))}}if(r.alternate!==n)throw Error(X(190))}if(r.tag!==3)throw Error(X(188));return r.stateNode.current===r?t:e}function by(t){return t=vE(t),t!==null?Ny(t):null}function Ny(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ny(t);if(e!==null)return e;t=t.sibling}return null}var Ey=Qt.unstable_scheduleCallback,gg=Qt.unstable_cancelCallback,wE=Qt.unstable_shouldYield,_E=Qt.unstable_requestPaint,We=Qt.unstable_now,bE=Qt.unstable_getCurrentPriorityLevel,fm=Qt.unstable_ImmediatePriority,jy=Qt.unstable_UserBlockingPriority,Xl=Qt.unstable_NormalPriority,NE=Qt.unstable_LowPriority,Cy=Qt.unstable_IdlePriority,Mc=null,Nr=null;function EE(t){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Mc,t,void 0,(t.current.flags&128)===128)}catch{}}var dr=Math.clz32?Math.clz32:SE,jE=Math.log,CE=Math.LN2;function SE(t){return t>>>=0,t===0?32:31-(jE(t)/CE|0)|0}var nl=64,sl=4194304;function ma(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Yl(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=ma(l):(i&=o,i!==0&&(n=ma(i)))}else o=r&~s,o!==0?n=ma(o):i!==0&&(n=ma(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-dr(e),s=1<<r,n|=t[r],e&=~s;return n}function TE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function IE(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-dr(i),l=1<<o,u=s[o];u===-1?(!(l&r)||l&n)&&(s[o]=TE(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Jd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Sy(){var t=nl;return nl<<=1,!(nl&4194240)&&(nl=64),t}function Ju(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function fo(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-dr(e),t[e]=r}function kE(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-dr(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function pm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-dr(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Ee=0;function Ty(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Iy,gm,ky,Py,Ay,Zd=!1,il=[],En=null,jn=null,Cn=null,Ua=new Map,Ba=new Map,mn=[],PE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xg(t,e){switch(t){case"focusin":case"focusout":En=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Cn=null;break;case"pointerover":case"pointerout":Ua.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ba.delete(e.pointerId)}}function na(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=go(e),e!==null&&gm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function AE(t,e,r,n,s){switch(e){case"focusin":return En=na(En,t,e,r,n,s),!0;case"dragenter":return jn=na(jn,t,e,r,n,s),!0;case"mouseover":return Cn=na(Cn,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return Ua.set(i,na(Ua.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Ba.set(i,na(Ba.get(i)||null,t,e,r,n,s)),!0}return!1}function Ry(t){var e=ss(t.target);if(e!==null){var r=js(e);if(r!==null){if(e=r.tag,e===13){if(e=_y(r),e!==null){t.blockedOn=e,Ay(t.priority,function(){ky(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Cl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=eh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Kd=n,r.target.dispatchEvent(n),Kd=null}else return e=go(r),e!==null&&gm(e),t.blockedOn=r,!1;e.shift()}return!0}function yg(t,e,r){Cl(t)&&r.delete(e)}function RE(){Zd=!1,En!==null&&Cl(En)&&(En=null),jn!==null&&Cl(jn)&&(jn=null),Cn!==null&&Cl(Cn)&&(Cn=null),Ua.forEach(yg),Ba.forEach(yg)}function sa(t,e){t.blockedOn===e&&(t.blockedOn=null,Zd||(Zd=!0,Qt.unstable_scheduleCallback(Qt.unstable_NormalPriority,RE)))}function $a(t){function e(s){return sa(s,t)}if(0<il.length){sa(il[0],t);for(var r=1;r<il.length;r++){var n=il[r];n.blockedOn===t&&(n.blockedOn=null)}}for(En!==null&&sa(En,t),jn!==null&&sa(jn,t),Cn!==null&&sa(Cn,t),Ua.forEach(e),Ba.forEach(e),r=0;r<mn.length;r++)n=mn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<mn.length&&(r=mn[0],r.blockedOn===null);)Ry(r),r.blockedOn===null&&mn.shift()}var si=en.ReactCurrentBatchConfig,Jl=!0;function DE(t,e,r,n){var s=Ee,i=si.transition;si.transition=null;try{Ee=1,xm(t,e,r,n)}finally{Ee=s,si.transition=i}}function LE(t,e,r,n){var s=Ee,i=si.transition;si.transition=null;try{Ee=4,xm(t,e,r,n)}finally{Ee=s,si.transition=i}}function xm(t,e,r,n){if(Jl){var s=eh(t,e,r,n);if(s===null)ld(t,e,n,Zl,r),xg(t,n);else if(AE(s,t,e,r,n))n.stopPropagation();else if(xg(t,n),e&4&&-1<PE.indexOf(t)){for(;s!==null;){var i=go(s);if(i!==null&&Iy(i),i=eh(t,e,r,n),i===null&&ld(t,e,n,Zl,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else ld(t,e,n,null,r)}}var Zl=null;function eh(t,e,r,n){if(Zl=null,t=mm(n),t=ss(t),t!==null)if(e=js(t),e===null)t=null;else if(r=e.tag,r===13){if(t=_y(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Zl=t,null}function Dy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bE()){case fm:return 1;case jy:return 4;case Xl:case NE:return 16;case Cy:return 536870912;default:return 16}default:return 16}}var wn=null,ym=null,Sl=null;function Ly(){if(Sl)return Sl;var t,e=ym,r=e.length,n,s="value"in wn?wn.value:wn.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[i-n];n++);return Sl=s.slice(t,1<n?1-n:void 0)}function Tl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function al(){return!0}function vg(){return!1}function Jt(t){function e(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?al:vg,this.isPropagationStopped=vg,this}return Me(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=al)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=al)},persist:function(){},isPersistent:al}),e}var Pi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vm=Jt(Pi),po=Me({},Pi,{view:0,detail:0}),OE=Jt(po),Zu,ed,ia,Fc=Me({},po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ia&&(ia&&t.type==="mousemove"?(Zu=t.screenX-ia.screenX,ed=t.screenY-ia.screenY):ed=Zu=0,ia=t),Zu)},movementY:function(t){return"movementY"in t?t.movementY:ed}}),wg=Jt(Fc),VE=Me({},Fc,{dataTransfer:0}),ME=Jt(VE),FE=Me({},po,{relatedTarget:0}),td=Jt(FE),UE=Me({},Pi,{animationName:0,elapsedTime:0,pseudoElement:0}),BE=Jt(UE),$E=Me({},Pi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),zE=Jt($E),qE=Me({},Pi,{data:0}),_g=Jt(qE),WE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=GE[t])?!!e[t]:!1}function wm(){return KE}var QE=Me({},po,{key:function(t){if(t.key){var e=WE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Tl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?HE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wm,charCode:function(t){return t.type==="keypress"?Tl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Tl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),XE=Jt(QE),YE=Me({},Fc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bg=Jt(YE),JE=Me({},po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wm}),ZE=Jt(JE),ej=Me({},Pi,{propertyName:0,elapsedTime:0,pseudoElement:0}),tj=Jt(ej),rj=Me({},Fc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),nj=Jt(rj),sj=[9,13,27,32],_m=Hr&&"CompositionEvent"in window,Ea=null;Hr&&"documentMode"in document&&(Ea=document.documentMode);var ij=Hr&&"TextEvent"in window&&!Ea,Oy=Hr&&(!_m||Ea&&8<Ea&&11>=Ea),Ng=" ",Eg=!1;function Vy(t,e){switch(t){case"keyup":return sj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function My(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var qs=!1;function aj(t,e){switch(t){case"compositionend":return My(e);case"keypress":return e.which!==32?null:(Eg=!0,Ng);case"textInput":return t=e.data,t===Ng&&Eg?null:t;default:return null}}function oj(t,e){if(qs)return t==="compositionend"||!_m&&Vy(t,e)?(t=Ly(),Sl=ym=wn=null,qs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Oy&&e.locale!=="ko"?null:e.data;default:return null}}var lj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!lj[t.type]:e==="textarea"}function Fy(t,e,r,n){gy(n),e=ec(e,"onChange"),0<e.length&&(r=new vm("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var ja=null,za=null;function cj(t){Xy(t,0)}function Uc(t){var e=Gs(t);if(cy(e))return t}function uj(t,e){if(t==="change")return e}var Uy=!1;if(Hr){var rd;if(Hr){var nd="oninput"in document;if(!nd){var Cg=document.createElement("div");Cg.setAttribute("oninput","return;"),nd=typeof Cg.oninput=="function"}rd=nd}else rd=!1;Uy=rd&&(!document.documentMode||9<document.documentMode)}function Sg(){ja&&(ja.detachEvent("onpropertychange",By),za=ja=null)}function By(t){if(t.propertyName==="value"&&Uc(za)){var e=[];Fy(e,za,t,mm(t)),wy(cj,e)}}function dj(t,e,r){t==="focusin"?(Sg(),ja=e,za=r,ja.attachEvent("onpropertychange",By)):t==="focusout"&&Sg()}function hj(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Uc(za)}function mj(t,e){if(t==="click")return Uc(e)}function fj(t,e){if(t==="input"||t==="change")return Uc(e)}function pj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fr=typeof Object.is=="function"?Object.is:pj;function qa(t,e){if(fr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Od.call(e,s)||!fr(t[s],e[s]))return!1}return!0}function Tg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ig(t,e){var r=Tg(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Tg(r)}}function $y(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$y(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function zy(){for(var t=window,e=Gl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Gl(t.document)}return e}function bm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function gj(t){var e=zy(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&$y(r.ownerDocument.documentElement,r)){if(n!==null&&bm(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=Ig(r,i);var o=Ig(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var xj=Hr&&"documentMode"in document&&11>=document.documentMode,Ws=null,th=null,Ca=null,rh=!1;function kg(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;rh||Ws==null||Ws!==Gl(n)||(n=Ws,"selectionStart"in n&&bm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ca&&qa(Ca,n)||(Ca=n,n=ec(th,"onSelect"),0<n.length&&(e=new vm("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ws)))}function ol(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Hs={animationend:ol("Animation","AnimationEnd"),animationiteration:ol("Animation","AnimationIteration"),animationstart:ol("Animation","AnimationStart"),transitionend:ol("Transition","TransitionEnd")},sd={},qy={};Hr&&(qy=document.createElement("div").style,"AnimationEvent"in window||(delete Hs.animationend.animation,delete Hs.animationiteration.animation,delete Hs.animationstart.animation),"TransitionEvent"in window||delete Hs.transitionend.transition);function Bc(t){if(sd[t])return sd[t];if(!Hs[t])return t;var e=Hs[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in qy)return sd[t]=e[r];return t}var Wy=Bc("animationend"),Hy=Bc("animationiteration"),Gy=Bc("animationstart"),Ky=Bc("transitionend"),Qy=new Map,Pg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zn(t,e){Qy.set(t,e),Es(e,[t])}for(var id=0;id<Pg.length;id++){var ad=Pg[id],yj=ad.toLowerCase(),vj=ad[0].toUpperCase()+ad.slice(1);zn(yj,"on"+vj)}zn(Wy,"onAnimationEnd");zn(Hy,"onAnimationIteration");zn(Gy,"onAnimationStart");zn("dblclick","onDoubleClick");zn("focusin","onFocus");zn("focusout","onBlur");zn(Ky,"onTransitionEnd");di("onMouseEnter",["mouseout","mouseover"]);di("onMouseLeave",["mouseout","mouseover"]);di("onPointerEnter",["pointerout","pointerover"]);di("onPointerLeave",["pointerout","pointerover"]);Es("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Es("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Es("onBeforeInput",["compositionend","keypress","textInput","paste"]);Es("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Es("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Es("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wj=new Set("cancel close invalid load scroll toggle".split(" ").concat(fa));function Ag(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,yE(n,e,void 0,t),t.currentTarget=null}function Xy(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;Ag(s,l,d),i=u}else for(o=0;o<n.length;o++){if(l=n[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;Ag(s,l,d),i=u}}}if(Ql)throw t=Yd,Ql=!1,Yd=null,t}function Ie(t,e){var r=e[oh];r===void 0&&(r=e[oh]=new Set);var n=t+"__bubble";r.has(n)||(Yy(e,t,2,!1),r.add(n))}function od(t,e,r){var n=0;e&&(n|=4),Yy(r,t,n,e)}var ll="_reactListening"+Math.random().toString(36).slice(2);function Wa(t){if(!t[ll]){t[ll]=!0,sy.forEach(function(r){r!=="selectionchange"&&(wj.has(r)||od(r,!1,t),od(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ll]||(e[ll]=!0,od("selectionchange",!1,e))}}function Yy(t,e,r,n){switch(Dy(e)){case 1:var s=DE;break;case 4:s=LE;break;default:s=xm}r=s.bind(null,e,r,t),s=void 0,!Xd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function ld(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=ss(l),o===null)return;if(u=o.tag,u===5||u===6){n=i=o;continue e}l=l.parentNode}}n=n.return}wy(function(){var d=i,h=mm(r),f=[];e:{var p=Qy.get(t);if(p!==void 0){var b=vm,_=t;switch(t){case"keypress":if(Tl(r)===0)break e;case"keydown":case"keyup":b=XE;break;case"focusin":_="focus",b=td;break;case"focusout":_="blur",b=td;break;case"beforeblur":case"afterblur":b=td;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=wg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=ME;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=ZE;break;case Wy:case Hy:case Gy:b=BE;break;case Ky:b=tj;break;case"scroll":b=OE;break;case"wheel":b=nj;break;case"copy":case"cut":case"paste":b=zE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=bg}var k=(e&4)!==0,P=!k&&t==="scroll",N=k?p!==null?p+"Capture":null:p;k=[];for(var w=d,S;w!==null;){S=w;var R=S.stateNode;if(S.tag===5&&R!==null&&(S=R,N!==null&&(R=Fa(w,N),R!=null&&k.push(Ha(w,R,S)))),P)break;w=w.return}0<k.length&&(p=new b(p,_,null,r,h),f.push({event:p,listeners:k}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",b=t==="mouseout"||t==="pointerout",p&&r!==Kd&&(_=r.relatedTarget||r.fromElement)&&(ss(_)||_[Gr]))break e;if((b||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,b?(_=r.relatedTarget||r.toElement,b=d,_=_?ss(_):null,_!==null&&(P=js(_),_!==P||_.tag!==5&&_.tag!==6)&&(_=null)):(b=null,_=d),b!==_)){if(k=wg,R="onMouseLeave",N="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(k=bg,R="onPointerLeave",N="onPointerEnter",w="pointer"),P=b==null?p:Gs(b),S=_==null?p:Gs(_),p=new k(R,w+"leave",b,r,h),p.target=P,p.relatedTarget=S,R=null,ss(h)===d&&(k=new k(N,w+"enter",_,r,h),k.target=S,k.relatedTarget=P,R=k),P=R,b&&_)t:{for(k=b,N=_,w=0,S=k;S;S=Vs(S))w++;for(S=0,R=N;R;R=Vs(R))S++;for(;0<w-S;)k=Vs(k),w--;for(;0<S-w;)N=Vs(N),S--;for(;w--;){if(k===N||N!==null&&k===N.alternate)break t;k=Vs(k),N=Vs(N)}k=null}else k=null;b!==null&&Rg(f,p,b,k,!1),_!==null&&P!==null&&Rg(f,P,_,k,!0)}}e:{if(p=d?Gs(d):window,b=p.nodeName&&p.nodeName.toLowerCase(),b==="select"||b==="input"&&p.type==="file")var M=uj;else if(jg(p))if(Uy)M=fj;else{M=hj;var $=dj}else(b=p.nodeName)&&b.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(M=mj);if(M&&(M=M(t,d))){Fy(f,M,r,h);break e}$&&$(t,p,d),t==="focusout"&&($=p._wrapperState)&&$.controlled&&p.type==="number"&&zd(p,"number",p.value)}switch($=d?Gs(d):window,t){case"focusin":(jg($)||$.contentEditable==="true")&&(Ws=$,th=d,Ca=null);break;case"focusout":Ca=th=Ws=null;break;case"mousedown":rh=!0;break;case"contextmenu":case"mouseup":case"dragend":rh=!1,kg(f,r,h);break;case"selectionchange":if(xj)break;case"keydown":case"keyup":kg(f,r,h)}var E;if(_m)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else qs?Vy(t,r)&&(x="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(x="onCompositionStart");x&&(Oy&&r.locale!=="ko"&&(qs||x!=="onCompositionStart"?x==="onCompositionEnd"&&qs&&(E=Ly()):(wn=h,ym="value"in wn?wn.value:wn.textContent,qs=!0)),$=ec(d,x),0<$.length&&(x=new _g(x,t,null,r,h),f.push({event:x,listeners:$}),E?x.data=E:(E=My(r),E!==null&&(x.data=E)))),(E=ij?aj(t,r):oj(t,r))&&(d=ec(d,"onBeforeInput"),0<d.length&&(h=new _g("onBeforeInput","beforeinput",null,r,h),f.push({event:h,listeners:d}),h.data=E))}Xy(f,e)})}function Ha(t,e,r){return{instance:t,listener:e,currentTarget:r}}function ec(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Fa(t,r),i!=null&&n.unshift(Ha(t,i,s)),i=Fa(t,e),i!=null&&n.push(Ha(t,i,s))),t=t.return}return n}function Vs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Rg(t,e,r,n,s){for(var i=e._reactName,o=[];r!==null&&r!==n;){var l=r,u=l.alternate,d=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&d!==null&&(l=d,s?(u=Fa(r,i),u!=null&&o.unshift(Ha(r,u,l))):s||(u=Fa(r,i),u!=null&&o.push(Ha(r,u,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var _j=/\r\n?/g,bj=/\u0000|\uFFFD/g;function Dg(t){return(typeof t=="string"?t:""+t).replace(_j,`
`).replace(bj,"")}function cl(t,e,r){if(e=Dg(e),Dg(t)!==e&&r)throw Error(X(425))}function tc(){}var nh=null,sh=null;function ih(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ah=typeof setTimeout=="function"?setTimeout:void 0,Nj=typeof clearTimeout=="function"?clearTimeout:void 0,Lg=typeof Promise=="function"?Promise:void 0,Ej=typeof queueMicrotask=="function"?queueMicrotask:typeof Lg<"u"?function(t){return Lg.resolve(null).then(t).catch(jj)}:ah;function jj(t){setTimeout(function(){throw t})}function cd(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),$a(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);$a(e)}function Sn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Og(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Ai=Math.random().toString(36).slice(2),_r="__reactFiber$"+Ai,Ga="__reactProps$"+Ai,Gr="__reactContainer$"+Ai,oh="__reactEvents$"+Ai,Cj="__reactListeners$"+Ai,Sj="__reactHandles$"+Ai;function ss(t){var e=t[_r];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Gr]||r[_r]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Og(t);t!==null;){if(r=t[_r])return r;t=Og(t)}return e}t=r,r=t.parentNode}return null}function go(t){return t=t[_r]||t[Gr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Gs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(X(33))}function $c(t){return t[Ga]||null}var lh=[],Ks=-1;function qn(t){return{current:t}}function Pe(t){0>Ks||(t.current=lh[Ks],lh[Ks]=null,Ks--)}function Se(t,e){Ks++,lh[Ks]=t.current,t.current=e}var Mn={},_t=qn(Mn),Mt=qn(!1),hs=Mn;function hi(t,e){var r=t.type.contextTypes;if(!r)return Mn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ft(t){return t=t.childContextTypes,t!=null}function rc(){Pe(Mt),Pe(_t)}function Vg(t,e,r){if(_t.current!==Mn)throw Error(X(168));Se(_t,e),Se(Mt,r)}function Jy(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(X(108,dE(t)||"Unknown",s));return Me({},r,n)}function nc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Mn,hs=_t.current,Se(_t,t),Se(Mt,Mt.current),!0}function Mg(t,e,r){var n=t.stateNode;if(!n)throw Error(X(169));r?(t=Jy(t,e,hs),n.__reactInternalMemoizedMergedChildContext=t,Pe(Mt),Pe(_t),Se(_t,t)):Pe(Mt),Se(Mt,r)}var Vr=null,zc=!1,ud=!1;function Zy(t){Vr===null?Vr=[t]:Vr.push(t)}function Tj(t){zc=!0,Zy(t)}function Wn(){if(!ud&&Vr!==null){ud=!0;var t=0,e=Ee;try{var r=Vr;for(Ee=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Vr=null,zc=!1}catch(s){throw Vr!==null&&(Vr=Vr.slice(t+1)),Ey(fm,Wn),s}finally{Ee=e,ud=!1}}return null}var Qs=[],Xs=0,sc=null,ic=0,er=[],tr=0,ms=null,Mr=1,Fr="";function Zn(t,e){Qs[Xs++]=ic,Qs[Xs++]=sc,sc=t,ic=e}function ev(t,e,r){er[tr++]=Mr,er[tr++]=Fr,er[tr++]=ms,ms=t;var n=Mr;t=Fr;var s=32-dr(n)-1;n&=~(1<<s),r+=1;var i=32-dr(e)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Mr=1<<32-dr(e)+s|r<<s|n,Fr=i+t}else Mr=1<<i|r<<s|n,Fr=t}function Nm(t){t.return!==null&&(Zn(t,1),ev(t,1,0))}function Em(t){for(;t===sc;)sc=Qs[--Xs],Qs[Xs]=null,ic=Qs[--Xs],Qs[Xs]=null;for(;t===ms;)ms=er[--tr],er[tr]=null,Fr=er[--tr],er[tr]=null,Mr=er[--tr],er[tr]=null}var Kt=null,Wt=null,Re=!1,ur=null;function tv(t,e){var r=rr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Fg(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Kt=t,Wt=Sn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Kt=t,Wt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ms!==null?{id:Mr,overflow:Fr}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=rr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Kt=t,Wt=null,!0):!1;default:return!1}}function ch(t){return(t.mode&1)!==0&&(t.flags&128)===0}function uh(t){if(Re){var e=Wt;if(e){var r=e;if(!Fg(t,e)){if(ch(t))throw Error(X(418));e=Sn(r.nextSibling);var n=Kt;e&&Fg(t,e)?tv(n,r):(t.flags=t.flags&-4097|2,Re=!1,Kt=t)}}else{if(ch(t))throw Error(X(418));t.flags=t.flags&-4097|2,Re=!1,Kt=t}}}function Ug(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Kt=t}function ul(t){if(t!==Kt)return!1;if(!Re)return Ug(t),Re=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ih(t.type,t.memoizedProps)),e&&(e=Wt)){if(ch(t))throw rv(),Error(X(418));for(;e;)tv(t,e),e=Sn(e.nextSibling)}if(Ug(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(X(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Wt=Sn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Wt=null}}else Wt=Kt?Sn(t.stateNode.nextSibling):null;return!0}function rv(){for(var t=Wt;t;)t=Sn(t.nextSibling)}function mi(){Wt=Kt=null,Re=!1}function jm(t){ur===null?ur=[t]:ur.push(t)}var Ij=en.ReactCurrentBatchConfig;function aa(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(X(309));var n=r.stateNode}if(!n)throw Error(X(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(X(284));if(!r._owner)throw Error(X(290,t))}return t}function dl(t,e){throw t=Object.prototype.toString.call(e),Error(X(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Bg(t){var e=t._init;return e(t._payload)}function nv(t){function e(N,w){if(t){var S=N.deletions;S===null?(N.deletions=[w],N.flags|=16):S.push(w)}}function r(N,w){if(!t)return null;for(;w!==null;)e(N,w),w=w.sibling;return null}function n(N,w){for(N=new Map;w!==null;)w.key!==null?N.set(w.key,w):N.set(w.index,w),w=w.sibling;return N}function s(N,w){return N=Pn(N,w),N.index=0,N.sibling=null,N}function i(N,w,S){return N.index=S,t?(S=N.alternate,S!==null?(S=S.index,S<w?(N.flags|=2,w):S):(N.flags|=2,w)):(N.flags|=1048576,w)}function o(N){return t&&N.alternate===null&&(N.flags|=2),N}function l(N,w,S,R){return w===null||w.tag!==6?(w=xd(S,N.mode,R),w.return=N,w):(w=s(w,S),w.return=N,w)}function u(N,w,S,R){var M=S.type;return M===zs?h(N,w,S.props.children,R,S.key):w!==null&&(w.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===dn&&Bg(M)===w.type)?(R=s(w,S.props),R.ref=aa(N,w,S),R.return=N,R):(R=Ll(S.type,S.key,S.props,null,N.mode,R),R.ref=aa(N,w,S),R.return=N,R)}function d(N,w,S,R){return w===null||w.tag!==4||w.stateNode.containerInfo!==S.containerInfo||w.stateNode.implementation!==S.implementation?(w=yd(S,N.mode,R),w.return=N,w):(w=s(w,S.children||[]),w.return=N,w)}function h(N,w,S,R,M){return w===null||w.tag!==7?(w=cs(S,N.mode,R,M),w.return=N,w):(w=s(w,S),w.return=N,w)}function f(N,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return w=xd(""+w,N.mode,S),w.return=N,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case el:return S=Ll(w.type,w.key,w.props,null,N.mode,S),S.ref=aa(N,null,w),S.return=N,S;case $s:return w=yd(w,N.mode,S),w.return=N,w;case dn:var R=w._init;return f(N,R(w._payload),S)}if(ha(w)||ta(w))return w=cs(w,N.mode,S,null),w.return=N,w;dl(N,w)}return null}function p(N,w,S,R){var M=w!==null?w.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return M!==null?null:l(N,w,""+S,R);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case el:return S.key===M?u(N,w,S,R):null;case $s:return S.key===M?d(N,w,S,R):null;case dn:return M=S._init,p(N,w,M(S._payload),R)}if(ha(S)||ta(S))return M!==null?null:h(N,w,S,R,null);dl(N,S)}return null}function b(N,w,S,R,M){if(typeof R=="string"&&R!==""||typeof R=="number")return N=N.get(S)||null,l(w,N,""+R,M);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case el:return N=N.get(R.key===null?S:R.key)||null,u(w,N,R,M);case $s:return N=N.get(R.key===null?S:R.key)||null,d(w,N,R,M);case dn:var $=R._init;return b(N,w,S,$(R._payload),M)}if(ha(R)||ta(R))return N=N.get(S)||null,h(w,N,R,M,null);dl(w,R)}return null}function _(N,w,S,R){for(var M=null,$=null,E=w,x=w=0,v=null;E!==null&&x<S.length;x++){E.index>x?(v=E,E=null):v=E.sibling;var y=p(N,E,S[x],R);if(y===null){E===null&&(E=v);break}t&&E&&y.alternate===null&&e(N,E),w=i(y,w,x),$===null?M=y:$.sibling=y,$=y,E=v}if(x===S.length)return r(N,E),Re&&Zn(N,x),M;if(E===null){for(;x<S.length;x++)E=f(N,S[x],R),E!==null&&(w=i(E,w,x),$===null?M=E:$.sibling=E,$=E);return Re&&Zn(N,x),M}for(E=n(N,E);x<S.length;x++)v=b(E,N,x,S[x],R),v!==null&&(t&&v.alternate!==null&&E.delete(v.key===null?x:v.key),w=i(v,w,x),$===null?M=v:$.sibling=v,$=v);return t&&E.forEach(function(D){return e(N,D)}),Re&&Zn(N,x),M}function k(N,w,S,R){var M=ta(S);if(typeof M!="function")throw Error(X(150));if(S=M.call(S),S==null)throw Error(X(151));for(var $=M=null,E=w,x=w=0,v=null,y=S.next();E!==null&&!y.done;x++,y=S.next()){E.index>x?(v=E,E=null):v=E.sibling;var D=p(N,E,y.value,R);if(D===null){E===null&&(E=v);break}t&&E&&D.alternate===null&&e(N,E),w=i(D,w,x),$===null?M=D:$.sibling=D,$=D,E=v}if(y.done)return r(N,E),Re&&Zn(N,x),M;if(E===null){for(;!y.done;x++,y=S.next())y=f(N,y.value,R),y!==null&&(w=i(y,w,x),$===null?M=y:$.sibling=y,$=y);return Re&&Zn(N,x),M}for(E=n(N,E);!y.done;x++,y=S.next())y=b(E,N,x,y.value,R),y!==null&&(t&&y.alternate!==null&&E.delete(y.key===null?x:y.key),w=i(y,w,x),$===null?M=y:$.sibling=y,$=y);return t&&E.forEach(function(I){return e(N,I)}),Re&&Zn(N,x),M}function P(N,w,S,R){if(typeof S=="object"&&S!==null&&S.type===zs&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case el:e:{for(var M=S.key,$=w;$!==null;){if($.key===M){if(M=S.type,M===zs){if($.tag===7){r(N,$.sibling),w=s($,S.props.children),w.return=N,N=w;break e}}else if($.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===dn&&Bg(M)===$.type){r(N,$.sibling),w=s($,S.props),w.ref=aa(N,$,S),w.return=N,N=w;break e}r(N,$);break}else e(N,$);$=$.sibling}S.type===zs?(w=cs(S.props.children,N.mode,R,S.key),w.return=N,N=w):(R=Ll(S.type,S.key,S.props,null,N.mode,R),R.ref=aa(N,w,S),R.return=N,N=R)}return o(N);case $s:e:{for($=S.key;w!==null;){if(w.key===$)if(w.tag===4&&w.stateNode.containerInfo===S.containerInfo&&w.stateNode.implementation===S.implementation){r(N,w.sibling),w=s(w,S.children||[]),w.return=N,N=w;break e}else{r(N,w);break}else e(N,w);w=w.sibling}w=yd(S,N.mode,R),w.return=N,N=w}return o(N);case dn:return $=S._init,P(N,w,$(S._payload),R)}if(ha(S))return _(N,w,S,R);if(ta(S))return k(N,w,S,R);dl(N,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,w!==null&&w.tag===6?(r(N,w.sibling),w=s(w,S),w.return=N,N=w):(r(N,w),w=xd(S,N.mode,R),w.return=N,N=w),o(N)):r(N,w)}return P}var fi=nv(!0),sv=nv(!1),ac=qn(null),oc=null,Ys=null,Cm=null;function Sm(){Cm=Ys=oc=null}function Tm(t){var e=ac.current;Pe(ac),t._currentValue=e}function dh(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function ii(t,e){oc=t,Cm=Ys=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Vt=!0),t.firstContext=null)}function sr(t){var e=t._currentValue;if(Cm!==t)if(t={context:t,memoizedValue:e,next:null},Ys===null){if(oc===null)throw Error(X(308));Ys=t,oc.dependencies={lanes:0,firstContext:t}}else Ys=Ys.next=t;return e}var is=null;function Im(t){is===null?is=[t]:is.push(t)}function iv(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Im(e)):(r.next=s.next,s.next=r),e.interleaved=r,Kr(t,n)}function Kr(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var hn=!1;function km(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function av(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Tn(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,we&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Kr(t,r)}return s=n.interleaved,s===null?(e.next=e,Im(n)):(e.next=s.next,s.next=e),n.interleaved=e,Kr(t,r)}function Il(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,pm(t,r)}}function $g(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function lc(t,e,r,n){var s=t.updateQueue;hn=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=u))}if(i!==null){var f=s.baseState;o=0,h=d=u=null,l=i;do{var p=l.lane,b=l.eventTime;if((n&p)===p){h!==null&&(h=h.next={eventTime:b,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=t,k=l;switch(p=e,b=r,k.tag){case 1:if(_=k.payload,typeof _=="function"){f=_.call(b,f,p);break e}f=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=k.payload,p=typeof _=="function"?_.call(b,f,p):_,p==null)break e;f=Me({},f,p);break e;case 2:hn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else b={eventTime:b,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=b,u=f):h=h.next=b,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(h===null&&(u=f),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ps|=o,t.lanes=o,t.memoizedState=f}}function zg(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(X(191,s));s.call(n)}}}var xo={},Er=qn(xo),Ka=qn(xo),Qa=qn(xo);function as(t){if(t===xo)throw Error(X(174));return t}function Pm(t,e){switch(Se(Qa,e),Se(Ka,t),Se(Er,xo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Wd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Wd(e,t)}Pe(Er),Se(Er,e)}function pi(){Pe(Er),Pe(Ka),Pe(Qa)}function ov(t){as(Qa.current);var e=as(Er.current),r=Wd(e,t.type);e!==r&&(Se(Ka,t),Se(Er,r))}function Am(t){Ka.current===t&&(Pe(Er),Pe(Ka))}var Le=qn(0);function cc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dd=[];function Rm(){for(var t=0;t<dd.length;t++)dd[t]._workInProgressVersionPrimary=null;dd.length=0}var kl=en.ReactCurrentDispatcher,hd=en.ReactCurrentBatchConfig,fs=0,Oe=null,Qe=null,Je=null,uc=!1,Sa=!1,Xa=0,kj=0;function ft(){throw Error(X(321))}function Dm(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!fr(t[r],e[r]))return!1;return!0}function Lm(t,e,r,n,s,i){if(fs=i,Oe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kl.current=t===null||t.memoizedState===null?Dj:Lj,t=r(n,s),Sa){i=0;do{if(Sa=!1,Xa=0,25<=i)throw Error(X(301));i+=1,Je=Qe=null,e.updateQueue=null,kl.current=Oj,t=r(n,s)}while(Sa)}if(kl.current=dc,e=Qe!==null&&Qe.next!==null,fs=0,Je=Qe=Oe=null,uc=!1,e)throw Error(X(300));return t}function Om(){var t=Xa!==0;return Xa=0,t}function wr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Je===null?Oe.memoizedState=Je=t:Je=Je.next=t,Je}function ir(){if(Qe===null){var t=Oe.alternate;t=t!==null?t.memoizedState:null}else t=Qe.next;var e=Je===null?Oe.memoizedState:Je.next;if(e!==null)Je=e,Qe=t;else{if(t===null)throw Error(X(310));Qe=t,t={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},Je===null?Oe.memoizedState=Je=t:Je=Je.next=t}return Je}function Ya(t,e){return typeof e=="function"?e(t):e}function md(t){var e=ir(),r=e.queue;if(r===null)throw Error(X(311));r.lastRenderedReducer=t;var n=Qe,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,u=null,d=i;do{var h=d.lane;if((fs&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=f,o=n):u=u.next=f,Oe.lanes|=h,ps|=h}d=d.next}while(d!==null&&d!==i);u===null?o=n:u.next=l,fr(n,e.memoizedState)||(Vt=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=u,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Oe.lanes|=i,ps|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function fd(t){var e=ir(),r=e.queue;if(r===null)throw Error(X(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);fr(i,e.memoizedState)||(Vt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function lv(){}function cv(t,e){var r=Oe,n=ir(),s=e(),i=!fr(n.memoizedState,s);if(i&&(n.memoizedState=s,Vt=!0),n=n.queue,Vm(hv.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||Je!==null&&Je.memoizedState.tag&1){if(r.flags|=2048,Ja(9,dv.bind(null,r,n,s,e),void 0,null),Ze===null)throw Error(X(349));fs&30||uv(r,e,s)}return s}function uv(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Oe.updateQueue,e===null?(e={lastEffect:null,stores:null},Oe.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function dv(t,e,r,n){e.value=r,e.getSnapshot=n,mv(e)&&fv(t)}function hv(t,e,r){return r(function(){mv(e)&&fv(t)})}function mv(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!fr(t,r)}catch{return!0}}function fv(t){var e=Kr(t,1);e!==null&&hr(e,t,1,-1)}function qg(t){var e=wr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ya,lastRenderedState:t},e.queue=t,t=t.dispatch=Rj.bind(null,Oe,t),[e.memoizedState,t]}function Ja(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Oe.updateQueue,e===null?(e={lastEffect:null,stores:null},Oe.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function pv(){return ir().memoizedState}function Pl(t,e,r,n){var s=wr();Oe.flags|=t,s.memoizedState=Ja(1|e,r,void 0,n===void 0?null:n)}function qc(t,e,r,n){var s=ir();n=n===void 0?null:n;var i=void 0;if(Qe!==null){var o=Qe.memoizedState;if(i=o.destroy,n!==null&&Dm(n,o.deps)){s.memoizedState=Ja(e,r,i,n);return}}Oe.flags|=t,s.memoizedState=Ja(1|e,r,i,n)}function Wg(t,e){return Pl(8390656,8,t,e)}function Vm(t,e){return qc(2048,8,t,e)}function gv(t,e){return qc(4,2,t,e)}function xv(t,e){return qc(4,4,t,e)}function yv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function vv(t,e,r){return r=r!=null?r.concat([t]):null,qc(4,4,yv.bind(null,e,t),r)}function Mm(){}function wv(t,e){var r=ir();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Dm(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function _v(t,e){var r=ir();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Dm(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function bv(t,e,r){return fs&21?(fr(r,e)||(r=Sy(),Oe.lanes|=r,ps|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Vt=!0),t.memoizedState=r)}function Pj(t,e){var r=Ee;Ee=r!==0&&4>r?r:4,t(!0);var n=hd.transition;hd.transition={};try{t(!1),e()}finally{Ee=r,hd.transition=n}}function Nv(){return ir().memoizedState}function Aj(t,e,r){var n=kn(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Ev(t))jv(e,r);else if(r=iv(t,e,r,n),r!==null){var s=St();hr(r,t,n,s),Cv(r,e,n)}}function Rj(t,e,r){var n=kn(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ev(t))jv(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,fr(l,o)){var u=e.interleaved;u===null?(s.next=s,Im(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}r=iv(t,e,s,n),r!==null&&(s=St(),hr(r,t,n,s),Cv(r,e,n))}}function Ev(t){var e=t.alternate;return t===Oe||e!==null&&e===Oe}function jv(t,e){Sa=uc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Cv(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,pm(t,r)}}var dc={readContext:sr,useCallback:ft,useContext:ft,useEffect:ft,useImperativeHandle:ft,useInsertionEffect:ft,useLayoutEffect:ft,useMemo:ft,useReducer:ft,useRef:ft,useState:ft,useDebugValue:ft,useDeferredValue:ft,useTransition:ft,useMutableSource:ft,useSyncExternalStore:ft,useId:ft,unstable_isNewReconciler:!1},Dj={readContext:sr,useCallback:function(t,e){return wr().memoizedState=[t,e===void 0?null:e],t},useContext:sr,useEffect:Wg,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Pl(4194308,4,yv.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Pl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Pl(4,2,t,e)},useMemo:function(t,e){var r=wr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=wr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Aj.bind(null,Oe,t),[n.memoizedState,t]},useRef:function(t){var e=wr();return t={current:t},e.memoizedState=t},useState:qg,useDebugValue:Mm,useDeferredValue:function(t){return wr().memoizedState=t},useTransition:function(){var t=qg(!1),e=t[0];return t=Pj.bind(null,t[1]),wr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Oe,s=wr();if(Re){if(r===void 0)throw Error(X(407));r=r()}else{if(r=e(),Ze===null)throw Error(X(349));fs&30||uv(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,Wg(hv.bind(null,n,i,t),[t]),n.flags|=2048,Ja(9,dv.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=wr(),e=Ze.identifierPrefix;if(Re){var r=Fr,n=Mr;r=(n&~(1<<32-dr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Xa++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=kj++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Lj={readContext:sr,useCallback:wv,useContext:sr,useEffect:Vm,useImperativeHandle:vv,useInsertionEffect:gv,useLayoutEffect:xv,useMemo:_v,useReducer:md,useRef:pv,useState:function(){return md(Ya)},useDebugValue:Mm,useDeferredValue:function(t){var e=ir();return bv(e,Qe.memoizedState,t)},useTransition:function(){var t=md(Ya)[0],e=ir().memoizedState;return[t,e]},useMutableSource:lv,useSyncExternalStore:cv,useId:Nv,unstable_isNewReconciler:!1},Oj={readContext:sr,useCallback:wv,useContext:sr,useEffect:Vm,useImperativeHandle:vv,useInsertionEffect:gv,useLayoutEffect:xv,useMemo:_v,useReducer:fd,useRef:pv,useState:function(){return fd(Ya)},useDebugValue:Mm,useDeferredValue:function(t){var e=ir();return Qe===null?e.memoizedState=t:bv(e,Qe.memoizedState,t)},useTransition:function(){var t=fd(Ya)[0],e=ir().memoizedState;return[t,e]},useMutableSource:lv,useSyncExternalStore:cv,useId:Nv,unstable_isNewReconciler:!1};function lr(t,e){if(t&&t.defaultProps){e=Me({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function hh(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Me({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Wc={isMounted:function(t){return(t=t._reactInternals)?js(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=St(),s=kn(t),i=qr(n,s);i.payload=e,r!=null&&(i.callback=r),e=Tn(t,i,s),e!==null&&(hr(e,t,s,n),Il(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=St(),s=kn(t),i=qr(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Tn(t,i,s),e!==null&&(hr(e,t,s,n),Il(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=St(),n=kn(t),s=qr(r,n);s.tag=2,e!=null&&(s.callback=e),e=Tn(t,s,n),e!==null&&(hr(e,t,n,r),Il(e,t,n))}};function Hg(t,e,r,n,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,o):e.prototype&&e.prototype.isPureReactComponent?!qa(r,n)||!qa(s,i):!0}function Sv(t,e,r){var n=!1,s=Mn,i=e.contextType;return typeof i=="object"&&i!==null?i=sr(i):(s=Ft(e)?hs:_t.current,n=e.contextTypes,i=(n=n!=null)?hi(t,s):Mn),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Wc,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Gg(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Wc.enqueueReplaceState(e,e.state,null)}function mh(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},km(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=sr(i):(i=Ft(e)?hs:_t.current,s.context=hi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(hh(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Wc.enqueueReplaceState(s,s.state,null),lc(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function gi(t,e){try{var r="",n=e;do r+=uE(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function pd(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function fh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Vj=typeof WeakMap=="function"?WeakMap:Map;function Tv(t,e,r){r=qr(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){mc||(mc=!0,Eh=n),fh(t,e)},r}function Iv(t,e,r){r=qr(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){fh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){fh(t,e),typeof n!="function"&&(In===null?In=new Set([this]):In.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function Kg(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Vj;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=Yj.bind(null,t,e,r),e.then(t,t))}function Qg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Xg(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=qr(-1,1),e.tag=2,Tn(r,e,1))),r.lanes|=1),t)}var Mj=en.ReactCurrentOwner,Vt=!1;function Ct(t,e,r,n){e.child=t===null?sv(e,null,r,n):fi(e,t.child,r,n)}function Yg(t,e,r,n,s){r=r.render;var i=e.ref;return ii(e,s),n=Lm(t,e,r,n,i,s),r=Om(),t!==null&&!Vt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qr(t,e,s)):(Re&&r&&Nm(e),e.flags|=1,Ct(t,e,n,s),e.child)}function Jg(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!Hm(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,kv(t,e,i,n,s)):(t=Ll(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:qa,r(o,n)&&t.ref===e.ref)return Qr(t,e,s)}return e.flags|=1,t=Pn(i,n),t.ref=e.ref,t.return=e,e.child=t}function kv(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(qa(i,n)&&t.ref===e.ref)if(Vt=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(Vt=!0);else return e.lanes=t.lanes,Qr(t,e,s)}return ph(t,e,r,n,s)}function Pv(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(Zs,qt),qt|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Se(Zs,qt),qt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Se(Zs,qt),qt|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,Se(Zs,qt),qt|=n;return Ct(t,e,s,r),e.child}function Av(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function ph(t,e,r,n,s){var i=Ft(r)?hs:_t.current;return i=hi(e,i),ii(e,s),r=Lm(t,e,r,n,i,s),n=Om(),t!==null&&!Vt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qr(t,e,s)):(Re&&n&&Nm(e),e.flags|=1,Ct(t,e,r,s),e.child)}function Zg(t,e,r,n,s){if(Ft(r)){var i=!0;nc(e)}else i=!1;if(ii(e,s),e.stateNode===null)Al(t,e),Sv(e,r,n),mh(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=sr(d):(d=Ft(r)?hs:_t.current,d=hi(e,d));var h=r.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||u!==d)&&Gg(e,o,n,d),hn=!1;var p=e.memoizedState;o.state=p,lc(e,n,o,s),u=e.memoizedState,l!==n||p!==u||Mt.current||hn?(typeof h=="function"&&(hh(e,r,h,n),u=e.memoizedState),(l=hn||Hg(e,r,l,n,p,u,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=u),o.props=n,o.state=u,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,av(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:lr(e.type,l),o.props=d,f=e.pendingProps,p=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=sr(u):(u=Ft(r)?hs:_t.current,u=hi(e,u));var b=r.getDerivedStateFromProps;(h=typeof b=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==u)&&Gg(e,o,n,u),hn=!1,p=e.memoizedState,o.state=p,lc(e,n,o,s);var _=e.memoizedState;l!==f||p!==_||Mt.current||hn?(typeof b=="function"&&(hh(e,r,b,n),_=e.memoizedState),(d=hn||Hg(e,r,d,n,p,_,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,_,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,_,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=_),o.props=n,o.state=_,o.context=u,n=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return gh(t,e,r,n,i,s)}function gh(t,e,r,n,s,i){Av(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&Mg(e,r,!1),Qr(t,e,i);n=e.stateNode,Mj.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=fi(e,t.child,null,i),e.child=fi(e,null,l,i)):Ct(t,e,l,i),e.memoizedState=n.state,s&&Mg(e,r,!0),e.child}function Rv(t){var e=t.stateNode;e.pendingContext?Vg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Vg(t,e.context,!1),Pm(t,e.containerInfo)}function e0(t,e,r,n,s){return mi(),jm(s),e.flags|=256,Ct(t,e,r,n),e.child}var xh={dehydrated:null,treeContext:null,retryLane:0};function yh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Dv(t,e,r){var n=e.pendingProps,s=Le.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Se(Le,s&1),t===null)return uh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,i?(n=e.mode,i=e.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Kc(o,n,0,null),t=cs(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=yh(r),e.memoizedState=xh,t):Fm(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Fj(t,e,o,n,l,s,r);if(i){i=n.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=u,e.deletions=null):(n=Pn(s,u),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Pn(l,i):(i=cs(i,o,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,o=t.child.memoizedState,o=o===null?yh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~r,e.memoizedState=xh,n}return i=t.child,t=i.sibling,n=Pn(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Fm(t,e){return e=Kc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function hl(t,e,r,n){return n!==null&&jm(n),fi(e,t.child,null,r),t=Fm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Fj(t,e,r,n,s,i,o){if(r)return e.flags&256?(e.flags&=-257,n=pd(Error(X(422))),hl(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Kc({mode:"visible",children:n.children},s,0,null),i=cs(i,s,o,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&fi(e,t.child,null,o),e.child.memoizedState=yh(o),e.memoizedState=xh,i);if(!(e.mode&1))return hl(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(X(419)),n=pd(i,n,void 0),hl(t,e,o,n)}if(l=(o&t.childLanes)!==0,Vt||l){if(n=Ze,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Kr(t,s),hr(n,t,s,-1))}return Wm(),n=pd(Error(X(421))),hl(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Jj.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Wt=Sn(s.nextSibling),Kt=e,Re=!0,ur=null,t!==null&&(er[tr++]=Mr,er[tr++]=Fr,er[tr++]=ms,Mr=t.id,Fr=t.overflow,ms=e),e=Fm(e,n.children),e.flags|=4096,e)}function t0(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),dh(t.return,e,r)}function gd(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function Lv(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(Ct(t,e,n.children,r),n=Le.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&t0(t,r,e);else if(t.tag===19)t0(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Se(Le,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&cc(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),gd(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&cc(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}gd(e,!0,r,null,i);break;case"together":gd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Al(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Qr(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ps|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(X(153));if(e.child!==null){for(t=e.child,r=Pn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Pn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Uj(t,e,r){switch(e.tag){case 3:Rv(e),mi();break;case 5:ov(e);break;case 1:Ft(e.type)&&nc(e);break;case 4:Pm(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Se(ac,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Se(Le,Le.current&1),e.flags|=128,null):r&e.child.childLanes?Dv(t,e,r):(Se(Le,Le.current&1),t=Qr(t,e,r),t!==null?t.sibling:null);Se(Le,Le.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Lv(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Se(Le,Le.current),n)break;return null;case 22:case 23:return e.lanes=0,Pv(t,e,r)}return Qr(t,e,r)}var Ov,vh,Vv,Mv;Ov=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};vh=function(){};Vv=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,as(Er.current);var i=null;switch(r){case"input":s=Bd(t,s),n=Bd(t,n),i=[];break;case"select":s=Me({},s,{value:void 0}),n=Me({},n,{value:void 0}),i=[];break;case"textarea":s=qd(t,s),n=qd(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=tc)}Hd(r,n);var o;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Va.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var u=n[d];if(l=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(i||(i=[]),i.push(d,r)),r=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Va.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ie("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}r&&(i=i||[]).push("style",r);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Mv=function(t,e,r,n){r!==n&&(e.flags|=4)};function oa(t,e){if(!Re)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function pt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Bj(t,e,r){var n=e.pendingProps;switch(Em(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(e),null;case 1:return Ft(e.type)&&rc(),pt(e),null;case 3:return n=e.stateNode,pi(),Pe(Mt),Pe(_t),Rm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(ul(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ur!==null&&(Sh(ur),ur=null))),vh(t,e),pt(e),null;case 5:Am(e);var s=as(Qa.current);if(r=e.type,t!==null&&e.stateNode!=null)Vv(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(X(166));return pt(e),null}if(t=as(Er.current),ul(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[_r]=e,n[Ga]=i,t=(e.mode&1)!==0,r){case"dialog":Ie("cancel",n),Ie("close",n);break;case"iframe":case"object":case"embed":Ie("load",n);break;case"video":case"audio":for(s=0;s<fa.length;s++)Ie(fa[s],n);break;case"source":Ie("error",n);break;case"img":case"image":case"link":Ie("error",n),Ie("load",n);break;case"details":Ie("toggle",n);break;case"input":ug(n,i),Ie("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ie("invalid",n);break;case"textarea":hg(n,i),Ie("invalid",n)}Hd(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&cl(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&cl(n.textContent,l,t),s=["children",""+l]):Va.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ie("scroll",n)}switch(r){case"input":tl(n),dg(n,i,!0);break;case"textarea":tl(n),mg(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=tc)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=hy(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[_r]=e,t[Ga]=n,Ov(t,e,!1,!1),e.stateNode=t;e:{switch(o=Gd(r,n),r){case"dialog":Ie("cancel",t),Ie("close",t),s=n;break;case"iframe":case"object":case"embed":Ie("load",t),s=n;break;case"video":case"audio":for(s=0;s<fa.length;s++)Ie(fa[s],t);s=n;break;case"source":Ie("error",t),s=n;break;case"img":case"image":case"link":Ie("error",t),Ie("load",t),s=n;break;case"details":Ie("toggle",t),s=n;break;case"input":ug(t,n),s=Bd(t,n),Ie("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Me({},n,{value:void 0}),Ie("invalid",t);break;case"textarea":hg(t,n),s=qd(t,n),Ie("invalid",t);break;default:s=n}Hd(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?py(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&my(t,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Ma(t,u):typeof u=="number"&&Ma(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Va.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ie("scroll",t):u!=null&&cm(t,i,u,o))}switch(r){case"input":tl(t),dg(t,n,!1);break;case"textarea":tl(t),mg(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Vn(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?ti(t,!!n.multiple,i,!1):n.defaultValue!=null&&ti(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=tc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return pt(e),null;case 6:if(t&&e.stateNode!=null)Mv(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(X(166));if(r=as(Qa.current),as(Er.current),ul(e)){if(n=e.stateNode,r=e.memoizedProps,n[_r]=e,(i=n.nodeValue!==r)&&(t=Kt,t!==null))switch(t.tag){case 3:cl(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cl(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[_r]=e,e.stateNode=n}return pt(e),null;case 13:if(Pe(Le),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Re&&Wt!==null&&e.mode&1&&!(e.flags&128))rv(),mi(),e.flags|=98560,i=!1;else if(i=ul(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(X(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(X(317));i[_r]=e}else mi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;pt(e),i=!1}else ur!==null&&(Sh(ur),ur=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Le.current&1?Xe===0&&(Xe=3):Wm())),e.updateQueue!==null&&(e.flags|=4),pt(e),null);case 4:return pi(),vh(t,e),t===null&&Wa(e.stateNode.containerInfo),pt(e),null;case 10:return Tm(e.type._context),pt(e),null;case 17:return Ft(e.type)&&rc(),pt(e),null;case 19:if(Pe(Le),i=e.memoizedState,i===null)return pt(e),null;if(n=(e.flags&128)!==0,o=i.rendering,o===null)if(n)oa(i,!1);else{if(Xe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=cc(t),o!==null){for(e.flags|=128,oa(i,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Se(Le,Le.current&1|2),e.child}t=t.sibling}i.tail!==null&&We()>xi&&(e.flags|=128,n=!0,oa(i,!1),e.lanes=4194304)}else{if(!n)if(t=cc(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),oa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Re)return pt(e),null}else 2*We()-i.renderingStartTime>xi&&r!==1073741824&&(e.flags|=128,n=!0,oa(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(r=i.last,r!==null?r.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=We(),e.sibling=null,r=Le.current,Se(Le,n?r&1|2:r&1),e):(pt(e),null);case 22:case 23:return qm(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?qt&1073741824&&(pt(e),e.subtreeFlags&6&&(e.flags|=8192)):pt(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function $j(t,e){switch(Em(e),e.tag){case 1:return Ft(e.type)&&rc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pi(),Pe(Mt),Pe(_t),Rm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Am(e),null;case 13:if(Pe(Le),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(X(340));mi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pe(Le),null;case 4:return pi(),null;case 10:return Tm(e.type._context),null;case 22:case 23:return qm(),null;case 24:return null;default:return null}}var ml=!1,yt=!1,zj=typeof WeakSet=="function"?WeakSet:Set,ne=null;function Js(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Be(t,e,n)}else r.current=null}function wh(t,e,r){try{r()}catch(n){Be(t,e,n)}}var r0=!1;function qj(t,e){if(nh=Jl,t=zy(),bm(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,u=-1,d=0,h=0,f=t,p=null;t:for(;;){for(var b;f!==r||s!==0&&f.nodeType!==3||(l=o+s),f!==i||n!==0&&f.nodeType!==3||(u=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(b=f.firstChild)!==null;)p=f,f=b;for(;;){if(f===t)break t;if(p===r&&++d===s&&(l=o),p===i&&++h===n&&(u=o),(b=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=b}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(sh={focusedElem:t,selectionRange:r},Jl=!1,ne=e;ne!==null;)if(e=ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ne=t;else for(;ne!==null;){e=ne;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var k=_.memoizedProps,P=_.memoizedState,N=e.stateNode,w=N.getSnapshotBeforeUpdate(e.elementType===e.type?k:lr(e.type,k),P);N.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(R){Be(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}return _=r0,r0=!1,_}function Ta(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&wh(e,r,i)}s=s.next}while(s!==n)}}function Hc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function _h(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Fv(t){var e=t.alternate;e!==null&&(t.alternate=null,Fv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[_r],delete e[Ga],delete e[oh],delete e[Cj],delete e[Sj])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Uv(t){return t.tag===5||t.tag===3||t.tag===4}function n0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Uv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function bh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=tc));else if(n!==4&&(t=t.child,t!==null))for(bh(t,e,r),t=t.sibling;t!==null;)bh(t,e,r),t=t.sibling}function Nh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Nh(t,e,r),t=t.sibling;t!==null;)Nh(t,e,r),t=t.sibling}var nt=null,cr=!1;function cn(t,e,r){for(r=r.child;r!==null;)Bv(t,e,r),r=r.sibling}function Bv(t,e,r){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Mc,r)}catch{}switch(r.tag){case 5:yt||Js(r,e);case 6:var n=nt,s=cr;nt=null,cn(t,e,r),nt=n,cr=s,nt!==null&&(cr?(t=nt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):nt.removeChild(r.stateNode));break;case 18:nt!==null&&(cr?(t=nt,r=r.stateNode,t.nodeType===8?cd(t.parentNode,r):t.nodeType===1&&cd(t,r),$a(t)):cd(nt,r.stateNode));break;case 4:n=nt,s=cr,nt=r.stateNode.containerInfo,cr=!0,cn(t,e,r),nt=n,cr=s;break;case 0:case 11:case 14:case 15:if(!yt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&wh(r,e,o),s=s.next}while(s!==n)}cn(t,e,r);break;case 1:if(!yt&&(Js(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Be(r,e,l)}cn(t,e,r);break;case 21:cn(t,e,r);break;case 22:r.mode&1?(yt=(n=yt)||r.memoizedState!==null,cn(t,e,r),yt=n):cn(t,e,r);break;default:cn(t,e,r)}}function s0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new zj),e.forEach(function(n){var s=Zj.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function or(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:nt=l.stateNode,cr=!1;break e;case 3:nt=l.stateNode.containerInfo,cr=!0;break e;case 4:nt=l.stateNode.containerInfo,cr=!0;break e}l=l.return}if(nt===null)throw Error(X(160));Bv(i,o,s),nt=null,cr=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Be(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)$v(e,t),e=e.sibling}function $v(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(or(e,t),vr(t),n&4){try{Ta(3,t,t.return),Hc(3,t)}catch(k){Be(t,t.return,k)}try{Ta(5,t,t.return)}catch(k){Be(t,t.return,k)}}break;case 1:or(e,t),vr(t),n&512&&r!==null&&Js(r,r.return);break;case 5:if(or(e,t),vr(t),n&512&&r!==null&&Js(r,r.return),t.flags&32){var s=t.stateNode;try{Ma(s,"")}catch(k){Be(t,t.return,k)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=r!==null?r.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&uy(s,i),Gd(l,o);var d=Gd(l,i);for(o=0;o<u.length;o+=2){var h=u[o],f=u[o+1];h==="style"?py(s,f):h==="dangerouslySetInnerHTML"?my(s,f):h==="children"?Ma(s,f):cm(s,h,f,d)}switch(l){case"input":$d(s,i);break;case"textarea":dy(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var b=i.value;b!=null?ti(s,!!i.multiple,b,!1):p!==!!i.multiple&&(i.defaultValue!=null?ti(s,!!i.multiple,i.defaultValue,!0):ti(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ga]=i}catch(k){Be(t,t.return,k)}}break;case 6:if(or(e,t),vr(t),n&4){if(t.stateNode===null)throw Error(X(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(k){Be(t,t.return,k)}}break;case 3:if(or(e,t),vr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{$a(e.containerInfo)}catch(k){Be(t,t.return,k)}break;case 4:or(e,t),vr(t);break;case 13:or(e,t),vr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||($m=We())),n&4&&s0(t);break;case 22:if(h=r!==null&&r.memoizedState!==null,t.mode&1?(yt=(d=yt)||h,or(e,t),yt=d):or(e,t),vr(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ne=t,h=t.child;h!==null;){for(f=ne=h;ne!==null;){switch(p=ne,b=p.child,p.tag){case 0:case 11:case 14:case 15:Ta(4,p,p.return);break;case 1:Js(p,p.return);var _=p.stateNode;if(typeof _.componentWillUnmount=="function"){n=p,r=p.return;try{e=n,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(k){Be(n,r,k)}}break;case 5:Js(p,p.return);break;case 22:if(p.memoizedState!==null){a0(f);continue}}b!==null?(b.return=p,ne=b):a0(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,u=f.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=fy("display",o))}catch(k){Be(t,t.return,k)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(k){Be(t,t.return,k)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:or(e,t),vr(t),n&4&&s0(t);break;case 21:break;default:or(e,t),vr(t)}}function vr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Uv(r)){var n=r;break e}r=r.return}throw Error(X(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Ma(s,""),n.flags&=-33);var i=n0(t);Nh(t,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=n0(t);bh(t,l,o);break;default:throw Error(X(161))}}catch(u){Be(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Wj(t,e,r){ne=t,zv(t)}function zv(t,e,r){for(var n=(t.mode&1)!==0;ne!==null;){var s=ne,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||ml;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||yt;l=ml;var d=yt;if(ml=o,(yt=u)&&!d)for(ne=s;ne!==null;)o=ne,u=o.child,o.tag===22&&o.memoizedState!==null?o0(s):u!==null?(u.return=o,ne=u):o0(s);for(;i!==null;)ne=i,zv(i),i=i.sibling;ne=s,ml=l,yt=d}i0(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ne=i):i0(t)}}function i0(t){for(;ne!==null;){var e=ne;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:yt||Hc(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!yt)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:lr(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&zg(e,i,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}zg(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&$a(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}yt||e.flags&512&&_h(e)}catch(p){Be(e,e.return,p)}}if(e===t){ne=null;break}if(r=e.sibling,r!==null){r.return=e.return,ne=r;break}ne=e.return}}function a0(t){for(;ne!==null;){var e=ne;if(e===t){ne=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ne=r;break}ne=e.return}}function o0(t){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Hc(4,e)}catch(u){Be(e,r,u)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(u){Be(e,s,u)}}var i=e.return;try{_h(e)}catch(u){Be(e,i,u)}break;case 5:var o=e.return;try{_h(e)}catch(u){Be(e,o,u)}}}catch(u){Be(e,e.return,u)}if(e===t){ne=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ne=l;break}ne=e.return}}var Hj=Math.ceil,hc=en.ReactCurrentDispatcher,Um=en.ReactCurrentOwner,nr=en.ReactCurrentBatchConfig,we=0,Ze=null,Ge=null,at=0,qt=0,Zs=qn(0),Xe=0,Za=null,ps=0,Gc=0,Bm=0,Ia=null,Dt=null,$m=0,xi=1/0,Or=null,mc=!1,Eh=null,In=null,fl=!1,_n=null,fc=0,ka=0,jh=null,Rl=-1,Dl=0;function St(){return we&6?We():Rl!==-1?Rl:Rl=We()}function kn(t){return t.mode&1?we&2&&at!==0?at&-at:Ij.transition!==null?(Dl===0&&(Dl=Sy()),Dl):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:Dy(t.type)),t):1}function hr(t,e,r,n){if(50<ka)throw ka=0,jh=null,Error(X(185));fo(t,r,n),(!(we&2)||t!==Ze)&&(t===Ze&&(!(we&2)&&(Gc|=r),Xe===4&&fn(t,at)),Ut(t,n),r===1&&we===0&&!(e.mode&1)&&(xi=We()+500,zc&&Wn()))}function Ut(t,e){var r=t.callbackNode;IE(t,e);var n=Yl(t,t===Ze?at:0);if(n===0)r!==null&&gg(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&gg(r),e===1)t.tag===0?Tj(l0.bind(null,t)):Zy(l0.bind(null,t)),Ej(function(){!(we&6)&&Wn()}),r=null;else{switch(Ty(n)){case 1:r=fm;break;case 4:r=jy;break;case 16:r=Xl;break;case 536870912:r=Cy;break;default:r=Xl}r=Yv(r,qv.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function qv(t,e){if(Rl=-1,Dl=0,we&6)throw Error(X(327));var r=t.callbackNode;if(ai()&&t.callbackNode!==r)return null;var n=Yl(t,t===Ze?at:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=pc(t,n);else{e=n;var s=we;we|=2;var i=Hv();(Ze!==t||at!==e)&&(Or=null,xi=We()+500,ls(t,e));do try{Qj();break}catch(l){Wv(t,l)}while(!0);Sm(),hc.current=i,we=s,Ge!==null?e=0:(Ze=null,at=0,e=Xe)}if(e!==0){if(e===2&&(s=Jd(t),s!==0&&(n=s,e=Ch(t,s))),e===1)throw r=Za,ls(t,0),fn(t,n),Ut(t,We()),r;if(e===6)fn(t,n);else{if(s=t.current.alternate,!(n&30)&&!Gj(s)&&(e=pc(t,n),e===2&&(i=Jd(t),i!==0&&(n=i,e=Ch(t,i))),e===1))throw r=Za,ls(t,0),fn(t,n),Ut(t,We()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(X(345));case 2:es(t,Dt,Or);break;case 3:if(fn(t,n),(n&130023424)===n&&(e=$m+500-We(),10<e)){if(Yl(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){St(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ah(es.bind(null,t,Dt,Or),e);break}es(t,Dt,Or);break;case 4:if(fn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-dr(n);i=1<<o,o=e[o],o>s&&(s=o),n&=~i}if(n=s,n=We()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Hj(n/1960))-n,10<n){t.timeoutHandle=ah(es.bind(null,t,Dt,Or),n);break}es(t,Dt,Or);break;case 5:es(t,Dt,Or);break;default:throw Error(X(329))}}}return Ut(t,We()),t.callbackNode===r?qv.bind(null,t):null}function Ch(t,e){var r=Ia;return t.current.memoizedState.isDehydrated&&(ls(t,e).flags|=256),t=pc(t,e),t!==2&&(e=Dt,Dt=r,e!==null&&Sh(e)),t}function Sh(t){Dt===null?Dt=t:Dt.push.apply(Dt,t)}function Gj(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!fr(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fn(t,e){for(e&=~Bm,e&=~Gc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-dr(e),n=1<<r;t[r]=-1,e&=~n}}function l0(t){if(we&6)throw Error(X(327));ai();var e=Yl(t,0);if(!(e&1))return Ut(t,We()),null;var r=pc(t,e);if(t.tag!==0&&r===2){var n=Jd(t);n!==0&&(e=n,r=Ch(t,n))}if(r===1)throw r=Za,ls(t,0),fn(t,e),Ut(t,We()),r;if(r===6)throw Error(X(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,es(t,Dt,Or),Ut(t,We()),null}function zm(t,e){var r=we;we|=1;try{return t(e)}finally{we=r,we===0&&(xi=We()+500,zc&&Wn())}}function gs(t){_n!==null&&_n.tag===0&&!(we&6)&&ai();var e=we;we|=1;var r=nr.transition,n=Ee;try{if(nr.transition=null,Ee=1,t)return t()}finally{Ee=n,nr.transition=r,we=e,!(we&6)&&Wn()}}function qm(){qt=Zs.current,Pe(Zs)}function ls(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Nj(r)),Ge!==null)for(r=Ge.return;r!==null;){var n=r;switch(Em(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&rc();break;case 3:pi(),Pe(Mt),Pe(_t),Rm();break;case 5:Am(n);break;case 4:pi();break;case 13:Pe(Le);break;case 19:Pe(Le);break;case 10:Tm(n.type._context);break;case 22:case 23:qm()}r=r.return}if(Ze=t,Ge=t=Pn(t.current,null),at=qt=e,Xe=0,Za=null,Bm=Gc=ps=0,Dt=Ia=null,is!==null){for(e=0;e<is.length;e++)if(r=is[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}is=null}return t}function Wv(t,e){do{var r=Ge;try{if(Sm(),kl.current=dc,uc){for(var n=Oe.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}uc=!1}if(fs=0,Je=Qe=Oe=null,Sa=!1,Xa=0,Um.current=null,r===null||r.return===null){Xe=1,Za=e,Ge=null;break}e:{var i=t,o=r.return,l=r,u=e;if(e=at,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var b=Qg(o);if(b!==null){b.flags&=-257,Xg(b,o,l,i,e),b.mode&1&&Kg(i,d,e),e=b,u=d;var _=e.updateQueue;if(_===null){var k=new Set;k.add(u),e.updateQueue=k}else _.add(u);break e}else{if(!(e&1)){Kg(i,d,e),Wm();break e}u=Error(X(426))}}else if(Re&&l.mode&1){var P=Qg(o);if(P!==null){!(P.flags&65536)&&(P.flags|=256),Xg(P,o,l,i,e),jm(gi(u,l));break e}}i=u=gi(u,l),Xe!==4&&(Xe=2),Ia===null?Ia=[i]:Ia.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var N=Tv(i,u,e);$g(i,N);break e;case 1:l=u;var w=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(In===null||!In.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=Iv(i,l,e);$g(i,R);break e}}i=i.return}while(i!==null)}Kv(r)}catch(M){e=M,Ge===r&&r!==null&&(Ge=r=r.return);continue}break}while(!0)}function Hv(){var t=hc.current;return hc.current=dc,t===null?dc:t}function Wm(){(Xe===0||Xe===3||Xe===2)&&(Xe=4),Ze===null||!(ps&268435455)&&!(Gc&268435455)||fn(Ze,at)}function pc(t,e){var r=we;we|=2;var n=Hv();(Ze!==t||at!==e)&&(Or=null,ls(t,e));do try{Kj();break}catch(s){Wv(t,s)}while(!0);if(Sm(),we=r,hc.current=n,Ge!==null)throw Error(X(261));return Ze=null,at=0,Xe}function Kj(){for(;Ge!==null;)Gv(Ge)}function Qj(){for(;Ge!==null&&!wE();)Gv(Ge)}function Gv(t){var e=Xv(t.alternate,t,qt);t.memoizedProps=t.pendingProps,e===null?Kv(t):Ge=e,Um.current=null}function Kv(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=$j(r,e),r!==null){r.flags&=32767,Ge=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Xe=6,Ge=null;return}}else if(r=Bj(r,e,qt),r!==null){Ge=r;return}if(e=e.sibling,e!==null){Ge=e;return}Ge=e=t}while(e!==null);Xe===0&&(Xe=5)}function es(t,e,r){var n=Ee,s=nr.transition;try{nr.transition=null,Ee=1,Xj(t,e,r,n)}finally{nr.transition=s,Ee=n}return null}function Xj(t,e,r,n){do ai();while(_n!==null);if(we&6)throw Error(X(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(X(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(kE(t,i),t===Ze&&(Ge=Ze=null,at=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||fl||(fl=!0,Yv(Xl,function(){return ai(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=nr.transition,nr.transition=null;var o=Ee;Ee=1;var l=we;we|=4,Um.current=null,qj(t,r),$v(r,t),gj(sh),Jl=!!nh,sh=nh=null,t.current=r,Wj(r),_E(),we=l,Ee=o,nr.transition=i}else t.current=r;if(fl&&(fl=!1,_n=t,fc=s),i=t.pendingLanes,i===0&&(In=null),EE(r.stateNode),Ut(t,We()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(mc)throw mc=!1,t=Eh,Eh=null,t;return fc&1&&t.tag!==0&&ai(),i=t.pendingLanes,i&1?t===jh?ka++:(ka=0,jh=t):ka=0,Wn(),null}function ai(){if(_n!==null){var t=Ty(fc),e=nr.transition,r=Ee;try{if(nr.transition=null,Ee=16>t?16:t,_n===null)var n=!1;else{if(t=_n,_n=null,fc=0,we&6)throw Error(X(331));var s=we;for(we|=4,ne=t.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(ne=d;ne!==null;){var h=ne;switch(h.tag){case 0:case 11:case 15:Ta(8,h,i)}var f=h.child;if(f!==null)f.return=h,ne=f;else for(;ne!==null;){h=ne;var p=h.sibling,b=h.return;if(Fv(h),h===d){ne=null;break}if(p!==null){p.return=b,ne=p;break}ne=b}}}var _=i.alternate;if(_!==null){var k=_.child;if(k!==null){_.child=null;do{var P=k.sibling;k.sibling=null,k=P}while(k!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ta(9,i,i.return)}var N=i.sibling;if(N!==null){N.return=i.return,ne=N;break e}ne=i.return}}var w=t.current;for(ne=w;ne!==null;){o=ne;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,ne=S;else e:for(o=w;ne!==null;){if(l=ne,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Hc(9,l)}}catch(M){Be(l,l.return,M)}if(l===o){ne=null;break e}var R=l.sibling;if(R!==null){R.return=l.return,ne=R;break e}ne=l.return}}if(we=s,Wn(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Mc,t)}catch{}n=!0}return n}finally{Ee=r,nr.transition=e}}return!1}function c0(t,e,r){e=gi(r,e),e=Tv(t,e,1),t=Tn(t,e,1),e=St(),t!==null&&(fo(t,1,e),Ut(t,e))}function Be(t,e,r){if(t.tag===3)c0(t,t,r);else for(;e!==null;){if(e.tag===3){c0(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(In===null||!In.has(n))){t=gi(r,t),t=Iv(e,t,1),e=Tn(e,t,1),t=St(),e!==null&&(fo(e,1,t),Ut(e,t));break}}e=e.return}}function Yj(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=St(),t.pingedLanes|=t.suspendedLanes&r,Ze===t&&(at&r)===r&&(Xe===4||Xe===3&&(at&130023424)===at&&500>We()-$m?ls(t,0):Bm|=r),Ut(t,e)}function Qv(t,e){e===0&&(t.mode&1?(e=sl,sl<<=1,!(sl&130023424)&&(sl=4194304)):e=1);var r=St();t=Kr(t,e),t!==null&&(fo(t,e,r),Ut(t,r))}function Jj(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Qv(t,r)}function Zj(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(X(314))}n!==null&&n.delete(e),Qv(t,r)}var Xv;Xv=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Mt.current)Vt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Vt=!1,Uj(t,e,r);Vt=!!(t.flags&131072)}else Vt=!1,Re&&e.flags&1048576&&ev(e,ic,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Al(t,e),t=e.pendingProps;var s=hi(e,_t.current);ii(e,r),s=Lm(null,e,n,t,s,r);var i=Om();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ft(n)?(i=!0,nc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,km(e),s.updater=Wc,e.stateNode=s,s._reactInternals=e,mh(e,n,t,r),e=gh(null,e,n,!0,i,r)):(e.tag=0,Re&&i&&Nm(e),Ct(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Al(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=tC(n),t=lr(n,t),s){case 0:e=ph(null,e,n,t,r);break e;case 1:e=Zg(null,e,n,t,r);break e;case 11:e=Yg(null,e,n,t,r);break e;case 14:e=Jg(null,e,n,lr(n.type,t),r);break e}throw Error(X(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:lr(n,s),ph(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:lr(n,s),Zg(t,e,n,s,r);case 3:e:{if(Rv(e),t===null)throw Error(X(387));n=e.pendingProps,i=e.memoizedState,s=i.element,av(t,e),lc(e,n,null,r);var o=e.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=gi(Error(X(423)),e),e=e0(t,e,n,r,s);break e}else if(n!==s){s=gi(Error(X(424)),e),e=e0(t,e,n,r,s);break e}else for(Wt=Sn(e.stateNode.containerInfo.firstChild),Kt=e,Re=!0,ur=null,r=sv(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(mi(),n===s){e=Qr(t,e,r);break e}Ct(t,e,n,r)}e=e.child}return e;case 5:return ov(e),t===null&&uh(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,ih(n,s)?o=null:i!==null&&ih(n,i)&&(e.flags|=32),Av(t,e),Ct(t,e,o,r),e.child;case 6:return t===null&&uh(e),null;case 13:return Dv(t,e,r);case 4:return Pm(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=fi(e,null,n,r):Ct(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:lr(n,s),Yg(t,e,n,s,r);case 7:return Ct(t,e,e.pendingProps,r),e.child;case 8:return Ct(t,e,e.pendingProps.children,r),e.child;case 12:return Ct(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Se(ac,n._currentValue),n._currentValue=o,i!==null)if(fr(i.value,o)){if(i.children===s.children&&!Mt.current){e=Qr(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=qr(-1,r&-r),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),dh(i.return,r,e),l.lanes|=r;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(X(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),dh(o,r,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ct(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,ii(e,r),s=sr(s),n=n(s),e.flags|=1,Ct(t,e,n,r),e.child;case 14:return n=e.type,s=lr(n,e.pendingProps),s=lr(n.type,s),Jg(t,e,n,s,r);case 15:return kv(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:lr(n,s),Al(t,e),e.tag=1,Ft(n)?(t=!0,nc(e)):t=!1,ii(e,r),Sv(e,n,s),mh(e,n,s,r),gh(null,e,n,!0,t,r);case 19:return Lv(t,e,r);case 22:return Pv(t,e,r)}throw Error(X(156,e.tag))};function Yv(t,e){return Ey(t,e)}function eC(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rr(t,e,r,n){return new eC(t,e,r,n)}function Hm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function tC(t){if(typeof t=="function")return Hm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dm)return 11;if(t===hm)return 14}return 2}function Pn(t,e){var r=t.alternate;return r===null?(r=rr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Ll(t,e,r,n,s,i){var o=2;if(n=t,typeof t=="function")Hm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case zs:return cs(r.children,s,i,e);case um:o=8,s|=8;break;case Vd:return t=rr(12,r,e,s|2),t.elementType=Vd,t.lanes=i,t;case Md:return t=rr(13,r,e,s),t.elementType=Md,t.lanes=i,t;case Fd:return t=rr(19,r,e,s),t.elementType=Fd,t.lanes=i,t;case oy:return Kc(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case iy:o=10;break e;case ay:o=9;break e;case dm:o=11;break e;case hm:o=14;break e;case dn:o=16,n=null;break e}throw Error(X(130,t==null?t:typeof t,""))}return e=rr(o,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function cs(t,e,r,n){return t=rr(7,t,n,e),t.lanes=r,t}function Kc(t,e,r,n){return t=rr(22,t,n,e),t.elementType=oy,t.lanes=r,t.stateNode={isHidden:!1},t}function xd(t,e,r){return t=rr(6,t,null,e),t.lanes=r,t}function yd(t,e,r){return e=rr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function rC(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ju(0),this.expirationTimes=Ju(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ju(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Gm(t,e,r,n,s,i,o,l,u){return t=new rC(t,e,r,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=rr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},km(i),t}function nC(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$s,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Jv(t){if(!t)return Mn;t=t._reactInternals;e:{if(js(t)!==t||t.tag!==1)throw Error(X(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ft(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(X(171))}if(t.tag===1){var r=t.type;if(Ft(r))return Jy(t,r,e)}return e}function Zv(t,e,r,n,s,i,o,l,u){return t=Gm(r,n,!0,t,s,i,o,l,u),t.context=Jv(null),r=t.current,n=St(),s=kn(r),i=qr(n,s),i.callback=e??null,Tn(r,i,s),t.current.lanes=s,fo(t,s,n),Ut(t,n),t}function Qc(t,e,r,n){var s=e.current,i=St(),o=kn(s);return r=Jv(r),e.context===null?e.context=r:e.pendingContext=r,e=qr(i,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Tn(s,e,o),t!==null&&(hr(t,s,o,i),Il(t,s,o)),o}function gc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function u0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Km(t,e){u0(t,e),(t=t.alternate)&&u0(t,e)}function sC(){return null}var ew=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qm(t){this._internalRoot=t}Xc.prototype.render=Qm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(X(409));Qc(t,e,null,null)};Xc.prototype.unmount=Qm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;gs(function(){Qc(null,t,null,null)}),e[Gr]=null}};function Xc(t){this._internalRoot=t}Xc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Py();t={blockedOn:null,target:t,priority:e};for(var r=0;r<mn.length&&e!==0&&e<mn[r].priority;r++);mn.splice(r,0,t),r===0&&Ry(t)}};function Xm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Yc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function d0(){}function iC(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var d=gc(o);i.call(d)}}var o=Zv(e,n,t,0,null,!1,!1,"",d0);return t._reactRootContainer=o,t[Gr]=o.current,Wa(t.nodeType===8?t.parentNode:t),gs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var d=gc(u);l.call(d)}}var u=Gm(t,0,!1,null,null,!1,!1,"",d0);return t._reactRootContainer=u,t[Gr]=u.current,Wa(t.nodeType===8?t.parentNode:t),gs(function(){Qc(e,u,r,n)}),u}function Jc(t,e,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=gc(o);l.call(u)}}Qc(e,o,t,s)}else o=iC(r,e,t,s,n);return gc(o)}Iy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=ma(e.pendingLanes);r!==0&&(pm(e,r|1),Ut(e,We()),!(we&6)&&(xi=We()+500,Wn()))}break;case 13:gs(function(){var n=Kr(t,1);if(n!==null){var s=St();hr(n,t,1,s)}}),Km(t,1)}};gm=function(t){if(t.tag===13){var e=Kr(t,134217728);if(e!==null){var r=St();hr(e,t,134217728,r)}Km(t,134217728)}};ky=function(t){if(t.tag===13){var e=kn(t),r=Kr(t,e);if(r!==null){var n=St();hr(r,t,e,n)}Km(t,e)}};Py=function(){return Ee};Ay=function(t,e){var r=Ee;try{return Ee=t,e()}finally{Ee=r}};Qd=function(t,e,r){switch(e){case"input":if($d(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=$c(n);if(!s)throw Error(X(90));cy(n),$d(n,s)}}}break;case"textarea":dy(t,r);break;case"select":e=r.value,e!=null&&ti(t,!!r.multiple,e,!1)}};yy=zm;vy=gs;var aC={usingClientEntryPoint:!1,Events:[go,Gs,$c,gy,xy,zm]},la={findFiberByHostInstance:ss,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oC={bundleType:la.bundleType,version:la.version,rendererPackageName:la.rendererPackageName,rendererConfig:la.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:en.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=by(t),t===null?null:t.stateNode},findFiberByHostInstance:la.findFiberByHostInstance||sC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pl.isDisabled&&pl.supportsFiber)try{Mc=pl.inject(oC),Nr=pl}catch{}}Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aC;Yt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xm(e))throw Error(X(200));return nC(t,e,null,r)};Yt.createRoot=function(t,e){if(!Xm(t))throw Error(X(299));var r=!1,n="",s=ew;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Gm(t,1,!1,null,null,r,!1,n,s),t[Gr]=e.current,Wa(t.nodeType===8?t.parentNode:t),new Qm(e)};Yt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(X(188)):(t=Object.keys(t).join(","),Error(X(268,t)));return t=by(e),t=t===null?null:t.stateNode,t};Yt.flushSync=function(t){return gs(t)};Yt.hydrate=function(t,e,r){if(!Yc(e))throw Error(X(200));return Jc(null,t,e,!0,r)};Yt.hydrateRoot=function(t,e,r){if(!Xm(t))throw Error(X(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=ew;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Zv(e,null,t,1,r??null,s,!1,i,o),t[Gr]=e.current,Wa(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Xc(e)};Yt.render=function(t,e,r){if(!Yc(e))throw Error(X(200));return Jc(null,t,e,!1,r)};Yt.unmountComponentAtNode=function(t){if(!Yc(t))throw Error(X(40));return t._reactRootContainer?(gs(function(){Jc(null,null,t,!1,function(){t._reactRootContainer=null,t[Gr]=null})}),!0):!1};Yt.unstable_batchedUpdates=zm;Yt.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Yc(r))throw Error(X(200));if(t==null||t._reactInternals===void 0)throw Error(X(38));return Jc(t,e,r,!1,n)};Yt.version="18.3.1-next-f1338f8080-20240426";function tw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tw)}catch(t){console.error(t)}}tw(),ty.exports=Yt;var lC=ty.exports,h0=lC;Ld.createRoot=h0.createRoot,Ld.hydrateRoot=h0.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function eo(){return eo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},eo.apply(this,arguments)}var bn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(bn||(bn={}));const m0="popstate";function cC(t){t===void 0&&(t={});function e(n,s){let{pathname:i,search:o,hash:l}=n.location;return Th("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:xc(s)}return dC(e,r,null,t)}function Ve(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function rw(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function uC(){return Math.random().toString(36).substr(2,8)}function f0(t,e){return{usr:t.state,key:t.key,idx:e}}function Th(t,e,r,n){return r===void 0&&(r=null),eo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ri(e):e,{state:r,key:e&&e.key||n||uC()})}function xc(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Ri(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function dC(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,l=bn.Pop,u=null,d=h();d==null&&(d=0,o.replaceState(eo({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function f(){l=bn.Pop;let P=h(),N=P==null?null:P-d;d=P,u&&u({action:l,location:k.location,delta:N})}function p(P,N){l=bn.Push;let w=Th(k.location,P,N);d=h()+1;let S=f0(w,d),R=k.createHref(w);try{o.pushState(S,"",R)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;s.location.assign(R)}i&&u&&u({action:l,location:k.location,delta:1})}function b(P,N){l=bn.Replace;let w=Th(k.location,P,N);d=h();let S=f0(w,d),R=k.createHref(w);o.replaceState(S,"",R),i&&u&&u({action:l,location:k.location,delta:0})}function _(P){let N=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof P=="string"?P:xc(P);return w=w.replace(/ $/,"%20"),Ve(N,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,N)}let k={get action(){return l},get location(){return t(s,o)},listen(P){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(m0,f),u=P,()=>{s.removeEventListener(m0,f),u=null}},createHref(P){return e(s,P)},createURL:_,encodeLocation(P){let N=_(P);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:p,replace:b,go(P){return o.go(P)}};return k}var p0;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(p0||(p0={}));function hC(t,e,r){return r===void 0&&(r="/"),mC(t,e,r)}function mC(t,e,r,n){let s=typeof e=="string"?Ri(e):e,i=yi(s.pathname||"/",r);if(i==null)return null;let o=nw(t);fC(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=jC(i);l=NC(o[u],d)}return l}function nw(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,o,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(Ve(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let d=An([n,u.relativePath]),h=r.concat(u);i.children&&i.children.length>0&&(Ve(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),nw(i.children,e,h,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:_C(d,i.index),routesMeta:h})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let u of sw(i.path))s(i,o,u)}),e}function sw(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=sw(n.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function fC(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:bC(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const pC=/^:[\w-]+$/,gC=3,xC=2,yC=1,vC=10,wC=-2,g0=t=>t==="*";function _C(t,e){let r=t.split("/"),n=r.length;return r.some(g0)&&(n+=wC),e&&(n+=xC),r.filter(s=>!g0(s)).reduce((s,i)=>s+(pC.test(i)?gC:i===""?yC:vC),n)}function bC(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function NC(t,e,r){let{routesMeta:n}=t,s={},i="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],d=l===n.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=Ih({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),p=u.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:An([i,f.pathname]),pathnameBase:IC(An([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=An([i,f.pathnameBase]))}return o}function Ih(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=EC(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((d,h,f)=>{let{paramName:p,isOptional:b}=h;if(p==="*"){let k=l[f]||"";o=i.slice(0,i.length-k.length).replace(/(.)\/+$/,"$1")}const _=l[f];return b&&!_?d[p]=void 0:d[p]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function EC(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),rw(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function jC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return rw(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function yi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function CC(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?Ri(t):t;return{pathname:r?r.startsWith("/")?r:SC(r,e):e,search:kC(n),hash:PC(s)}}function SC(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function vd(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function TC(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Ym(t,e){let r=TC(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Jm(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=Ri(t):(s=eo({},t),Ve(!s.pathname||!s.pathname.includes("?"),vd("?","pathname","search",s)),Ve(!s.pathname||!s.pathname.includes("#"),vd("#","pathname","hash",s)),Ve(!s.search||!s.search.includes("#"),vd("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=r;else{let f=e.length-1;if(!n&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}l=f>=0?e[f]:"/"}let u=CC(s,l),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}const An=t=>t.join("/").replace(/\/\/+/g,"/"),IC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),kC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,PC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function AC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const iw=["post","put","patch","delete"];new Set(iw);const RC=["get",...iw];new Set(RC);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function to(){return to=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},to.apply(this,arguments)}const Zc=T.createContext(null),aw=T.createContext(null),tn=T.createContext(null),eu=T.createContext(null),rn=T.createContext({outlet:null,matches:[],isDataRoute:!1}),ow=T.createContext(null);function DC(t,e){let{relative:r}=e===void 0?{}:e;Di()||Ve(!1);let{basename:n,navigator:s}=T.useContext(tn),{hash:i,pathname:o,search:l}=tu(t,{relative:r}),u=o;return n!=="/"&&(u=o==="/"?n:An([n,o])),s.createHref({pathname:u,search:l,hash:i})}function Di(){return T.useContext(eu)!=null}function Cs(){return Di()||Ve(!1),T.useContext(eu).location}function lw(t){T.useContext(tn).static||T.useLayoutEffect(t)}function cw(){let{isDataRoute:t}=T.useContext(rn);return t?QC():LC()}function LC(){Di()||Ve(!1);let t=T.useContext(Zc),{basename:e,future:r,navigator:n}=T.useContext(tn),{matches:s}=T.useContext(rn),{pathname:i}=Cs(),o=JSON.stringify(Ym(s,r.v7_relativeSplatPath)),l=T.useRef(!1);return lw(()=>{l.current=!0}),T.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let f=Jm(d,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:An([e,f.pathname])),(h.replace?n.replace:n.push)(f,h.state,h)},[e,n,o,i,t])}const OC=T.createContext(null);function VC(t){let e=T.useContext(rn).outlet;return e&&T.createElement(OC.Provider,{value:t},e)}function tu(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=T.useContext(tn),{matches:s}=T.useContext(rn),{pathname:i}=Cs(),o=JSON.stringify(Ym(s,n.v7_relativeSplatPath));return T.useMemo(()=>Jm(t,JSON.parse(o),i,r==="path"),[t,o,i,r])}function MC(t,e){return FC(t,e)}function FC(t,e,r,n){Di()||Ve(!1);let{navigator:s}=T.useContext(tn),{matches:i}=T.useContext(rn),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let d=Cs(),h;if(e){var f;let P=typeof e=="string"?Ri(e):e;u==="/"||(f=P.pathname)!=null&&f.startsWith(u)||Ve(!1),h=P}else h=d;let p=h.pathname||"/",b=p;if(u!=="/"){let P=u.replace(/^\//,"").split("/");b="/"+p.replace(/^\//,"").split("/").slice(P.length).join("/")}let _=hC(t,{pathname:b}),k=qC(_&&_.map(P=>Object.assign({},P,{params:Object.assign({},l,P.params),pathname:An([u,s.encodeLocation?s.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?u:An([u,s.encodeLocation?s.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),i,r,n);return e&&k?T.createElement(eu.Provider,{value:{location:to({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:bn.Pop}},k):k}function UC(){let t=KC(),e=AC(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),r?T.createElement("pre",{style:s},r):null,null)}const BC=T.createElement(UC,null);class $C extends T.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?T.createElement(rn.Provider,{value:this.props.routeContext},T.createElement(ow.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function zC(t){let{routeContext:e,match:r,children:n}=t,s=T.useContext(Zc);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),T.createElement(rn.Provider,{value:e},n)}function qC(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,l=(s=r)==null?void 0:s.errors;if(l!=null){let h=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);h>=0||Ve(!1),o=o.slice(0,Math.min(o.length,h+1))}let u=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:p,errors:b}=r,_=f.route.loader&&p[f.route.id]===void 0&&(!b||b[f.route.id]===void 0);if(f.route.lazy||_){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,f,p)=>{let b,_=!1,k=null,P=null;r&&(b=l&&f.route.id?l[f.route.id]:void 0,k=f.route.errorElement||BC,u&&(d<0&&p===0?(XC("route-fallback"),_=!0,P=null):d===p&&(_=!0,P=f.route.hydrateFallbackElement||null)));let N=e.concat(o.slice(0,p+1)),w=()=>{let S;return b?S=k:_?S=P:f.route.Component?S=T.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=h,T.createElement(zC,{match:f,routeContext:{outlet:h,matches:N,isDataRoute:r!=null},children:S})};return r&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?T.createElement($C,{location:r.location,revalidation:r.revalidation,component:k,error:b,children:w(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):w()},null)}var uw=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(uw||{}),dw=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(dw||{});function WC(t){let e=T.useContext(Zc);return e||Ve(!1),e}function HC(t){let e=T.useContext(aw);return e||Ve(!1),e}function GC(t){let e=T.useContext(rn);return e||Ve(!1),e}function hw(t){let e=GC(),r=e.matches[e.matches.length-1];return r.route.id||Ve(!1),r.route.id}function KC(){var t;let e=T.useContext(ow),r=HC(),n=hw();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function QC(){let{router:t}=WC(uw.UseNavigateStable),e=hw(dw.UseNavigateStable),r=T.useRef(!1);return lw(()=>{r.current=!0}),T.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,to({fromRouteId:e},i)))},[t,e])}const x0={};function XC(t,e,r){x0[t]||(x0[t]=!0)}function YC(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Ol(t){let{to:e,replace:r,state:n,relative:s}=t;Di()||Ve(!1);let{future:i,static:o}=T.useContext(tn),{matches:l}=T.useContext(rn),{pathname:u}=Cs(),d=cw(),h=Jm(e,Ym(l,i.v7_relativeSplatPath),u,s==="path"),f=JSON.stringify(h);return T.useEffect(()=>d(JSON.parse(f),{replace:r,state:n,relative:s}),[d,f,s,r,n]),null}function JC(t){return VC(t.context)}function Rt(t){Ve(!1)}function ZC(t){let{basename:e="/",children:r=null,location:n,navigationType:s=bn.Pop,navigator:i,static:o=!1,future:l}=t;Di()&&Ve(!1);let u=e.replace(/^\/*/,"/"),d=T.useMemo(()=>({basename:u,navigator:i,static:o,future:to({v7_relativeSplatPath:!1},l)}),[u,l,i,o]);typeof n=="string"&&(n=Ri(n));let{pathname:h="/",search:f="",hash:p="",state:b=null,key:_="default"}=n,k=T.useMemo(()=>{let P=yi(h,u);return P==null?null:{location:{pathname:P,search:f,hash:p,state:b,key:_},navigationType:s}},[u,h,f,p,b,_,s]);return k==null?null:T.createElement(tn.Provider,{value:d},T.createElement(eu.Provider,{children:r,value:k}))}function eS(t){let{children:e,location:r}=t;return MC(kh(e),r)}new Promise(()=>{});function kh(t,e){e===void 0&&(e=[]);let r=[];return T.Children.forEach(t,(n,s)=>{if(!T.isValidElement(n))return;let i=[...e,s];if(n.type===T.Fragment){r.push.apply(r,kh(n.props.children,i));return}n.type!==Rt&&Ve(!1),!n.props.index||!n.props.children||Ve(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=kh(n.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yc(){return yc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yc.apply(this,arguments)}function mw(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function tS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function rS(t,e){return t.button===0&&(!e||e==="_self")&&!tS(t)}const nS=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],sS=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],iS="6";try{window.__reactRouterVersion=iS}catch{}const aS=T.createContext({isTransitioning:!1}),oS="startTransition",y0=YN[oS];function lS(t){let{basename:e,children:r,future:n,window:s}=t,i=T.useRef();i.current==null&&(i.current=cC({window:s,v5Compat:!0}));let o=i.current,[l,u]=T.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},h=T.useCallback(f=>{d&&y0?y0(()=>u(f)):u(f)},[u,d]);return T.useLayoutEffect(()=>o.listen(h),[o,h]),T.useEffect(()=>YC(n),[n]),T.createElement(ZC,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const cS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",uS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ts=T.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:i,replace:o,state:l,target:u,to:d,preventScrollReset:h,viewTransition:f}=e,p=mw(e,nS),{basename:b}=T.useContext(tn),_,k=!1;if(typeof d=="string"&&uS.test(d)&&(_=d,cS))try{let S=new URL(window.location.href),R=d.startsWith("//")?new URL(S.protocol+d):new URL(d),M=yi(R.pathname,b);R.origin===S.origin&&M!=null?d=M+R.search+R.hash:k=!0}catch{}let P=DC(d,{relative:s}),N=mS(d,{replace:o,state:l,target:u,preventScrollReset:h,relative:s,viewTransition:f});function w(S){n&&n(S),S.defaultPrevented||N(S)}return T.createElement("a",yc({},p,{href:_||P,onClick:k||i?n:w,ref:r,target:u}))}),dS=T.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:s=!1,className:i="",end:o=!1,style:l,to:u,viewTransition:d,children:h}=e,f=mw(e,sS),p=tu(u,{relative:f.relative}),b=Cs(),_=T.useContext(aw),{navigator:k,basename:P}=T.useContext(tn),N=_!=null&&fS(p)&&d===!0,w=k.encodeLocation?k.encodeLocation(p).pathname:p.pathname,S=b.pathname,R=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;s||(S=S.toLowerCase(),R=R?R.toLowerCase():null,w=w.toLowerCase()),R&&P&&(R=yi(R,P)||R);const M=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let $=S===w||!o&&S.startsWith(w)&&S.charAt(M)==="/",E=R!=null&&(R===w||!o&&R.startsWith(w)&&R.charAt(w.length)==="/"),x={isActive:$,isPending:E,isTransitioning:N},v=$?n:void 0,y;typeof i=="function"?y=i(x):y=[i,$?"active":null,E?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let D=typeof l=="function"?l(x):l;return T.createElement(ts,yc({},f,{"aria-current":v,className:y,ref:r,style:D,to:u,viewTransition:d}),typeof h=="function"?h(x):h)});var Ph;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Ph||(Ph={}));var v0;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(v0||(v0={}));function hS(t){let e=T.useContext(Zc);return e||Ve(!1),e}function mS(t,e){let{target:r,replace:n,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,u=cw(),d=Cs(),h=tu(t,{relative:o});return T.useCallback(f=>{if(rS(f,r)){f.preventDefault();let p=n!==void 0?n:xc(d)===xc(h);u(t,{replace:p,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[d,u,h,n,s,r,t,i,o,l])}function fS(t,e){e===void 0&&(e={});let r=T.useContext(aS);r==null&&Ve(!1);let{basename:n}=hS(Ph.useViewTransitionState),s=tu(t,{relative:e.relative});if(!r.isTransitioning)return!1;let i=yi(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=yi(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Ih(s.pathname,o)!=null||Ih(s.pathname,i)!=null}var w0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},pS=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],o=t[r++],l=t[r++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},pw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let p=(l&15)<<2|d>>6,b=d&63;u||(b=64,o||(p=64)),n.push(r[h],r[f],r[p],r[b])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(fw(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):pS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const d=s<t.length?r[t.charAt(s)]:64;++s;const f=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||f==null)throw new gS;const p=i<<2|l>>4;if(n.push(p),d!==64){const b=l<<4&240|d>>2;if(n.push(b),f!==64){const _=d<<6&192|f;n.push(_)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class gS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xS=function(t){const e=fw(t);return pw.encodeByteArray(e,!0)},vc=function(t){return xS(t).replace(/\./g,"")},gw=function(t){try{return pw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS=()=>yS().__FIREBASE_DEFAULTS__,wS=()=>{if(typeof process>"u"||typeof w0>"u")return;const t=w0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},_S=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&gw(t[1]);return e&&JSON.parse(e)},ru=()=>{try{return vS()||wS()||_S()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},xw=t=>{var e,r;return(r=(e=ru())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},yw=t=>{const e=xw(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},vw=()=>{var t;return(t=ru())===null||t===void 0?void 0:t.config},ww=t=>{var e;return(e=ru())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[vc(JSON.stringify(r)),vc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function NS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bt())}function ES(){var t;const e=(t=ru())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function jS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function SS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function TS(){const t=bt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function IS(){return!ES()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kS(){try{return typeof indexedDB=="object"}catch{return!1}}function PS(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="FirebaseError";class Rr extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=AS,Object.setPrototypeOf(this,Rr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yo.prototype.create)}}class yo{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?RS(i,n):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Rr(s,l,n)}}function RS(t,e){return t.replace(DS,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const DS=/\{\$([^}]+)}/g;function LS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wc(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],o=e[s];if(_0(i)&&_0(o)){if(!wc(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function _0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function pa(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ga(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function OS(t,e){const r=new VS(t,e);return r.subscribe.bind(r)}class VS{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");MS(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=wd),s.error===void 0&&(s.error=wd),s.complete===void 0&&(s.complete=wd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function MS(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function wd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(t){return t&&t._delegate?t._delegate:t}class Fn{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new bS;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(BS(e))try{this.getOrInitializeService({instanceIdentifier:rs})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=rs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=rs){return this.instances.has(e)}getOptions(e=rs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);n===l&&o.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:US(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=rs){return this.component?this.component.multipleInstances?e:rs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function US(t){return t===rs?void 0:t}function BS(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new FS(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ge;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ge||(ge={}));const zS={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},qS=ge.INFO,WS={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},HS=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=WS[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zm{constructor(e){this.name=e,this._logLevel=qS,this._logHandler=HS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?zS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}}const GS=(t,e)=>e.some(r=>t instanceof r);let b0,N0;function KS(){return b0||(b0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function QS(){return N0||(N0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const bw=new WeakMap,Ah=new WeakMap,Nw=new WeakMap,_d=new WeakMap,ef=new WeakMap;function XS(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(Rn(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&bw.set(r,t)}).catch(()=>{}),ef.set(e,t),e}function YS(t){if(Ah.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Ah.set(t,e)}let Rh={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Ah.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Nw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Rn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function JS(t){Rh=t(Rh)}function ZS(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(bd(this),e,...r);return Nw.set(n,e.sort?e.sort():[e]),Rn(n)}:QS().includes(t)?function(...e){return t.apply(bd(this),e),Rn(bw.get(this))}:function(...e){return Rn(t.apply(bd(this),e))}}function eT(t){return typeof t=="function"?ZS(t):(t instanceof IDBTransaction&&YS(t),GS(t,KS())?new Proxy(t,Rh):t)}function Rn(t){if(t instanceof IDBRequest)return XS(t);if(_d.has(t))return _d.get(t);const e=eT(t);return e!==t&&(_d.set(t,e),ef.set(e,t)),e}const bd=t=>ef.get(t);function tT(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Rn(o);return n&&o.addEventListener("upgradeneeded",u=>{n(Rn(o.result),u.oldVersion,u.newVersion,Rn(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const rT=["get","getKey","getAll","getAllKeys","count"],nT=["put","add","delete","clear"],Nd=new Map;function E0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Nd.get(e))return Nd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=nT.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||rT.includes(r)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return n&&(d=d.index(l.shift())),(await Promise.all([d[r](...l),s&&u.done]))[0]};return Nd.set(e,i),i}JS(t=>({...t,get:(e,r,n)=>E0(e,r)||t.get(e,r,n),has:(e,r)=>!!E0(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(iT(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function iT(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Dh="@firebase/app",j0="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr=new Zm("@firebase/app"),aT="@firebase/app-compat",oT="@firebase/analytics-compat",lT="@firebase/analytics",cT="@firebase/app-check-compat",uT="@firebase/app-check",dT="@firebase/auth",hT="@firebase/auth-compat",mT="@firebase/database",fT="@firebase/data-connect",pT="@firebase/database-compat",gT="@firebase/functions",xT="@firebase/functions-compat",yT="@firebase/installations",vT="@firebase/installations-compat",wT="@firebase/messaging",_T="@firebase/messaging-compat",bT="@firebase/performance",NT="@firebase/performance-compat",ET="@firebase/remote-config",jT="@firebase/remote-config-compat",CT="@firebase/storage",ST="@firebase/storage-compat",TT="@firebase/firestore",IT="@firebase/vertexai-preview",kT="@firebase/firestore-compat",PT="firebase",AT="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh="[DEFAULT]",RT={[Dh]:"fire-core",[aT]:"fire-core-compat",[lT]:"fire-analytics",[oT]:"fire-analytics-compat",[uT]:"fire-app-check",[cT]:"fire-app-check-compat",[dT]:"fire-auth",[hT]:"fire-auth-compat",[mT]:"fire-rtdb",[fT]:"fire-data-connect",[pT]:"fire-rtdb-compat",[gT]:"fire-fn",[xT]:"fire-fn-compat",[yT]:"fire-iid",[vT]:"fire-iid-compat",[wT]:"fire-fcm",[_T]:"fire-fcm-compat",[bT]:"fire-perf",[NT]:"fire-perf-compat",[ET]:"fire-rc",[jT]:"fire-rc-compat",[CT]:"fire-gcs",[ST]:"fire-gcs-compat",[TT]:"fire-fst",[kT]:"fire-fst-compat",[IT]:"fire-vertex","fire-js":"fire-js",[PT]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _c=new Map,DT=new Map,Oh=new Map;function C0(t,e){try{t.container.addComponent(e)}catch(r){Xr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function xs(t){const e=t.name;if(Oh.has(e))return Xr.debug(`There were multiple attempts to register component ${e}.`),!1;Oh.set(e,t);for(const r of _c.values())C0(r,t);for(const r of DT.values())C0(r,t);return!0}function nu(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ur(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Dn=new yo("app","Firebase",LT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Fn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Dn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss=AT;function Ew(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Lh,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Dn.create("bad-app-name",{appName:String(s)});if(r||(r=vw()),!r)throw Dn.create("no-options");const i=_c.get(s);if(i){if(wc(r,i.options)&&wc(n,i.config))return i;throw Dn.create("duplicate-app",{appName:s})}const o=new $S(s);for(const u of Oh.values())o.addComponent(u);const l=new OT(r,n,o);return _c.set(s,l),l}function tf(t=Lh){const e=_c.get(t);if(!e&&t===Lh&&vw())return Ew();if(!e)throw Dn.create("no-app",{appName:t});return e}function jr(t,e,r){var n;let s=(n=RT[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xr.warn(l.join(" "));return}xs(new Fn(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VT="firebase-heartbeat-database",MT=1,ro="firebase-heartbeat-store";let Ed=null;function jw(){return Ed||(Ed=tT(VT,MT,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ro)}catch(r){console.warn(r)}}}}).catch(t=>{throw Dn.create("idb-open",{originalErrorMessage:t.message})})),Ed}async function FT(t){try{const r=(await jw()).transaction(ro),n=await r.objectStore(ro).get(Cw(t));return await r.done,n}catch(e){if(e instanceof Rr)Xr.warn(e.message);else{const r=Dn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xr.warn(r.message)}}}async function S0(t,e){try{const n=(await jw()).transaction(ro,"readwrite");await n.objectStore(ro).put(e,Cw(t)),await n.done}catch(r){if(r instanceof Rr)Xr.warn(r.message);else{const n=Dn.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Xr.warn(n.message)}}}function Cw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UT=1024,BT=30*24*60*60*1e3;class $T{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new qT(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=T0();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=BT}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Xr.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=T0(),{heartbeatsToSend:n,unsentEntries:s}=zT(this._heartbeatsCache.heartbeats),i=vc(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Xr.warn(r),""}}}function T0(){return new Date().toISOString().substring(0,10)}function zT(t,e=UT){const r=[];let n=t.slice();for(const s of t){const i=r.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),I0(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),I0(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class qT{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kS()?PS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await FT(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return S0(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return S0(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function I0(t){return vc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(t){xs(new Fn("platform-logger",e=>new sT(e),"PRIVATE")),xs(new Fn("heartbeat",e=>new $T(e),"PRIVATE")),jr(Dh,j0,t),jr(Dh,j0,"esm2017"),jr("fire-js","")}WT("");function rf(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function Sw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const HT=Sw,Tw=new yo("auth","Firebase",Sw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bc=new Zm("@firebase/auth");function GT(t,...e){bc.logLevel<=ge.WARN&&bc.warn(`Auth (${Ss}): ${t}`,...e)}function Vl(t,...e){bc.logLevel<=ge.ERROR&&bc.error(`Auth (${Ss}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(t,...e){throw nf(t,...e)}function Cr(t,...e){return nf(t,...e)}function Iw(t,e,r){const n=Object.assign(Object.assign({},HT()),{[e]:r});return new yo("auth","Firebase",n).create(e,{appName:t.name})}function Ln(t){return Iw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nf(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Tw.create(t,...e)}function oe(t,e,...r){if(!t)throw nf(e,...r)}function Br(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Vl(e),new Error(e)}function Yr(t,e){t||Br(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function KT(){return k0()==="http:"||k0()==="https:"}function k0(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(KT()||CS()||"connection"in navigator)?navigator.onLine:!0}function XT(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,r){this.shortDelay=e,this.longDelay=r,Yr(r>e,"Short delay should be less than long delay!"),this.isMobile=NS()||SS()}get(){return QT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(t,e){Yr(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Br("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Br("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Br("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JT=new wo(3e4,6e4);function Ts(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Hn(t,e,r,n,s={}){return Pw(t,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const l=vo(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return jS()||(d.referrerPolicy="no-referrer"),kw.fetch()(Aw(t,t.config.apiHost,r,l),d)})}async function Pw(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},YT),e);try{const s=new e1(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw gl(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw gl(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw gl(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw gl(t,"user-disabled",o);const h=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Iw(t,h,d);pr(t,h)}}catch(s){if(s instanceof Rr)throw s;pr(t,"network-request-failed",{message:String(s)})}}async function su(t,e,r,n,s={}){const i=await Hn(t,e,r,n,s);return"mfaPendingCredential"in i&&pr(t,"multi-factor-auth-required",{_serverResponse:i}),i}function Aw(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?sf(t.config,s):`${t.config.apiScheme}://${s}`}function ZT(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class e1{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Cr(this.auth,"network-request-failed")),JT.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function gl(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=Cr(t,e,n);return s.customData._tokenResponse=r,s}function P0(t){return t!==void 0&&t.enterprise!==void 0}class t1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return ZT(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function r1(t,e){return Hn(t,"GET","/v2/recaptchaConfig",Ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n1(t,e){return Hn(t,"POST","/v1/accounts:delete",e)}async function Rw(t,e){return Hn(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function s1(t,e=!1){const r=Ae(t),n=await r.getIdToken(e),s=af(n);oe(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Pa(jd(s.auth_time)),issuedAtTime:Pa(jd(s.iat)),expirationTime:Pa(jd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function jd(t){return Number(t)*1e3}function af(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Vl("JWT malformed, contained fewer than 3 sections"),null;try{const s=gw(r);return s?JSON.parse(s):(Vl("Failed to decode base64 JWT payload"),null)}catch(s){return Vl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function A0(t){const e=af(t);return oe(e,"internal-error"),oe(typeof e.exp<"u","internal-error"),oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function no(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Rr&&i1(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function i1({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pa(this.lastLoginAt),this.creationTime=Pa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nc(t){var e;const r=t.auth,n=await t.getIdToken(),s=await no(t,Rw(r,{idToken:n}));oe(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Dw(i.providerUserInfo):[],l=l1(t.providerData,o),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=u?d:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Mh(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function o1(t){const e=Ae(t);await Nc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function l1(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function Dw(t){return t.map(e=>{var{providerId:r}=e,n=rf(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c1(t,e){const r=await Pw(t,{},async()=>{const n=vo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=Aw(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",kw.fetch()(o,{method:"POST",headers:l,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function u1(t,e){return Hn(t,"POST","/v2/accounts:revokeToken",Ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){oe(e.idToken,"internal-error"),oe(typeof e.idToken<"u","internal-error"),oe(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):A0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){oe(e.length!==0,"internal-error");const r=A0(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await c1(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,o=new oi;return n&&(oe(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(oe(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(oe(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new oi,this.toJSON())}_performRefresh(){return Br("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(t,e){oe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class $r{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=rf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new a1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Mh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await no(this,this.stsTokenManager.getToken(this.auth,e));return oe(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return s1(this,e)}reload(){return o1(this)}_assign(e){this!==e&&(oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new $r(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Nc(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ur(this.auth.app))return Promise.reject(Ln(this.auth));const e=await this.getIdToken();return await no(this,n1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,o,l,u,d,h;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,p=(s=r.email)!==null&&s!==void 0?s:void 0,b=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,_=(o=r.photoURL)!==null&&o!==void 0?o:void 0,k=(l=r.tenantId)!==null&&l!==void 0?l:void 0,P=(u=r._redirectEventId)!==null&&u!==void 0?u:void 0,N=(d=r.createdAt)!==null&&d!==void 0?d:void 0,w=(h=r.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:S,emailVerified:R,isAnonymous:M,providerData:$,stsTokenManager:E}=r;oe(S&&E,e,"internal-error");const x=oi.fromJSON(this.name,E);oe(typeof S=="string",e,"internal-error"),un(f,e.name),un(p,e.name),oe(typeof R=="boolean",e,"internal-error"),oe(typeof M=="boolean",e,"internal-error"),un(b,e.name),un(_,e.name),un(k,e.name),un(P,e.name),un(N,e.name),un(w,e.name);const v=new $r({uid:S,auth:e,email:p,emailVerified:R,displayName:f,isAnonymous:M,photoURL:_,phoneNumber:b,tenantId:k,stsTokenManager:x,createdAt:N,lastLoginAt:w});return $&&Array.isArray($)&&(v.providerData=$.map(y=>Object.assign({},y))),P&&(v._redirectEventId=P),v}static async _fromIdTokenResponse(e,r,n=!1){const s=new oi;s.updateFromServerResponse(r);const i=new $r({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Nc(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];oe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Dw(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new oi;l.updateFromIdToken(n);const u=new $r({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Mh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0=new Map;function zr(t){Yr(t instanceof Function,"Expected a class definition");let e=R0.get(t);return e?(Yr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,R0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Lw.type="NONE";const D0=Lw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ml(t,e,r){return`firebase:${t}:${e}:${r}`}class li{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=Ml(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ml("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$r._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new li(zr(D0),e,n);const s=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||zr(D0);const o=Ml(n,e.config.apiKey,e.name);let l=null;for(const d of r)try{const h=await d._get(o);if(h){const f=$r._fromJSON(e,h);d!==i&&(l=f),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new li(i,e,n):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(r.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new li(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Fw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ow(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Bw(e))return"Blackberry";if($w(e))return"Webos";if(Vw(e))return"Safari";if((e.includes("chrome/")||Mw(e))&&!e.includes("edge/"))return"Chrome";if(Uw(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Ow(t=bt()){return/firefox\//i.test(t)}function Vw(t=bt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Mw(t=bt()){return/crios\//i.test(t)}function Fw(t=bt()){return/iemobile/i.test(t)}function Uw(t=bt()){return/android/i.test(t)}function Bw(t=bt()){return/blackberry/i.test(t)}function $w(t=bt()){return/webos/i.test(t)}function of(t=bt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function d1(t=bt()){var e;return of(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function h1(){return TS()&&document.documentMode===10}function zw(t=bt()){return of(t)||Uw(t)||$w(t)||Bw(t)||/windows phone/i.test(t)||Fw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qw(t,e=[]){let r;switch(t){case"Browser":r=L0(bt());break;case"Worker":r=`${L0(bt())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ss}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f1(t,e={}){return Hn(t,"GET","/v2/passwordPolicy",Ts(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1=6;class g1{constructor(e){var r,n,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:p1,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(r=u.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(n=u.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new O0(this),this.idTokenSubscription=new O0(this),this.beforeStateQueue=new m1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Tw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=zr(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await li.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Rw(this,{idToken:e}),n=await $r._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Ur(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Nc(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=XT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ur(this.app))return Promise.reject(Ln(this));const r=e?Ae(e):null;return r&&oe(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ur(this.app)?Promise.reject(Ln(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ur(this.app)?Promise.reject(Ln(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await f1(this),r=new g1(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new yo("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await u1(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&zr(e)||this._popupRedirectResolver;oe(r,this,"argument-error"),this.redirectPersistenceManager=await li.create(this,[zr(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(oe(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,s);return()=>{o=!0,u()}}else{const u=e.addObserver(r);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&GT(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Li(t){return Ae(t)}class O0{constructor(e){this.auth=e,this.observer=null,this.addObserver=OS(r=>this.observer=r)}get next(){return oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function y1(t){iu=t}function Ww(t){return iu.loadJS(t)}function v1(){return iu.recaptchaEnterpriseScript}function w1(){return iu.gapiScript}function _1(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const b1="recaptcha-enterprise",N1="NO_RECAPTCHA";class E1{constructor(e){this.type=b1,this.auth=Li(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{r1(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new t1(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{l(u)})})}function s(i,o,l){const u=window.grecaptcha;P0(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(N1)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{n(this.auth).then(l=>{if(!r&&P0(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=v1();u.length!==0&&(u+=l),Ww(u).then(()=>{s(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function V0(t,e,r,n=!1){const s=new E1(t);let i;try{i=await s.verify(r)}catch{i=await s.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function M0(t,e,r,n){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await V0(t,e,r,r==="getOobCode");return n(t,i)}else return n(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await V0(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(t,e){const r=nu(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(wc(i,e??{}))return s;pr(s,"already-initialized")}return r.initialize({options:e})}function C1(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(zr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function S1(t,e,r){const n=Li(t);oe(n._canInitEmulator,n,"emulator-config-failed"),oe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=Hw(e),{host:o,port:l}=T1(e),u=l===null?"":`:${l}`;n.config.emulator={url:`${i}//${o}${u}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),I1()}function Hw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function T1(t){const e=Hw(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:F0(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:F0(o)}}}function F0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function I1(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Br("not implemented")}_getIdTokenResponse(e){return Br("not implemented")}_linkToIdToken(e,r){return Br("not implemented")}_getReauthenticationResolver(e){return Br("not implemented")}}async function k1(t,e){return Hn(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P1(t,e){return su(t,"POST","/v1/accounts:signInWithPassword",Ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A1(t,e){return su(t,"POST","/v1/accounts:signInWithEmailLink",Ts(t,e))}async function R1(t,e){return su(t,"POST","/v1/accounts:signInWithEmailLink",Ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so extends lf{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new so(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new so(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return M0(e,r,"signInWithPassword",P1);case"emailLink":return A1(e,{email:this._email,oobCode:this._password});default:pr(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return M0(e,n,"signUpPassword",k1);case"emailLink":return R1(e,{idToken:r,email:this._email,oobCode:this._password});default:pr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ci(t,e){return su(t,"POST","/v1/accounts:signInWithIdp",Ts(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="http://localhost";class ys extends lf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ys(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):pr("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=rf(r,["providerId","signInMethod"]);if(!n||!s)return null;const o=new ys(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return ci(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ci(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ci(e,r)}buildRequest(){const e={requestUri:D1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=vo(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L1(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function O1(t){const e=pa(ga(t)).link,r=e?pa(ga(e)).deep_link_id:null,n=pa(ga(t)).deep_link_id;return(n?pa(ga(n)).link:null)||n||r||e||t}class cf{constructor(e){var r,n,s,i,o,l;const u=pa(ga(e)),d=(r=u.apiKey)!==null&&r!==void 0?r:null,h=(n=u.oobCode)!==null&&n!==void 0?n:null,f=L1((s=u.mode)!==null&&s!==void 0?s:null);oe(d&&h&&f,"argument-error"),this.apiKey=d,this.operation=f,this.code=h,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=u.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=u.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const r=O1(e);try{return new cf(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(){this.providerId=Oi.PROVIDER_ID}static credential(e,r){return so._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=cf.parseLink(r);return oe(n,"argument-error"),so._fromEmailAndCode(e,n.code,n.tenantId)}}Oi.PROVIDER_ID="password";Oi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Oi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o extends Gw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn extends _o{constructor(){super("facebook.com")}static credential(e){return ys._fromParams({providerId:pn.PROVIDER_ID,signInMethod:pn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pn.credentialFromTaggedObject(e)}static credentialFromError(e){return pn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pn.credential(e.oauthAccessToken)}catch{return null}}}pn.FACEBOOK_SIGN_IN_METHOD="facebook.com";pn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn extends _o{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ys._fromParams({providerId:gn.PROVIDER_ID,signInMethod:gn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return gn.credentialFromTaggedObject(e)}static credentialFromError(e){return gn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return gn.credential(r,n)}catch{return null}}}gn.GOOGLE_SIGN_IN_METHOD="google.com";gn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn extends _o{constructor(){super("github.com")}static credential(e){return ys._fromParams({providerId:xn.PROVIDER_ID,signInMethod:xn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xn.credentialFromTaggedObject(e)}static credentialFromError(e){return xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xn.credential(e.oauthAccessToken)}catch{return null}}}xn.GITHUB_SIGN_IN_METHOD="github.com";xn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn extends _o{constructor(){super("twitter.com")}static credential(e,r){return ys._fromParams({providerId:yn.PROVIDER_ID,signInMethod:yn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return yn.credentialFromTaggedObject(e)}static credentialFromError(e){return yn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return yn.credential(r,n)}catch{return null}}}yn.TWITTER_SIGN_IN_METHOD="twitter.com";yn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await $r._fromIdTokenResponse(e,n,s),o=U0(n);return new vi({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=U0(n);return new vi({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function U0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec extends Rr{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Ec.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Ec(e,r,n,s)}}function Kw(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ec._fromErrorAndOperation(t,i,e,n):i})}async function V1(t,e,r=!1){const n=await no(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return vi._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M1(t,e,r=!1){const{auth:n}=t;if(Ur(n.app))return Promise.reject(Ln(n));const s="reauthenticate";try{const i=await no(t,Kw(n,s,e,t),r);oe(i.idToken,n,"internal-error");const o=af(i.idToken);oe(o,n,"internal-error");const{sub:l}=o;return oe(t.uid===l,n,"user-mismatch"),vi._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&pr(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qw(t,e,r=!1){if(Ur(t.app))return Promise.reject(Ln(t));const n="signIn",s=await Kw(t,n,e),i=await vi._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function F1(t,e){return Qw(Li(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U1(t){const e=Li(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function B1(t,e,r){return Ur(t.app)?Promise.reject(Ln(t)):F1(Ae(t),Oi.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&U1(t),n})}function $1(t,e,r,n){return Ae(t).onIdTokenChanged(e,r,n)}function z1(t,e,r){return Ae(t).beforeAuthStateChanged(e,r)}function q1(t,e,r,n){return Ae(t).onAuthStateChanged(e,r,n)}function W1(t){return Ae(t).signOut()}const jc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(jc,"1"),this.storage.removeItem(jc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1=1e3,G1=10;class Yw extends Xw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);h1()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,G1):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},H1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Yw.type="LOCAL";const K1=Yw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw extends Xw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Jw.type="SESSION";const Zw=Jw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new au(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const l=Array.from(o).map(async d=>d(r.origin,i)),u=await Q1(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}au.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const d=uf("",20);s.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(f){const p=f;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(p.data.response);break;default:clearTimeout(h),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(){return window}function Y1(t){Sr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(){return typeof Sr().WorkerGlobalScope<"u"&&typeof Sr().importScripts=="function"}async function J1(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Z1(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function eI(){return e_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_="firebaseLocalStorageDb",tI=1,Cc="firebaseLocalStorage",r_="fbase_key";class bo{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function ou(t,e){return t.transaction([Cc],e?"readwrite":"readonly").objectStore(Cc)}function rI(){const t=indexedDB.deleteDatabase(t_);return new bo(t).toPromise()}function Fh(){const t=indexedDB.open(t_,tI);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Cc,{keyPath:r_})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Cc)?e(n):(n.close(),await rI(),e(await Fh()))})})}async function B0(t,e,r){const n=ou(t,!0).put({[r_]:e,value:r});return new bo(n).toPromise()}async function nI(t,e){const r=ou(t,!1).get(e),n=await new bo(r).toPromise();return n===void 0?null:n.value}function $0(t,e){const r=ou(t,!0).delete(e);return new bo(r).toPromise()}const sI=800,iI=3;class n_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Fh(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>iI)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return e_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=au._getInstance(eI()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await J1(),!this.activeServiceWorker)return;this.sender=new X1(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Z1()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Fh();return await B0(e,jc,"1"),await $0(e,jc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>B0(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>nI(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>$0(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=ou(s,!1).getAll();return new bo(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}n_.type="LOCAL";const aI=n_;new wo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(t,e){return e?zr(e):(oe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df extends lf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ci(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ci(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ci(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function lI(t){return Qw(t.auth,new df(t),t.bypassAuthState)}function cI(t){const{auth:e,user:r}=t;return oe(r,e,"internal-error"),M1(r,new df(t),t.bypassAuthState)}async function uI(t){const{auth:e,user:r}=t;return oe(r,e,"internal-error"),V1(r,new df(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lI;case"linkViaPopup":case"linkViaRedirect":return uI;case"reauthViaPopup":case"reauthViaRedirect":return cI;default:pr(this.auth,"internal-error")}}resolve(e){Yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI=new wo(2e3,1e4);class ei extends s_{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,ei.currentPopupAction&&ei.currentPopupAction.cancel(),ei.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return oe(e,this.auth,"internal-error"),e}async onExecution(){Yr(this.filter.length===1,"Popup operations only handle one event");const e=uf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Cr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Cr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ei.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Cr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,dI.get())};e()}}ei.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI="pendingRedirect",Fl=new Map;class mI extends s_{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Fl.get(this.auth._key());if(!e){try{const n=await fI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Fl.set(this.auth._key(),e)}return this.bypassAuthState||Fl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function fI(t,e){const r=xI(e),n=gI(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function pI(t,e){Fl.set(t._key(),e)}function gI(t){return zr(t._redirectPersistence)}function xI(t){return Ml(hI,t.config.apiKey,t.name)}async function yI(t,e,r=!1){if(Ur(t.app))return Promise.reject(Ln(t));const n=Li(t),s=oI(n,e),o=await new mI(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI=10*60*1e3;class wI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_I(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!i_(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Cr(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vI&&this.cachedEventUids.clear(),this.cachedEventUids.has(z0(e))}saveEventToCache(e){this.cachedEventUids.add(z0(e)),this.lastProcessedEventTime=Date.now()}}function z0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function i_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function _I(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return i_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bI(t,e={}){return Hn(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,EI=/^https?/;async function jI(t){if(t.config.emulator)return;const{authorizedDomains:e}=await bI(t);for(const r of e)try{if(CI(r))return}catch{}pr(t,"unauthorized-domain")}function CI(t){const e=Vh(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!EI.test(r))return!1;if(NI.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI=new wo(3e4,6e4);function q0(){const t=Sr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function TI(t){return new Promise((e,r)=>{var n,s,i;function o(){q0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{q0(),r(Cr(t,"network-request-failed"))},timeout:SI.get()})}if(!((s=(n=Sr().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Sr().gapi)===null||i===void 0)&&i.load)o();else{const l=_1("iframefcb");return Sr()[l]=()=>{gapi.load?o():r(Cr(t,"network-request-failed"))},Ww(`${w1()}?onload=${l}`).catch(u=>r(u))}}).catch(e=>{throw Ul=null,e})}let Ul=null;function II(t){return Ul=Ul||TI(t),Ul}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI=new wo(5e3,15e3),PI="__/auth/iframe",AI="emulator/auth/iframe",RI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},DI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function LI(t){const e=t.config;oe(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?sf(e,AI):`https://${t.config.authDomain}/${PI}`,n={apiKey:e.apiKey,appName:t.name,v:Ss},s=DI.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${vo(n).slice(1)}`}async function OI(t){const e=await II(t),r=Sr().gapi;return oe(r,t,"internal-error"),e.open({where:document.body,url:LI(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RI,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=Cr(t,"network-request-failed"),l=Sr().setTimeout(()=>{i(o)},kI.get());function u(){Sr().clearTimeout(l),s(n)}n.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},MI=500,FI=600,UI="_blank",BI="http://localhost";class W0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $I(t,e,r,n=MI,s=FI){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const u=Object.assign(Object.assign({},VI),{width:n.toString(),height:s.toString(),top:i,left:o}),d=bt().toLowerCase();r&&(l=Mw(d)?UI:r),Ow(d)&&(e=e||BI,u.scrollbars="yes");const h=Object.entries(u).reduce((p,[b,_])=>`${p}${b}=${_},`,"");if(d1(d)&&l!=="_self")return zI(e||"",l),new W0(null);const f=window.open(e||"",l,h);oe(f,t,"popup-blocked");try{f.focus()}catch{}return new W0(f)}function zI(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qI="__/auth/handler",WI="emulator/auth/handler",HI=encodeURIComponent("fac");async function H0(t,e,r,n,s,i){oe(t.config.authDomain,t,"auth-domain-config-required"),oe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ss,eventId:s};if(e instanceof Gw){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",LS(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof _o){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const u=await t._getAppCheckToken(),d=u?`#${HI}=${encodeURIComponent(u)}`:"";return`${GI(t)}?${vo(l).slice(1)}${d}`}function GI({config:t}){return t.emulator?sf(t,WI):`https://${t.authDomain}/${qI}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd="webStorageSupport";class KI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Zw,this._completeRedirectFn=yI,this._overrideRedirectResult=pI}async _openPopup(e,r,n,s){var i;Yr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await H0(e,r,n,Vh(),s);return $I(e,o,uf())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await H0(e,r,n,Vh(),s);return Y1(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Yr(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await OI(e),n=new wI(e);return r.register("authEvent",s=>(oe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Cd,{type:Cd},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Cd];o!==void 0&&r(!!o),pr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=jI(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return zw()||Vw()||of()}}const QI=KI;var G0="@firebase/auth",K0="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YI(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function JI(t){xs(new Fn("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;oe(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qw(t)},d=new x1(n,s,i,u);return C1(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),xs(new Fn("auth-internal",e=>{const r=Li(e.getProvider("auth").getImmediate());return(n=>new XI(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),jr(G0,K0,YI(t)),jr(G0,K0,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI=5*60,ek=ww("authIdTokenMaxAge")||ZI;let Q0=null;const tk=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>ek)return;const s=r==null?void 0:r.token;Q0!==s&&(Q0=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function rk(t=tf()){const e=nu(t,"auth");if(e.isInitialized())return e.getImmediate();const r=j1(t,{popupRedirectResolver:QI,persistence:[aI,K1,Zw]}),n=ww("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=tk(i.toString());z1(r,o,()=>o(r.currentUser)),$1(r,l=>o(l))}}const s=xw("auth");return s&&S1(r,`http://${s}`),r}function nk(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}y1({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=Cr("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",nk().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});JI("Browser");var sk="firebase",ik="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jr(sk,ik,"app");var X0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var us,a_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,x){function v(){}v.prototype=x.prototype,E.D=x.prototype,E.prototype=new v,E.prototype.constructor=E,E.C=function(y,D,I){for(var j=Array(arguments.length-2),te=2;te<arguments.length;te++)j[te-2]=arguments[te];return x.prototype[D].apply(y,j)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,x,v){v||(v=0);var y=Array(16);if(typeof x=="string")for(var D=0;16>D;++D)y[D]=x.charCodeAt(v++)|x.charCodeAt(v++)<<8|x.charCodeAt(v++)<<16|x.charCodeAt(v++)<<24;else for(D=0;16>D;++D)y[D]=x[v++]|x[v++]<<8|x[v++]<<16|x[v++]<<24;x=E.g[0],v=E.g[1],D=E.g[2];var I=E.g[3],j=x+(I^v&(D^I))+y[0]+3614090360&4294967295;x=v+(j<<7&4294967295|j>>>25),j=I+(D^x&(v^D))+y[1]+3905402710&4294967295,I=x+(j<<12&4294967295|j>>>20),j=D+(v^I&(x^v))+y[2]+606105819&4294967295,D=I+(j<<17&4294967295|j>>>15),j=v+(x^D&(I^x))+y[3]+3250441966&4294967295,v=D+(j<<22&4294967295|j>>>10),j=x+(I^v&(D^I))+y[4]+4118548399&4294967295,x=v+(j<<7&4294967295|j>>>25),j=I+(D^x&(v^D))+y[5]+1200080426&4294967295,I=x+(j<<12&4294967295|j>>>20),j=D+(v^I&(x^v))+y[6]+2821735955&4294967295,D=I+(j<<17&4294967295|j>>>15),j=v+(x^D&(I^x))+y[7]+4249261313&4294967295,v=D+(j<<22&4294967295|j>>>10),j=x+(I^v&(D^I))+y[8]+1770035416&4294967295,x=v+(j<<7&4294967295|j>>>25),j=I+(D^x&(v^D))+y[9]+2336552879&4294967295,I=x+(j<<12&4294967295|j>>>20),j=D+(v^I&(x^v))+y[10]+4294925233&4294967295,D=I+(j<<17&4294967295|j>>>15),j=v+(x^D&(I^x))+y[11]+2304563134&4294967295,v=D+(j<<22&4294967295|j>>>10),j=x+(I^v&(D^I))+y[12]+1804603682&4294967295,x=v+(j<<7&4294967295|j>>>25),j=I+(D^x&(v^D))+y[13]+4254626195&4294967295,I=x+(j<<12&4294967295|j>>>20),j=D+(v^I&(x^v))+y[14]+2792965006&4294967295,D=I+(j<<17&4294967295|j>>>15),j=v+(x^D&(I^x))+y[15]+1236535329&4294967295,v=D+(j<<22&4294967295|j>>>10),j=x+(D^I&(v^D))+y[1]+4129170786&4294967295,x=v+(j<<5&4294967295|j>>>27),j=I+(v^D&(x^v))+y[6]+3225465664&4294967295,I=x+(j<<9&4294967295|j>>>23),j=D+(x^v&(I^x))+y[11]+643717713&4294967295,D=I+(j<<14&4294967295|j>>>18),j=v+(I^x&(D^I))+y[0]+3921069994&4294967295,v=D+(j<<20&4294967295|j>>>12),j=x+(D^I&(v^D))+y[5]+3593408605&4294967295,x=v+(j<<5&4294967295|j>>>27),j=I+(v^D&(x^v))+y[10]+38016083&4294967295,I=x+(j<<9&4294967295|j>>>23),j=D+(x^v&(I^x))+y[15]+3634488961&4294967295,D=I+(j<<14&4294967295|j>>>18),j=v+(I^x&(D^I))+y[4]+3889429448&4294967295,v=D+(j<<20&4294967295|j>>>12),j=x+(D^I&(v^D))+y[9]+568446438&4294967295,x=v+(j<<5&4294967295|j>>>27),j=I+(v^D&(x^v))+y[14]+3275163606&4294967295,I=x+(j<<9&4294967295|j>>>23),j=D+(x^v&(I^x))+y[3]+4107603335&4294967295,D=I+(j<<14&4294967295|j>>>18),j=v+(I^x&(D^I))+y[8]+1163531501&4294967295,v=D+(j<<20&4294967295|j>>>12),j=x+(D^I&(v^D))+y[13]+2850285829&4294967295,x=v+(j<<5&4294967295|j>>>27),j=I+(v^D&(x^v))+y[2]+4243563512&4294967295,I=x+(j<<9&4294967295|j>>>23),j=D+(x^v&(I^x))+y[7]+1735328473&4294967295,D=I+(j<<14&4294967295|j>>>18),j=v+(I^x&(D^I))+y[12]+2368359562&4294967295,v=D+(j<<20&4294967295|j>>>12),j=x+(v^D^I)+y[5]+4294588738&4294967295,x=v+(j<<4&4294967295|j>>>28),j=I+(x^v^D)+y[8]+2272392833&4294967295,I=x+(j<<11&4294967295|j>>>21),j=D+(I^x^v)+y[11]+1839030562&4294967295,D=I+(j<<16&4294967295|j>>>16),j=v+(D^I^x)+y[14]+4259657740&4294967295,v=D+(j<<23&4294967295|j>>>9),j=x+(v^D^I)+y[1]+2763975236&4294967295,x=v+(j<<4&4294967295|j>>>28),j=I+(x^v^D)+y[4]+1272893353&4294967295,I=x+(j<<11&4294967295|j>>>21),j=D+(I^x^v)+y[7]+4139469664&4294967295,D=I+(j<<16&4294967295|j>>>16),j=v+(D^I^x)+y[10]+3200236656&4294967295,v=D+(j<<23&4294967295|j>>>9),j=x+(v^D^I)+y[13]+681279174&4294967295,x=v+(j<<4&4294967295|j>>>28),j=I+(x^v^D)+y[0]+3936430074&4294967295,I=x+(j<<11&4294967295|j>>>21),j=D+(I^x^v)+y[3]+3572445317&4294967295,D=I+(j<<16&4294967295|j>>>16),j=v+(D^I^x)+y[6]+76029189&4294967295,v=D+(j<<23&4294967295|j>>>9),j=x+(v^D^I)+y[9]+3654602809&4294967295,x=v+(j<<4&4294967295|j>>>28),j=I+(x^v^D)+y[12]+3873151461&4294967295,I=x+(j<<11&4294967295|j>>>21),j=D+(I^x^v)+y[15]+530742520&4294967295,D=I+(j<<16&4294967295|j>>>16),j=v+(D^I^x)+y[2]+3299628645&4294967295,v=D+(j<<23&4294967295|j>>>9),j=x+(D^(v|~I))+y[0]+4096336452&4294967295,x=v+(j<<6&4294967295|j>>>26),j=I+(v^(x|~D))+y[7]+1126891415&4294967295,I=x+(j<<10&4294967295|j>>>22),j=D+(x^(I|~v))+y[14]+2878612391&4294967295,D=I+(j<<15&4294967295|j>>>17),j=v+(I^(D|~x))+y[5]+4237533241&4294967295,v=D+(j<<21&4294967295|j>>>11),j=x+(D^(v|~I))+y[12]+1700485571&4294967295,x=v+(j<<6&4294967295|j>>>26),j=I+(v^(x|~D))+y[3]+2399980690&4294967295,I=x+(j<<10&4294967295|j>>>22),j=D+(x^(I|~v))+y[10]+4293915773&4294967295,D=I+(j<<15&4294967295|j>>>17),j=v+(I^(D|~x))+y[1]+2240044497&4294967295,v=D+(j<<21&4294967295|j>>>11),j=x+(D^(v|~I))+y[8]+1873313359&4294967295,x=v+(j<<6&4294967295|j>>>26),j=I+(v^(x|~D))+y[15]+4264355552&4294967295,I=x+(j<<10&4294967295|j>>>22),j=D+(x^(I|~v))+y[6]+2734768916&4294967295,D=I+(j<<15&4294967295|j>>>17),j=v+(I^(D|~x))+y[13]+1309151649&4294967295,v=D+(j<<21&4294967295|j>>>11),j=x+(D^(v|~I))+y[4]+4149444226&4294967295,x=v+(j<<6&4294967295|j>>>26),j=I+(v^(x|~D))+y[11]+3174756917&4294967295,I=x+(j<<10&4294967295|j>>>22),j=D+(x^(I|~v))+y[2]+718787259&4294967295,D=I+(j<<15&4294967295|j>>>17),j=v+(I^(D|~x))+y[9]+3951481745&4294967295,E.g[0]=E.g[0]+x&4294967295,E.g[1]=E.g[1]+(D+(j<<21&4294967295|j>>>11))&4294967295,E.g[2]=E.g[2]+D&4294967295,E.g[3]=E.g[3]+I&4294967295}n.prototype.u=function(E,x){x===void 0&&(x=E.length);for(var v=x-this.blockSize,y=this.B,D=this.h,I=0;I<x;){if(D==0)for(;I<=v;)s(this,E,I),I+=this.blockSize;if(typeof E=="string"){for(;I<x;)if(y[D++]=E.charCodeAt(I++),D==this.blockSize){s(this,y),D=0;break}}else for(;I<x;)if(y[D++]=E[I++],D==this.blockSize){s(this,y),D=0;break}}this.h=D,this.o+=x},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var x=1;x<E.length-8;++x)E[x]=0;var v=8*this.o;for(x=E.length-8;x<E.length;++x)E[x]=v&255,v/=256;for(this.u(E),E=Array(16),x=v=0;4>x;++x)for(var y=0;32>y;y+=8)E[v++]=this.g[x]>>>y&255;return E};function i(E,x){var v=l;return Object.prototype.hasOwnProperty.call(v,E)?v[E]:v[E]=x(E)}function o(E,x){this.h=x;for(var v=[],y=!0,D=E.length-1;0<=D;D--){var I=E[D]|0;y&&I==x||(v[D]=I,y=!1)}this.g=v}var l={};function u(E){return-128<=E&&128>E?i(E,function(x){return new o([x|0],0>x?-1:0)}):new o([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return f;if(0>E)return P(d(-E));for(var x=[],v=1,y=0;E>=v;y++)x[y]=E/v|0,v*=4294967296;return new o(x,0)}function h(E,x){if(E.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(E.charAt(0)=="-")return P(h(E.substring(1),x));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=d(Math.pow(x,8)),y=f,D=0;D<E.length;D+=8){var I=Math.min(8,E.length-D),j=parseInt(E.substring(D,D+I),x);8>I?(I=d(Math.pow(x,I)),y=y.j(I).add(d(j))):(y=y.j(v),y=y.add(d(j)))}return y}var f=u(0),p=u(1),b=u(16777216);t=o.prototype,t.m=function(){if(k(this))return-P(this).m();for(var E=0,x=1,v=0;v<this.g.length;v++){var y=this.i(v);E+=(0<=y?y:4294967296+y)*x,x*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(_(this))return"0";if(k(this))return"-"+P(this).toString(E);for(var x=d(Math.pow(E,6)),v=this,y="";;){var D=R(v,x).g;v=N(v,D.j(x));var I=((0<v.g.length?v.g[0]:v.h)>>>0).toString(E);if(v=D,_(v))return I+y;for(;6>I.length;)I="0"+I;y=I+y}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function _(E){if(E.h!=0)return!1;for(var x=0;x<E.g.length;x++)if(E.g[x]!=0)return!1;return!0}function k(E){return E.h==-1}t.l=function(E){return E=N(this,E),k(E)?-1:_(E)?0:1};function P(E){for(var x=E.g.length,v=[],y=0;y<x;y++)v[y]=~E.g[y];return new o(v,~E.h).add(p)}t.abs=function(){return k(this)?P(this):this},t.add=function(E){for(var x=Math.max(this.g.length,E.g.length),v=[],y=0,D=0;D<=x;D++){var I=y+(this.i(D)&65535)+(E.i(D)&65535),j=(I>>>16)+(this.i(D)>>>16)+(E.i(D)>>>16);y=j>>>16,I&=65535,j&=65535,v[D]=j<<16|I}return new o(v,v[v.length-1]&-2147483648?-1:0)};function N(E,x){return E.add(P(x))}t.j=function(E){if(_(this)||_(E))return f;if(k(this))return k(E)?P(this).j(P(E)):P(P(this).j(E));if(k(E))return P(this.j(P(E)));if(0>this.l(b)&&0>E.l(b))return d(this.m()*E.m());for(var x=this.g.length+E.g.length,v=[],y=0;y<2*x;y++)v[y]=0;for(y=0;y<this.g.length;y++)for(var D=0;D<E.g.length;D++){var I=this.i(y)>>>16,j=this.i(y)&65535,te=E.i(D)>>>16,B=E.i(D)&65535;v[2*y+2*D]+=j*B,w(v,2*y+2*D),v[2*y+2*D+1]+=I*B,w(v,2*y+2*D+1),v[2*y+2*D+1]+=j*te,w(v,2*y+2*D+1),v[2*y+2*D+2]+=I*te,w(v,2*y+2*D+2)}for(y=0;y<x;y++)v[y]=v[2*y+1]<<16|v[2*y];for(y=x;y<2*x;y++)v[y]=0;return new o(v,0)};function w(E,x){for(;(E[x]&65535)!=E[x];)E[x+1]+=E[x]>>>16,E[x]&=65535,x++}function S(E,x){this.g=E,this.h=x}function R(E,x){if(_(x))throw Error("division by zero");if(_(E))return new S(f,f);if(k(E))return x=R(P(E),x),new S(P(x.g),P(x.h));if(k(x))return x=R(E,P(x)),new S(P(x.g),x.h);if(30<E.g.length){if(k(E)||k(x))throw Error("slowDivide_ only works with positive integers.");for(var v=p,y=x;0>=y.l(E);)v=M(v),y=M(y);var D=$(v,1),I=$(y,1);for(y=$(y,2),v=$(v,2);!_(y);){var j=I.add(y);0>=j.l(E)&&(D=D.add(v),I=j),y=$(y,1),v=$(v,1)}return x=N(E,D.j(x)),new S(D,x)}for(D=f;0<=E.l(x);){for(v=Math.max(1,Math.floor(E.m()/x.m())),y=Math.ceil(Math.log(v)/Math.LN2),y=48>=y?1:Math.pow(2,y-48),I=d(v),j=I.j(x);k(j)||0<j.l(E);)v-=y,I=d(v),j=I.j(x);_(I)&&(I=p),D=D.add(I),E=N(E,j)}return new S(D,E)}t.A=function(E){return R(this,E).h},t.and=function(E){for(var x=Math.max(this.g.length,E.g.length),v=[],y=0;y<x;y++)v[y]=this.i(y)&E.i(y);return new o(v,this.h&E.h)},t.or=function(E){for(var x=Math.max(this.g.length,E.g.length),v=[],y=0;y<x;y++)v[y]=this.i(y)|E.i(y);return new o(v,this.h|E.h)},t.xor=function(E){for(var x=Math.max(this.g.length,E.g.length),v=[],y=0;y<x;y++)v[y]=this.i(y)^E.i(y);return new o(v,this.h^E.h)};function M(E){for(var x=E.g.length+1,v=[],y=0;y<x;y++)v[y]=E.i(y)<<1|E.i(y-1)>>>31;return new o(v,E.h)}function $(E,x){var v=x>>5;x%=32;for(var y=E.g.length-v,D=[],I=0;I<y;I++)D[I]=0<x?E.i(I+v)>>>x|E.i(I+v+1)<<32-x:E.i(I+v);return new o(D,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,a_=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,us=o}).apply(typeof X0<"u"?X0:typeof self<"u"?self:typeof window<"u"?window:{});var xl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var o_,xa,l_,Bl,Uh,c_,u_,d_;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,m,g){return c==Array.prototype||c==Object.prototype||(c[m]=g.value),c};function r(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof xl=="object"&&xl];for(var m=0;m<c.length;++m){var g=c[m];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var n=r(this);function s(c,m){if(m)e:{var g=n;c=c.split(".");for(var C=0;C<c.length-1;C++){var F=c[C];if(!(F in g))break e;g=g[F]}c=c[c.length-1],C=g[c],m=m(C),m!=C&&m!=null&&e(g,c,{configurable:!0,writable:!0,value:m})}}function i(c,m){c instanceof String&&(c+="");var g=0,C=!1,F={next:function(){if(!C&&g<c.length){var z=g++;return{value:m(z,c[z]),done:!1}}return C=!0,{done:!0,value:void 0}}};return F[Symbol.iterator]=function(){return F},F}s("Array.prototype.values",function(c){return c||function(){return i(this,function(m,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(c){var m=typeof c;return m=m!="object"?m:c?Array.isArray(c)?"array":m:"null",m=="array"||m=="object"&&typeof c.length=="number"}function d(c){var m=typeof c;return m=="object"&&c!=null||m=="function"}function h(c,m,g){return c.call.apply(c.bind,arguments)}function f(c,m,g){if(!c)throw Error();if(2<arguments.length){var C=Array.prototype.slice.call(arguments,2);return function(){var F=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(F,C),c.apply(m,F)}}return function(){return c.apply(m,arguments)}}function p(c,m,g){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,p.apply(null,arguments)}function b(c,m){var g=Array.prototype.slice.call(arguments,1);return function(){var C=g.slice();return C.push.apply(C,arguments),c.apply(this,C)}}function _(c,m){function g(){}g.prototype=m.prototype,c.aa=m.prototype,c.prototype=new g,c.prototype.constructor=c,c.Qb=function(C,F,z){for(var Z=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)Z[Ce-2]=arguments[Ce];return m.prototype[F].apply(C,Z)}}function k(c){const m=c.length;if(0<m){const g=Array(m);for(let C=0;C<m;C++)g[C]=c[C];return g}return[]}function P(c,m){for(let g=1;g<arguments.length;g++){const C=arguments[g];if(u(C)){const F=c.length||0,z=C.length||0;c.length=F+z;for(let Z=0;Z<z;Z++)c[F+Z]=C[Z]}else c.push(C)}}class N{constructor(m,g){this.i=m,this.j=g,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function w(c){return/^[\s\xa0]*$/.test(c)}function S(){var c=l.navigator;return c&&(c=c.userAgent)?c:""}function R(c){return R[" "](c),c}R[" "]=function(){};var M=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function $(c,m,g){for(const C in c)m.call(g,c[C],C,c)}function E(c,m){for(const g in c)m.call(void 0,c[g],g,c)}function x(c){const m={};for(const g in c)m[g]=c[g];return m}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function y(c,m){let g,C;for(let F=1;F<arguments.length;F++){C=arguments[F];for(g in C)c[g]=C[g];for(let z=0;z<v.length;z++)g=v[z],Object.prototype.hasOwnProperty.call(C,g)&&(c[g]=C[g])}}function D(c){var m=1;c=c.split(":");const g=[];for(;0<m&&c.length;)g.push(c.shift()),m--;return c.length&&g.push(c.join(":")),g}function I(c){l.setTimeout(()=>{throw c},0)}function j(){var c=H;let m=null;return c.g&&(m=c.g,c.g=c.g.next,c.g||(c.h=null),m.next=null),m}class te{constructor(){this.h=this.g=null}add(m,g){const C=B.get();C.set(m,g),this.h?this.h.next=C:this.g=C,this.h=C}}var B=new N(()=>new V,c=>c.reset());class V{constructor(){this.next=this.g=this.h=null}set(m,g){this.h=m,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let L,O=!1,H=new te,q=()=>{const c=l.Promise.resolve(void 0);L=()=>{c.then(J)}};var J=()=>{for(var c;c=j();){try{c.h.call(c.g)}catch(g){I(g)}var m=B;m.j(c),100>m.h&&(m.h++,c.next=m.g,m.g=c)}O=!1};function A(){this.s=this.s,this.C=this.C}A.prototype.s=!1,A.prototype.ma=function(){this.s||(this.s=!0,this.N())},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Q(c,m){this.type=c,this.g=this.target=m,this.defaultPrevented=!1}Q.prototype.h=function(){this.defaultPrevented=!0};var ae=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var c=!1,m=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};l.addEventListener("test",g,m),l.removeEventListener("test",g,m)}catch{}return c}();function le(c,m){if(Q.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var g=this.type=c.type,C=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=m,m=c.relatedTarget){if(M){e:{try{R(m.nodeName);var F=!0;break e}catch{}F=!1}F||(m=null)}}else g=="mouseover"?m=c.fromElement:g=="mouseout"&&(m=c.toElement);this.relatedTarget=m,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:ee[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&le.aa.h.call(this)}}_(le,Q);var ee={2:"touch",3:"pen",4:"mouse"};le.prototype.h=function(){le.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var ue="closure_listenable_"+(1e6*Math.random()|0),ye=0;function tt(c,m,g,C,F){this.listener=c,this.proxy=null,this.src=m,this.type=g,this.capture=!!C,this.ha=F,this.key=++ye,this.da=this.fa=!1}function Bt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function xr(c){this.src=c,this.g={},this.h=0}xr.prototype.add=function(c,m,g,C,F){var z=c.toString();c=this.g[z],c||(c=this.g[z]=[],this.h++);var Z=W(c,m,C,F);return-1<Z?(m=c[Z],g||(m.fa=!1)):(m=new tt(m,this.src,z,!!C,F),m.fa=g,c.push(m)),m};function yr(c,m){var g=m.type;if(g in c.g){var C=c.g[g],F=Array.prototype.indexOf.call(C,m,void 0),z;(z=0<=F)&&Array.prototype.splice.call(C,F,1),z&&(Bt(m),c.g[g].length==0&&(delete c.g[g],c.h--))}}function W(c,m,g,C){for(var F=0;F<c.length;++F){var z=c[F];if(!z.da&&z.listener==m&&z.capture==!!g&&z.ha==C)return F}return-1}var U="closure_lm_"+(1e6*Math.random()|0),Y={};function de(c,m,g,C,F){if(Array.isArray(m)){for(var z=0;z<m.length;z++)de(c,m[z],g,C,F);return null}return g=lp(g),c&&c[ue]?c.K(m,g,d(C)?!!C.capture:!1,F):Ne(c,m,g,!1,C,F)}function Ne(c,m,g,C,F,z){if(!m)throw Error("Invalid event type");var Z=d(F)?!!F.capture:!!F,Ce=Iu(c);if(Ce||(c[U]=Ce=new xr(c)),g=Ce.add(m,g,C,Z,z),g.proxy)return g;if(C=Zt(),g.proxy=C,C.src=c,C.listener=g,c.addEventListener)ae||(F=Z),F===void 0&&(F=!1),c.addEventListener(m.toString(),C,F);else if(c.attachEvent)c.attachEvent(Oo(m.toString()),C);else if(c.addListener&&c.removeListener)c.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Zt(){function c(g){return m.call(c.src,c.listener,g)}const m=Tu;return c}function $t(c,m,g,C,F){if(Array.isArray(m))for(var z=0;z<m.length;z++)$t(c,m[z],g,C,F);else C=d(C)?!!C.capture:!!C,g=lp(g),c&&c[ue]?(c=c.i,m=String(m).toString(),m in c.g&&(z=c.g[m],g=W(z,g,C,F),-1<g&&(Bt(z[g]),Array.prototype.splice.call(z,g,1),z.length==0&&(delete c.g[m],c.h--)))):c&&(c=Iu(c))&&(m=c.g[m.toString()],c=-1,m&&(c=W(m,g,C,F)),(g=-1<c?m[c]:null)&&As(g))}function As(c){if(typeof c!="number"&&c&&!c.da){var m=c.src;if(m&&m[ue])yr(m.i,c);else{var g=c.type,C=c.proxy;m.removeEventListener?m.removeEventListener(g,C,c.capture):m.detachEvent?m.detachEvent(Oo(g),C):m.addListener&&m.removeListener&&m.removeListener(C),(g=Iu(m))?(yr(g,c),g.h==0&&(g.src=null,m[U]=null)):Bt(c)}}}function Oo(c){return c in Y?Y[c]:Y[c]="on"+c}function Tu(c,m){if(c.da)c=!0;else{m=new le(m,this);var g=c.listener,C=c.ha||c.src;c.fa&&As(c),c=g.call(C,m)}return c}function Iu(c){return c=c[U],c instanceof xr?c:null}var ku="__closure_events_fn_"+(1e9*Math.random()>>>0);function lp(c){return typeof c=="function"?c:(c[ku]||(c[ku]=function(m){return c.handleEvent(m)}),c[ku])}function dt(){A.call(this),this.i=new xr(this),this.M=this,this.F=null}_(dt,A),dt.prototype[ue]=!0,dt.prototype.removeEventListener=function(c,m,g,C){$t(this,c,m,g,C)};function Nt(c,m){var g,C=c.F;if(C)for(g=[];C;C=C.F)g.push(C);if(c=c.M,C=m.type||m,typeof m=="string")m=new Q(m,c);else if(m instanceof Q)m.target=m.target||c;else{var F=m;m=new Q(C,c),y(m,F)}if(F=!0,g)for(var z=g.length-1;0<=z;z--){var Z=m.g=g[z];F=Vo(Z,C,!0,m)&&F}if(Z=m.g=c,F=Vo(Z,C,!0,m)&&F,F=Vo(Z,C,!1,m)&&F,g)for(z=0;z<g.length;z++)Z=m.g=g[z],F=Vo(Z,C,!1,m)&&F}dt.prototype.N=function(){if(dt.aa.N.call(this),this.i){var c=this.i,m;for(m in c.g){for(var g=c.g[m],C=0;C<g.length;C++)Bt(g[C]);delete c.g[m],c.h--}}this.F=null},dt.prototype.K=function(c,m,g,C){return this.i.add(String(c),m,!1,g,C)},dt.prototype.L=function(c,m,g,C){return this.i.add(String(c),m,!0,g,C)};function Vo(c,m,g,C){if(m=c.i.g[String(m)],!m)return!0;m=m.concat();for(var F=!0,z=0;z<m.length;++z){var Z=m[z];if(Z&&!Z.da&&Z.capture==g){var Ce=Z.listener,rt=Z.ha||Z.src;Z.fa&&yr(c.i,Z),F=Ce.call(rt,C)!==!1&&F}}return F&&!C.defaultPrevented}function cp(c,m,g){if(typeof c=="function")g&&(c=p(c,g));else if(c&&typeof c.handleEvent=="function")c=p(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:l.setTimeout(c,m||0)}function up(c){c.g=cp(()=>{c.g=null,c.i&&(c.i=!1,up(c))},c.l);const m=c.h;c.h=null,c.m.apply(null,m)}class lN extends A{constructor(m,g){super(),this.m=m,this.l=g,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:up(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $i(c){A.call(this),this.h=c,this.g={}}_($i,A);var dp=[];function hp(c){$(c.g,function(m,g){this.g.hasOwnProperty(g)&&As(m)},c),c.g={}}$i.prototype.N=function(){$i.aa.N.call(this),hp(this)},$i.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pu=l.JSON.stringify,cN=l.JSON.parse,uN=class{stringify(c){return l.JSON.stringify(c,void 0)}parse(c){return l.JSON.parse(c,void 0)}};function Au(){}Au.prototype.h=null;function mp(c){return c.h||(c.h=c.i())}function fp(){}var zi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ru(){Q.call(this,"d")}_(Ru,Q);function Du(){Q.call(this,"c")}_(Du,Q);var Qn={},pp=null;function Mo(){return pp=pp||new dt}Qn.La="serverreachability";function gp(c){Q.call(this,Qn.La,c)}_(gp,Q);function qi(c){const m=Mo();Nt(m,new gp(m))}Qn.STAT_EVENT="statevent";function xp(c,m){Q.call(this,Qn.STAT_EVENT,c),this.stat=m}_(xp,Q);function Et(c){const m=Mo();Nt(m,new xp(m,c))}Qn.Ma="timingevent";function yp(c,m){Q.call(this,Qn.Ma,c),this.size=m}_(yp,Q);function Wi(c,m){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){c()},m)}function Hi(){this.g=!0}Hi.prototype.xa=function(){this.g=!1};function dN(c,m,g,C,F,z){c.info(function(){if(c.g)if(z)for(var Z="",Ce=z.split("&"),rt=0;rt<Ce.length;rt++){var _e=Ce[rt].split("=");if(1<_e.length){var ht=_e[0];_e=_e[1];var mt=ht.split("_");Z=2<=mt.length&&mt[1]=="type"?Z+(ht+"="+_e+"&"):Z+(ht+"=redacted&")}}else Z=null;else Z=z;return"XMLHTTP REQ ("+C+") [attempt "+F+"]: "+m+`
`+g+`
`+Z})}function hN(c,m,g,C,F,z,Z){c.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+F+"]: "+m+`
`+g+`
`+z+" "+Z})}function Rs(c,m,g,C){c.info(function(){return"XMLHTTP TEXT ("+m+"): "+fN(c,g)+(C?" "+C:"")})}function mN(c,m){c.info(function(){return"TIMEOUT: "+m})}Hi.prototype.info=function(){};function fN(c,m){if(!c.g)return m;if(!m)return null;try{var g=JSON.parse(m);if(g){for(c=0;c<g.length;c++)if(Array.isArray(g[c])){var C=g[c];if(!(2>C.length)){var F=C[1];if(Array.isArray(F)&&!(1>F.length)){var z=F[0];if(z!="noop"&&z!="stop"&&z!="close")for(var Z=1;Z<F.length;Z++)F[Z]=""}}}}return Pu(g)}catch{return m}}var Fo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Lu;function Uo(){}_(Uo,Au),Uo.prototype.g=function(){return new XMLHttpRequest},Uo.prototype.i=function(){return{}},Lu=new Uo;function an(c,m,g,C){this.j=c,this.i=m,this.l=g,this.R=C||1,this.U=new $i(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new wp}function wp(){this.i=null,this.g="",this.h=!1}var _p={},Ou={};function Vu(c,m,g){c.L=1,c.v=qo(Dr(m)),c.m=g,c.P=!0,bp(c,null)}function bp(c,m){c.F=Date.now(),Bo(c),c.A=Dr(c.v);var g=c.A,C=c.R;Array.isArray(C)||(C=[String(C)]),Op(g.i,"t",C),c.C=0,g=c.j.J,c.h=new wp,c.g=eg(c.j,g?m:null,!c.m),0<c.O&&(c.M=new lN(p(c.Y,c,c.g),c.O)),m=c.U,g=c.g,C=c.ca;var F="readystatechange";Array.isArray(F)||(F&&(dp[0]=F.toString()),F=dp);for(var z=0;z<F.length;z++){var Z=de(g,F[z],C||m.handleEvent,!1,m.h||m);if(!Z)break;m.g[Z.key]=Z}m=c.H?x(c.H):{},c.m?(c.u||(c.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,m)):(c.u="GET",c.g.ea(c.A,c.u,null,m)),qi(),dN(c.i,c.u,c.A,c.l,c.R,c.m)}an.prototype.ca=function(c){c=c.target;const m=this.M;m&&Lr(c)==3?m.j():this.Y(c)},an.prototype.Y=function(c){try{if(c==this.g)e:{const mt=Lr(this.g);var m=this.g.Ba();const Os=this.g.Z();if(!(3>mt)&&(mt!=3||this.g&&(this.h.h||this.g.oa()||zp(this.g)))){this.J||mt!=4||m==7||(m==8||0>=Os?qi(3):qi(2)),Mu(this);var g=this.g.Z();this.X=g;t:if(Np(this)){var C=zp(this.g);c="";var F=C.length,z=Lr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Xn(this),Gi(this);var Z="";break t}this.h.i=new l.TextDecoder}for(m=0;m<F;m++)this.h.h=!0,c+=this.h.i.decode(C[m],{stream:!(z&&m==F-1)});C.length=0,this.h.g+=c,this.C=0,Z=this.h.g}else Z=this.g.oa();if(this.o=g==200,hN(this.i,this.u,this.A,this.l,this.R,mt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Ce,rt=this.g;if((Ce=rt.g?rt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Ce)){var _e=Ce;break t}}_e=null}if(g=_e)Rs(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fu(this,g);else{this.o=!1,this.s=3,Et(12),Xn(this),Gi(this);break e}}if(this.P){g=!0;let ar;for(;!this.J&&this.C<Z.length;)if(ar=pN(this,Z),ar==Ou){mt==4&&(this.s=4,Et(14),g=!1),Rs(this.i,this.l,null,"[Incomplete Response]");break}else if(ar==_p){this.s=4,Et(15),Rs(this.i,this.l,Z,"[Invalid Chunk]"),g=!1;break}else Rs(this.i,this.l,ar,null),Fu(this,ar);if(Np(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||Z.length!=0||this.h.h||(this.s=1,Et(16),g=!1),this.o=this.o&&g,!g)Rs(this.i,this.l,Z,"[Invalid Chunked Response]"),Xn(this),Gi(this);else if(0<Z.length&&!this.W){this.W=!0;var ht=this.j;ht.g==this&&ht.ba&&!ht.M&&(ht.j.info("Great, no buffering proxy detected. Bytes received: "+Z.length),Wu(ht),ht.M=!0,Et(11))}}else Rs(this.i,this.l,Z,null),Fu(this,Z);mt==4&&Xn(this),this.o&&!this.J&&(mt==4?Xp(this.j,this):(this.o=!1,Bo(this)))}else AN(this.g),g==400&&0<Z.indexOf("Unknown SID")?(this.s=3,Et(12)):(this.s=0,Et(13)),Xn(this),Gi(this)}}}catch{}finally{}};function Np(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function pN(c,m){var g=c.C,C=m.indexOf(`
`,g);return C==-1?Ou:(g=Number(m.substring(g,C)),isNaN(g)?_p:(C+=1,C+g>m.length?Ou:(m=m.slice(C,C+g),c.C=C+g,m)))}an.prototype.cancel=function(){this.J=!0,Xn(this)};function Bo(c){c.S=Date.now()+c.I,Ep(c,c.I)}function Ep(c,m){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Wi(p(c.ba,c),m)}function Mu(c){c.B&&(l.clearTimeout(c.B),c.B=null)}an.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(mN(this.i,this.A),this.L!=2&&(qi(),Et(17)),Xn(this),this.s=2,Gi(this)):Ep(this,this.S-c)};function Gi(c){c.j.G==0||c.J||Xp(c.j,c)}function Xn(c){Mu(c);var m=c.M;m&&typeof m.ma=="function"&&m.ma(),c.M=null,hp(c.U),c.g&&(m=c.g,c.g=null,m.abort(),m.ma())}function Fu(c,m){try{var g=c.j;if(g.G!=0&&(g.g==c||Uu(g.h,c))){if(!c.K&&Uu(g.h,c)&&g.G==3){try{var C=g.Da.g.parse(m)}catch{C=null}if(Array.isArray(C)&&C.length==3){var F=C;if(F[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<c.F)Xo(g),Ko(g);else break e;qu(g),Et(18)}}else g.za=F[1],0<g.za-g.T&&37500>F[2]&&g.F&&g.v==0&&!g.C&&(g.C=Wi(p(g.Za,g),6e3));if(1>=Sp(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Jn(g,11)}else if((c.K||g.g==c)&&Xo(g),!w(m))for(F=g.Da.g.parse(m),m=0;m<F.length;m++){let _e=F[m];if(g.T=_e[0],_e=_e[1],g.G==2)if(_e[0]=="c"){g.K=_e[1],g.ia=_e[2];const ht=_e[3];ht!=null&&(g.la=ht,g.j.info("VER="+g.la));const mt=_e[4];mt!=null&&(g.Aa=mt,g.j.info("SVER="+g.Aa));const Os=_e[5];Os!=null&&typeof Os=="number"&&0<Os&&(C=1.5*Os,g.L=C,g.j.info("backChannelRequestTimeoutMs_="+C)),C=g;const ar=c.g;if(ar){const Jo=ar.g?ar.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Jo){var z=C.h;z.g||Jo.indexOf("spdy")==-1&&Jo.indexOf("quic")==-1&&Jo.indexOf("h2")==-1||(z.j=z.l,z.g=new Set,z.h&&(Bu(z,z.h),z.h=null))}if(C.D){const Hu=ar.g?ar.g.getResponseHeader("X-HTTP-Session-Id"):null;Hu&&(C.ya=Hu,Te(C.I,C.D,Hu))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-c.F,g.j.info("Handshake RTT: "+g.R+"ms")),C=g;var Z=c;if(C.qa=Zp(C,C.J?C.ia:null,C.W),Z.K){Tp(C.h,Z);var Ce=Z,rt=C.L;rt&&(Ce.I=rt),Ce.B&&(Mu(Ce),Bo(Ce)),C.g=Z}else Kp(C);0<g.i.length&&Qo(g)}else _e[0]!="stop"&&_e[0]!="close"||Jn(g,7);else g.G==3&&(_e[0]=="stop"||_e[0]=="close"?_e[0]=="stop"?Jn(g,7):zu(g):_e[0]!="noop"&&g.l&&g.l.ta(_e),g.v=0)}}qi(4)}catch{}}var gN=class{constructor(c,m){this.g=c,this.map=m}};function jp(c){this.l=c||10,l.PerformanceNavigationTiming?(c=l.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Cp(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Sp(c){return c.h?1:c.g?c.g.size:0}function Uu(c,m){return c.h?c.h==m:c.g?c.g.has(m):!1}function Bu(c,m){c.g?c.g.add(m):c.h=m}function Tp(c,m){c.h&&c.h==m?c.h=null:c.g&&c.g.has(m)&&c.g.delete(m)}jp.prototype.cancel=function(){if(this.i=Ip(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Ip(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let m=c.i;for(const g of c.g.values())m=m.concat(g.D);return m}return k(c.i)}function xN(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var m=[],g=c.length,C=0;C<g;C++)m.push(c[C]);return m}m=[],g=0;for(C in c)m[g++]=c[C];return m}function yN(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var m=[];c=c.length;for(var g=0;g<c;g++)m.push(g);return m}m=[],g=0;for(const C in c)m[g++]=C;return m}}}function kp(c,m){if(c.forEach&&typeof c.forEach=="function")c.forEach(m,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,m,void 0);else for(var g=yN(c),C=xN(c),F=C.length,z=0;z<F;z++)m.call(void 0,C[z],g&&g[z],c)}var Pp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vN(c,m){if(c){c=c.split("&");for(var g=0;g<c.length;g++){var C=c[g].indexOf("="),F=null;if(0<=C){var z=c[g].substring(0,C);F=c[g].substring(C+1)}else z=c[g];m(z,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function Yn(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Yn){this.h=c.h,$o(this,c.j),this.o=c.o,this.g=c.g,zo(this,c.s),this.l=c.l;var m=c.i,g=new Xi;g.i=m.i,m.g&&(g.g=new Map(m.g),g.h=m.h),Ap(this,g),this.m=c.m}else c&&(m=String(c).match(Pp))?(this.h=!1,$o(this,m[1]||"",!0),this.o=Ki(m[2]||""),this.g=Ki(m[3]||"",!0),zo(this,m[4]),this.l=Ki(m[5]||"",!0),Ap(this,m[6]||"",!0),this.m=Ki(m[7]||"")):(this.h=!1,this.i=new Xi(null,this.h))}Yn.prototype.toString=function(){var c=[],m=this.j;m&&c.push(Qi(m,Rp,!0),":");var g=this.g;return(g||m=="file")&&(c.push("//"),(m=this.o)&&c.push(Qi(m,Rp,!0),"@"),c.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&c.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(Qi(g,g.charAt(0)=="/"?bN:_N,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",Qi(g,EN)),c.join("")};function Dr(c){return new Yn(c)}function $o(c,m,g){c.j=g?Ki(m,!0):m,c.j&&(c.j=c.j.replace(/:$/,""))}function zo(c,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);c.s=m}else c.s=null}function Ap(c,m,g){m instanceof Xi?(c.i=m,jN(c.i,c.h)):(g||(m=Qi(m,NN)),c.i=new Xi(m,c.h))}function Te(c,m,g){c.i.set(m,g)}function qo(c){return Te(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ki(c,m){return c?m?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Qi(c,m,g){return typeof c=="string"?(c=encodeURI(c).replace(m,wN),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function wN(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Rp=/[#\/\?@]/g,_N=/[#\?:]/g,bN=/[#\?]/g,NN=/[#\?@]/g,EN=/#/g;function Xi(c,m){this.h=this.g=null,this.i=c||null,this.j=!!m}function on(c){c.g||(c.g=new Map,c.h=0,c.i&&vN(c.i,function(m,g){c.add(decodeURIComponent(m.replace(/\+/g," ")),g)}))}t=Xi.prototype,t.add=function(c,m){on(this),this.i=null,c=Ds(this,c);var g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(m),this.h+=1,this};function Dp(c,m){on(c),m=Ds(c,m),c.g.has(m)&&(c.i=null,c.h-=c.g.get(m).length,c.g.delete(m))}function Lp(c,m){return on(c),m=Ds(c,m),c.g.has(m)}t.forEach=function(c,m){on(this),this.g.forEach(function(g,C){g.forEach(function(F){c.call(m,F,C,this)},this)},this)},t.na=function(){on(this);const c=Array.from(this.g.values()),m=Array.from(this.g.keys()),g=[];for(let C=0;C<m.length;C++){const F=c[C];for(let z=0;z<F.length;z++)g.push(m[C])}return g},t.V=function(c){on(this);let m=[];if(typeof c=="string")Lp(this,c)&&(m=m.concat(this.g.get(Ds(this,c))));else{c=Array.from(this.g.values());for(let g=0;g<c.length;g++)m=m.concat(c[g])}return m},t.set=function(c,m){return on(this),this.i=null,c=Ds(this,c),Lp(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[m]),this.h+=1,this},t.get=function(c,m){return c?(c=this.V(c),0<c.length?String(c[0]):m):m};function Op(c,m,g){Dp(c,m),0<g.length&&(c.i=null,c.g.set(Ds(c,m),k(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],m=Array.from(this.g.keys());for(var g=0;g<m.length;g++){var C=m[g];const z=encodeURIComponent(String(C)),Z=this.V(C);for(C=0;C<Z.length;C++){var F=z;Z[C]!==""&&(F+="="+encodeURIComponent(String(Z[C]))),c.push(F)}}return this.i=c.join("&")};function Ds(c,m){return m=String(m),c.j&&(m=m.toLowerCase()),m}function jN(c,m){m&&!c.j&&(on(c),c.i=null,c.g.forEach(function(g,C){var F=C.toLowerCase();C!=F&&(Dp(this,C),Op(this,F,g))},c)),c.j=m}function CN(c,m){const g=new Hi;if(l.Image){const C=new Image;C.onload=b(ln,g,"TestLoadImage: loaded",!0,m,C),C.onerror=b(ln,g,"TestLoadImage: error",!1,m,C),C.onabort=b(ln,g,"TestLoadImage: abort",!1,m,C),C.ontimeout=b(ln,g,"TestLoadImage: timeout",!1,m,C),l.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=c}else m(!1)}function SN(c,m){const g=new Hi,C=new AbortController,F=setTimeout(()=>{C.abort(),ln(g,"TestPingServer: timeout",!1,m)},1e4);fetch(c,{signal:C.signal}).then(z=>{clearTimeout(F),z.ok?ln(g,"TestPingServer: ok",!0,m):ln(g,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(F),ln(g,"TestPingServer: error",!1,m)})}function ln(c,m,g,C,F){try{F&&(F.onload=null,F.onerror=null,F.onabort=null,F.ontimeout=null),C(g)}catch{}}function TN(){this.g=new uN}function IN(c,m,g){const C=g||"";try{kp(c,function(F,z){let Z=F;d(F)&&(Z=Pu(F)),m.push(C+z+"="+encodeURIComponent(Z))})}catch(F){throw m.push(C+"type="+encodeURIComponent("_badmap")),F}}function Wo(c){this.l=c.Ub||null,this.j=c.eb||!1}_(Wo,Au),Wo.prototype.g=function(){return new Ho(this.l,this.j)},Wo.prototype.i=function(c){return function(){return c}}({});function Ho(c,m){dt.call(this),this.D=c,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Ho,dt),t=Ho.prototype,t.open=function(c,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=m,this.readyState=1,Ji(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(m.body=c),(this.D||l).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Yi(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Ji(this)),this.g&&(this.readyState=3,Ji(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vp(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vp(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var m=c.value?c.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!c.done}))&&(this.response=this.responseText+=m)}c.done?Yi(this):Ji(this),this.readyState==3&&Vp(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,Yi(this))},t.Qa=function(c){this.g&&(this.response=c,Yi(this))},t.ga=function(){this.g&&Yi(this)};function Yi(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Ji(c)}t.setRequestHeader=function(c,m){this.u.append(c,m)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],m=this.h.entries();for(var g=m.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=m.next();return c.join(`\r
`)};function Ji(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Ho.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Mp(c){let m="";return $(c,function(g,C){m+=C,m+=":",m+=g,m+=`\r
`}),m}function $u(c,m,g){e:{for(C in g){var C=!1;break e}C=!0}C||(g=Mp(g),typeof c=="string"?g!=null&&encodeURIComponent(String(g)):Te(c,m,g))}function Ue(c){dt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(Ue,dt);var kN=/^https?$/i,PN=["POST","PUT"];t=Ue.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,m,g,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);m=m?m.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Lu.g(),this.v=this.o?mp(this.o):mp(Lu),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(m,String(c),!0),this.B=!1}catch(z){Fp(this,z);return}if(c=g||"",g=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var F in C)g.set(F,C[F]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const z of C.keys())g.set(z,C.get(z));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(g.keys()).find(z=>z.toLowerCase()=="content-type"),F=l.FormData&&c instanceof l.FormData,!(0<=Array.prototype.indexOf.call(PN,m,void 0))||C||F||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[z,Z]of g)this.g.setRequestHeader(z,Z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$p(this),this.u=!0,this.g.send(c),this.u=!1}catch(z){Fp(this,z)}};function Fp(c,m){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=m,c.m=5,Up(c),Go(c)}function Up(c){c.A||(c.A=!0,Nt(c,"complete"),Nt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Nt(this,"complete"),Nt(this,"abort"),Go(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Go(this,!0)),Ue.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Bp(this):this.bb())},t.bb=function(){Bp(this)};function Bp(c){if(c.h&&typeof o<"u"&&(!c.v[1]||Lr(c)!=4||c.Z()!=2)){if(c.u&&Lr(c)==4)cp(c.Ea,0,c);else if(Nt(c,"readystatechange"),Lr(c)==4){c.h=!1;try{const Z=c.Z();e:switch(Z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var g;if(!(g=m)){var C;if(C=Z===0){var F=String(c.D).match(Pp)[1]||null;!F&&l.self&&l.self.location&&(F=l.self.location.protocol.slice(0,-1)),C=!kN.test(F?F.toLowerCase():"")}g=C}if(g)Nt(c,"complete"),Nt(c,"success");else{c.m=6;try{var z=2<Lr(c)?c.g.statusText:""}catch{z=""}c.l=z+" ["+c.Z()+"]",Up(c)}}finally{Go(c)}}}}function Go(c,m){if(c.g){$p(c);const g=c.g,C=c.v[0]?()=>{}:null;c.g=null,c.v=null,m||Nt(c,"ready");try{g.onreadystatechange=C}catch{}}}function $p(c){c.I&&(l.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function Lr(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<Lr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var m=this.g.responseText;return c&&m.indexOf(c)==0&&(m=m.substring(c.length)),cN(m)}};function zp(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function AN(c){const m={};c=(c.g&&2<=Lr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<c.length;C++){if(w(c[C]))continue;var g=D(c[C]);const F=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const z=m[F]||[];m[F]=z,z.push(g)}E(m,function(C){return C.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zi(c,m,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||m}function qp(c){this.Aa=0,this.i=[],this.j=new Hi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Zi("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Zi("baseRetryDelayMs",5e3,c),this.cb=Zi("retryDelaySeedMs",1e4,c),this.Wa=Zi("forwardChannelMaxRetries",2,c),this.wa=Zi("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new jp(c&&c.concurrentRequestLimit),this.Da=new TN,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=qp.prototype,t.la=8,t.G=1,t.connect=function(c,m,g,C){Et(0),this.W=c,this.H=m||{},g&&C!==void 0&&(this.H.OSID=g,this.H.OAID=C),this.F=this.X,this.I=Zp(this,null,this.W),Qo(this)};function zu(c){if(Wp(c),c.G==3){var m=c.U++,g=Dr(c.I);if(Te(g,"SID",c.K),Te(g,"RID",m),Te(g,"TYPE","terminate"),ea(c,g),m=new an(c,c.j,m),m.L=2,m.v=qo(Dr(g)),g=!1,l.navigator&&l.navigator.sendBeacon)try{g=l.navigator.sendBeacon(m.v.toString(),"")}catch{}!g&&l.Image&&(new Image().src=m.v,g=!0),g||(m.g=eg(m.j,null),m.g.ea(m.v)),m.F=Date.now(),Bo(m)}Jp(c)}function Ko(c){c.g&&(Wu(c),c.g.cancel(),c.g=null)}function Wp(c){Ko(c),c.u&&(l.clearTimeout(c.u),c.u=null),Xo(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&l.clearTimeout(c.s),c.s=null)}function Qo(c){if(!Cp(c.h)&&!c.s){c.s=!0;var m=c.Ga;L||q(),O||(L(),O=!0),H.add(m,c),c.B=0}}function RN(c,m){return Sp(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=m.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Wi(p(c.Ga,c,m),Yp(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const F=new an(this,this.j,c);let z=this.o;if(this.S&&(z?(z=x(z),y(z,this.S)):z=this.S),this.m!==null||this.O||(F.H=z,z=null),this.P)e:{for(var m=0,g=0;g<this.i.length;g++){t:{var C=this.i[g];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(m+=C,4096<m){m=g;break e}if(m===4096||g===this.i.length-1){m=g+1;break e}}m=1e3}else m=1e3;m=Gp(this,F,m),g=Dr(this.I),Te(g,"RID",c),Te(g,"CVER",22),this.D&&Te(g,"X-HTTP-Session-Id",this.D),ea(this,g),z&&(this.O?m="headers="+encodeURIComponent(String(Mp(z)))+"&"+m:this.m&&$u(g,this.m,z)),Bu(this.h,F),this.Ua&&Te(g,"TYPE","init"),this.P?(Te(g,"$req",m),Te(g,"SID","null"),F.T=!0,Vu(F,g,null)):Vu(F,g,m),this.G=2}}else this.G==3&&(c?Hp(this,c):this.i.length==0||Cp(this.h)||Hp(this))};function Hp(c,m){var g;m?g=m.l:g=c.U++;const C=Dr(c.I);Te(C,"SID",c.K),Te(C,"RID",g),Te(C,"AID",c.T),ea(c,C),c.m&&c.o&&$u(C,c.m,c.o),g=new an(c,c.j,g,c.B+1),c.m===null&&(g.H=c.o),m&&(c.i=m.D.concat(c.i)),m=Gp(c,g,1e3),g.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Bu(c.h,g),Vu(g,C,m)}function ea(c,m){c.H&&$(c.H,function(g,C){Te(m,C,g)}),c.l&&kp({},function(g,C){Te(m,C,g)})}function Gp(c,m,g){g=Math.min(c.i.length,g);var C=c.l?p(c.l.Na,c.l,c):null;e:{var F=c.i;let z=-1;for(;;){const Z=["count="+g];z==-1?0<g?(z=F[0].g,Z.push("ofs="+z)):z=0:Z.push("ofs="+z);let Ce=!0;for(let rt=0;rt<g;rt++){let _e=F[rt].g;const ht=F[rt].map;if(_e-=z,0>_e)z=Math.max(0,F[rt].g-100),Ce=!1;else try{IN(ht,Z,"req"+_e+"_")}catch{C&&C(ht)}}if(Ce){C=Z.join("&");break e}}}return c=c.i.splice(0,g),m.D=c,C}function Kp(c){if(!c.g&&!c.u){c.Y=1;var m=c.Fa;L||q(),O||(L(),O=!0),H.add(m,c),c.v=0}}function qu(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Wi(p(c.Fa,c),Yp(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,Qp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Wi(p(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Et(10),Ko(this),Qp(this))};function Wu(c){c.A!=null&&(l.clearTimeout(c.A),c.A=null)}function Qp(c){c.g=new an(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var m=Dr(c.qa);Te(m,"RID","rpc"),Te(m,"SID",c.K),Te(m,"AID",c.T),Te(m,"CI",c.F?"0":"1"),!c.F&&c.ja&&Te(m,"TO",c.ja),Te(m,"TYPE","xmlhttp"),ea(c,m),c.m&&c.o&&$u(m,c.m,c.o),c.L&&(c.g.I=c.L);var g=c.g;c=c.ia,g.L=1,g.v=qo(Dr(m)),g.m=null,g.P=!0,bp(g,c)}t.Za=function(){this.C!=null&&(this.C=null,Ko(this),qu(this),Et(19))};function Xo(c){c.C!=null&&(l.clearTimeout(c.C),c.C=null)}function Xp(c,m){var g=null;if(c.g==m){Xo(c),Wu(c),c.g=null;var C=2}else if(Uu(c.h,m))g=m.D,Tp(c.h,m),C=1;else return;if(c.G!=0){if(m.o)if(C==1){g=m.m?m.m.length:0,m=Date.now()-m.F;var F=c.B;C=Mo(),Nt(C,new yp(C,g)),Qo(c)}else Kp(c);else if(F=m.s,F==3||F==0&&0<m.X||!(C==1&&RN(c,m)||C==2&&qu(c)))switch(g&&0<g.length&&(m=c.h,m.i=m.i.concat(g)),F){case 1:Jn(c,5);break;case 4:Jn(c,10);break;case 3:Jn(c,6);break;default:Jn(c,2)}}}function Yp(c,m){let g=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(g*=2),g*m}function Jn(c,m){if(c.j.info("Error code "+m),m==2){var g=p(c.fb,c),C=c.Xa;const F=!C;C=new Yn(C||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||$o(C,"https"),qo(C),F?CN(C.toString(),g):SN(C.toString(),g)}else Et(2);c.G=0,c.l&&c.l.sa(m),Jp(c),Wp(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Et(2)):(this.j.info("Failed to ping google.com"),Et(1))};function Jp(c){if(c.G=0,c.ka=[],c.l){const m=Ip(c.h);(m.length!=0||c.i.length!=0)&&(P(c.ka,m),P(c.ka,c.i),c.h.i.length=0,k(c.i),c.i.length=0),c.l.ra()}}function Zp(c,m,g){var C=g instanceof Yn?Dr(g):new Yn(g);if(C.g!="")m&&(C.g=m+"."+C.g),zo(C,C.s);else{var F=l.location;C=F.protocol,m=m?m+"."+F.hostname:F.hostname,F=+F.port;var z=new Yn(null);C&&$o(z,C),m&&(z.g=m),F&&zo(z,F),g&&(z.l=g),C=z}return g=c.D,m=c.ya,g&&m&&Te(C,g,m),Te(C,"VER",c.la),ea(c,C),C}function eg(c,m,g){if(m&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=c.Ca&&!c.pa?new Ue(new Wo({eb:g})):new Ue(c.pa),m.Ha(c.J),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function tg(){}t=tg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Yo(){}Yo.prototype.g=function(c,m){return new zt(c,m)};function zt(c,m){dt.call(this),this.g=new qp(m),this.l=c,this.h=m&&m.messageUrlParams||null,c=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(c?c["X-WebChannel-Content-Type"]=m.messageContentType:c={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(c?c["X-WebChannel-Client-Profile"]=m.va:c={"X-WebChannel-Client-Profile":m.va}),this.g.S=c,(c=m&&m.Sb)&&!w(c)&&(this.g.m=c),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!w(m)&&(this.g.D=m,c=this.h,c!==null&&m in c&&(c=this.h,m in c&&delete c[m])),this.j=new Ls(this)}_(zt,dt),zt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},zt.prototype.close=function(){zu(this.g)},zt.prototype.o=function(c){var m=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.u&&(g={},g.__data__=Pu(c),c=g);m.i.push(new gN(m.Ya++,c)),m.G==3&&Qo(m)},zt.prototype.N=function(){this.g.l=null,delete this.j,zu(this.g),delete this.g,zt.aa.N.call(this)};function rg(c){Ru.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var m=c.__sm__;if(m){e:{for(const g in m){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,m=m!==null&&c in m?m[c]:void 0),this.data=m}else this.data=c}_(rg,Ru);function ng(){Du.call(this),this.status=1}_(ng,Du);function Ls(c){this.g=c}_(Ls,tg),Ls.prototype.ua=function(){Nt(this.g,"a")},Ls.prototype.ta=function(c){Nt(this.g,new rg(c))},Ls.prototype.sa=function(c){Nt(this.g,new ng)},Ls.prototype.ra=function(){Nt(this.g,"b")},Yo.prototype.createWebChannel=Yo.prototype.g,zt.prototype.send=zt.prototype.o,zt.prototype.open=zt.prototype.m,zt.prototype.close=zt.prototype.close,d_=function(){return new Yo},u_=function(){return Mo()},c_=Qn,Uh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fo.NO_ERROR=0,Fo.TIMEOUT=8,Fo.HTTP_ERROR=6,Bl=Fo,vp.COMPLETE="complete",l_=vp,fp.EventType=zi,zi.OPEN="a",zi.CLOSE="b",zi.ERROR="c",zi.MESSAGE="d",dt.prototype.listen=dt.prototype.K,xa=fp,Ue.prototype.listenOnce=Ue.prototype.L,Ue.prototype.getLastError=Ue.prototype.Ka,Ue.prototype.getLastErrorCode=Ue.prototype.Ba,Ue.prototype.getStatus=Ue.prototype.Z,Ue.prototype.getResponseJson=Ue.prototype.Oa,Ue.prototype.getResponseText=Ue.prototype.oa,Ue.prototype.send=Ue.prototype.ea,Ue.prototype.setWithCredentials=Ue.prototype.Ha,o_=Ue}).apply(typeof xl<"u"?xl:typeof self<"u"?self:typeof window<"u"?window:{});const Y0="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xt.UNAUTHENTICATED=new xt(null),xt.GOOGLE_CREDENTIALS=new xt("google-credentials-uid"),xt.FIRST_PARTY=new xt("first-party-uid"),xt.MOCK_USER=new xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs=new Zm("@firebase/firestore");function ca(){return vs.logLevel}function se(t,...e){if(vs.logLevel<=ge.DEBUG){const r=e.map(hf);vs.debug(`Firestore (${Vi}): ${t}`,...r)}}function Jr(t,...e){if(vs.logLevel<=ge.ERROR){const r=e.map(hf);vs.error(`Firestore (${Vi}): ${t}`,...r)}}function wi(t,...e){if(vs.logLevel<=ge.WARN){const r=e.map(hf);vs.warn(`Firestore (${Vi}): ${t}`,...r)}}function hf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ce(t="Unexpected state"){const e=`FIRESTORE (${Vi}) INTERNAL ASSERTION FAILED: `+t;throw Jr(e),new Error(e)}function je(t,e){t||ce()}function me(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Rr{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ak{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(xt.UNAUTHENTICATED))}shutdown(){}}class ok{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class lk{constructor(e){this.t=e,this.currentUser=xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){je(this.o===void 0);let n=this.i;const s=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let i=new Wr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Wr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Wr)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(je(typeof n.accessToken=="string"),new h_(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return je(e===null||typeof e=="string"),new xt(e)}}class ck{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=xt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class uk{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new ck(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dk{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hk{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){je(this.o===void 0);const n=i=>{i.error!=null&&se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,se("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(je(typeof r.token=="string"),this.R=r.token,new dk(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mk(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=mk(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function be(t,e){return t<e?-1:t>e?1:0}function _i(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new re(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new re(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new re(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return De.fromMillis(Date.now())}static fromDate(e){return De.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new De(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?be(this.nanoseconds,e.nanoseconds):be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.timestamp=e}static fromTimestamp(e){return new he(e)}static min(){return new he(new De(0,0))}static max(){return new he(new De(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e,r,n){r===void 0?r=0:r>e.length&&ce(),n===void 0?n=e.length-r:n>e.length-r&&ce(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return io.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof io?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),o=r.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class ke extends io{construct(e,r,n){return new ke(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new re(G.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new ke(r)}static emptyPath(){return new ke([])}}const fk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class it extends io{construct(e,r,n){return new it(e,r,n)}static isValidIdentifier(e){return fk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),it.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new it(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new re(G.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new re(G.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new re(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(n+=l,s++):(i(),s++)}if(i(),o)throw new re(G.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new it(r)}static emptyPath(){return new it([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie(ke.fromString(e))}static fromName(e){return new ie(ke.fromString(e).popFirst(5))}static empty(){return new ie(ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ke.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new ke(e.slice()))}}function pk(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=he.fromTimestamp(n===1e9?new De(r+1,0):new De(r,n));return new Un(s,ie.empty(),e)}function gk(t){return new Un(t.readTime,t.key,-1)}class Un{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Un(he.min(),ie.empty(),-1)}static max(){return new Un(he.max(),ie.empty(),-1)}}function xk(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ie.comparator(t.documentKey,e.documentKey),r!==0?r:be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(t){if(t.code!==G.FAILED_PRECONDITION||t.message!==yk)throw t;se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ce(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new K((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof K?r:K.resolve(r)}catch(r){return K.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):K.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):K.reject(r)}static resolve(e){return new K((r,n)=>{r(e)})}static reject(e){return new K((r,n)=>{n(e)})}static waitFor(e){return new K((r,n)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&r()},u=>n(u))}),o=!0,i===s&&r()})}static or(e){let r=K.resolve(!1);for(const n of e)r=r.next(s=>s?K.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new K((n,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;r(e[d]).next(h=>{o[d]=h,++l,l===i&&n(o)},h=>s(h))}})}static doWhile(e,r){return new K((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function wk(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Eo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}mf.oe=-1;function lu(t){return t==null}function Sc(t){return t===0&&1/t==-1/0}function _k(t){return typeof t=="number"&&Number.isInteger(t)&&!Sc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Is(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function f_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e,r){this.comparator=e,this.root=r||st.EMPTY}insert(e,r){return new Fe(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,st.BLACK,null,null))}remove(e){return new Fe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,st.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yl(this.root,e,this.comparator,!1)}getReverseIterator(){return new yl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yl(this.root,e,this.comparator,!0)}}class yl{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class st{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??st.RED,this.left=s??st.EMPTY,this.right=i??st.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new st(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return st.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return st.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,st.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,st.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ce();const e=this.left.check();if(e!==this.right.check())throw ce();return e+(this.isRed()?0:1)}}st.EMPTY=null,st.RED=!0,st.BLACK=!1;st.EMPTY=new class{constructor(){this.size=0}get key(){throw ce()}get value(){throw ce()}get color(){throw ce()}get left(){throw ce()}get right(){throw ce()}copy(e,r,n,s,i){return this}insert(e,r,n){return new st(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e){this.comparator=e,this.data=new Fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Z0(this.data.getIterator())}getIteratorFrom(e){return new Z0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ot)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ot(this.comparator);return r.data=e,r}}class Z0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.fields=e,e.sort(it.comparator)}static empty(){return new Ht([])}unionWith(e){let r=new ot(it.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ht(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return _i(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new p_("Invalid base64 string: "+i):i}}(e);return new ct(r)}static fromUint8Array(e){const r=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new ct(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ct.EMPTY_BYTE_STRING=new ct("");const bk=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bn(t){if(je(!!t),typeof t=="string"){let e=0;const r=bk.exec(t);if(je(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:qe(t.seconds),nanos:qe(t.nanos)}}function qe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ws(t){return typeof t=="string"?ct.fromBase64String(t):ct.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function pf(t){const e=t.mapValue.fields.__previous_value__;return ff(e)?pf(e):e}function ao(t){const e=Bn(t.mapValue.fields.__local_write_time__.timestampValue);return new De(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e,r,n,s,i,o,l,u,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d}}class oo{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new oo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof oo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl={mapValue:{}};function _s(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ff(t)?4:jk(t)?9007199254740991:Ek(t)?10:11:ce()}function Pr(t,e){if(t===e)return!0;const r=_s(t);if(r!==_s(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ao(t).isEqual(ao(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Bn(s.timestampValue),l=Bn(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ws(s.bytesValue).isEqual(ws(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return qe(s.geoPointValue.latitude)===qe(i.geoPointValue.latitude)&&qe(s.geoPointValue.longitude)===qe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return qe(s.integerValue)===qe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=qe(s.doubleValue),l=qe(i.doubleValue);return o===l?Sc(o)===Sc(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return _i(t.arrayValue.values||[],e.arrayValue.values||[],Pr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(J0(o)!==J0(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Pr(o[u],l[u])))return!1;return!0}(t,e);default:return ce()}}function lo(t,e){return(t.values||[]).find(r=>Pr(r,e))!==void 0}function bi(t,e){if(t===e)return 0;const r=_s(t),n=_s(e);if(r!==n)return be(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return be(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=qe(i.integerValue||i.doubleValue),u=qe(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return ex(t.timestampValue,e.timestampValue);case 4:return ex(ao(t),ao(e));case 5:return be(t.stringValue,e.stringValue);case 6:return function(i,o){const l=ws(i),u=ws(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const h=be(l[d],u[d]);if(h!==0)return h}return be(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=be(qe(i.latitude),qe(o.latitude));return l!==0?l:be(qe(i.longitude),qe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return tx(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,d,h;const f=i.fields||{},p=o.fields||{},b=(l=f.value)===null||l===void 0?void 0:l.arrayValue,_=(u=p.value)===null||u===void 0?void 0:u.arrayValue,k=be(((d=b==null?void 0:b.values)===null||d===void 0?void 0:d.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return k!==0?k:tx(b,_)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===vl.mapValue&&o===vl.mapValue)return 0;if(i===vl.mapValue)return 1;if(o===vl.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let f=0;f<u.length&&f<h.length;++f){const p=be(u[f],h[f]);if(p!==0)return p;const b=bi(l[u[f]],d[h[f]]);if(b!==0)return b}return be(u.length,h.length)}(t.mapValue,e.mapValue);default:throw ce()}}function ex(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return be(t,e);const r=Bn(t),n=Bn(e),s=be(r.seconds,n.seconds);return s!==0?s:be(r.nanos,n.nanos)}function tx(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=bi(r[s],n[s]);if(i)return i}return be(r.length,n.length)}function Ni(t){return Bh(t)}function Bh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Bn(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ws(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ie.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=Bh(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${Bh(r.fields[o])}`;return s+"}"}(t.mapValue):ce()}function rx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function $h(t){return!!t&&"integerValue"in t}function gf(t){return!!t&&"arrayValue"in t}function nx(t){return!!t&&"nullValue"in t}function sx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $l(t){return!!t&&"mapValue"in t}function Ek(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Aa(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Is(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Aa(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Aa(t.arrayValue.values[r]);return e}return Object.assign({},t)}function jk(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.value=e}static empty(){return new Lt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!$l(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Aa(r)}setAll(e){let r=it.emptyPath(),n={},s=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const u=this.getFieldsMap(r);this.applyChanges(u,n,s),n={},s=[],r=l.popLast()}o?n[l.lastSegment()]=Aa(o):s.push(l.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());$l(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Pr(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];$l(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){Is(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new Lt(Aa(this.value))}}function g_(t){const e=[];return Is(t.fields,(r,n)=>{const s=new it([r]);if($l(n)){const i=g_(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Ht(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,r,n,s,i,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new vt(e,0,he.min(),he.min(),he.min(),Lt.empty(),0)}static newFoundDocument(e,r,n,s){return new vt(e,1,r,he.min(),n,s,0)}static newNoDocument(e,r){return new vt(e,2,r,he.min(),he.min(),Lt.empty(),0)}static newUnknownDocument(e,r){return new vt(e,3,r,he.min(),he.min(),Lt.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(he.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=he.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e,r){this.position=e,this.inclusive=r}}function ix(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?n=ie.comparator(ie.fromName(o.referenceValue),r.key):n=bi(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function ax(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Pr(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,r="asc"){this.field=e,this.dir=r}}function Ck(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{}class Ke extends x_{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Tk(e,r,n):r==="array-contains"?new Pk(e,n):r==="in"?new Ak(e,n):r==="not-in"?new Rk(e,n):r==="array-contains-any"?new Dk(e,n):new Ke(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new Ik(e,n):new kk(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(bi(r,this.value)):r!==null&&_s(this.value)===_s(r)&&this.matchesComparison(bi(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ce()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gr extends x_{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new gr(e,r)}matches(e){return y_(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function y_(t){return t.op==="and"}function v_(t){return Sk(t)&&y_(t)}function Sk(t){for(const e of t.filters)if(e instanceof gr)return!1;return!0}function zh(t){if(t instanceof Ke)return t.field.canonicalString()+t.op.toString()+Ni(t.value);if(v_(t))return t.filters.map(e=>zh(e)).join(",");{const e=t.filters.map(r=>zh(r)).join(",");return`${t.op}(${e})`}}function w_(t,e){return t instanceof Ke?function(n,s){return s instanceof Ke&&n.op===s.op&&n.field.isEqual(s.field)&&Pr(n.value,s.value)}(t,e):t instanceof gr?function(n,s){return s instanceof gr&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,o,l)=>i&&w_(o,s.filters[l]),!0):!1}(t,e):void ce()}function __(t){return t instanceof Ke?function(r){return`${r.field.canonicalString()} ${r.op} ${Ni(r.value)}`}(t):t instanceof gr?function(r){return r.op.toString()+" {"+r.getFilters().map(__).join(" ,")+"}"}(t):"Filter"}class Tk extends Ke{constructor(e,r,n){super(e,r,n),this.key=ie.fromName(n.referenceValue)}matches(e){const r=ie.comparator(e.key,this.key);return this.matchesComparison(r)}}class Ik extends Ke{constructor(e,r){super(e,"in",r),this.keys=b_("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class kk extends Ke{constructor(e,r){super(e,"not-in",r),this.keys=b_("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function b_(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>ie.fromName(n.referenceValue))}class Pk extends Ke{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return gf(r)&&lo(r.arrayValue,this.value)}}class Ak extends Ke{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&lo(this.value.arrayValue,r)}}class Rk extends Ke{constructor(e,r){super(e,"not-in",r)}matches(e){if(lo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!lo(this.value.arrayValue,r)}}class Dk extends Ke{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!gf(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>lo(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,r=null,n=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function ox(t,e=null,r=[],n=[],s=null,i=null,o=null){return new Lk(t,e,r,n,s,i,o)}function xf(t){const e=me(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>zh(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),lu(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Ni(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Ni(n)).join(",")),e.ue=r}return e.ue}function yf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Ck(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!w_(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ax(t.startAt,e.startAt)&&ax(t.endAt,e.endAt)}function qh(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,r=null,n=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Ok(t,e,r,n,s,i,o,l){return new Mi(t,e,r,n,s,i,o,l)}function cu(t){return new Mi(t)}function lx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function N_(t){return t.collectionGroup!==null}function Ra(t){const e=me(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new ot(it.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new co(i,n))}),r.has(it.keyField().canonicalString())||e.ce.push(new co(it.keyField(),n))}return e.ce}function Tr(t){const e=me(t);return e.le||(e.le=Vk(e,Ra(t))),e.le}function Vk(t,e){if(t.limitType==="F")return ox(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new co(s.field,i)});const r=t.endAt?new Tc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Tc(t.startAt.position,t.startAt.inclusive):null;return ox(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Wh(t,e){const r=t.filters.concat([e]);return new Mi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Ic(t,e,r){return new Mi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function uu(t,e){return yf(Tr(t),Tr(e))&&t.limitType===e.limitType}function E_(t){return`${xf(Tr(t))}|lt:${t.limitType}`}function Ms(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>__(s)).join(", ")}]`),lu(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Ni(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Ni(s)).join(",")),`Target(${n})`}(Tr(t))}; limitType=${t.limitType})`}function du(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):ie.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of Ra(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(o,l,u){const d=ix(o,l,u);return o.inclusive?d<=0:d<0}(n.startAt,Ra(n),s)||n.endAt&&!function(o,l,u){const d=ix(o,l,u);return o.inclusive?d>=0:d>0}(n.endAt,Ra(n),s))}(t,e)}function Mk(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function j_(t){return(e,r)=>{let n=!1;for(const s of Ra(t)){const i=Fk(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function Fk(t,e,r){const n=t.field.isKeyField()?ie.comparator(e.key,r.key):function(i,o,l){const u=o.data.field(i),d=l.data.field(i);return u!==null&&d!==null?bi(u,d):ce()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ce()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Is(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return f_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk=new Fe(ie.comparator);function Zr(){return Uk}const C_=new Fe(ie.comparator);function ya(...t){let e=C_;for(const r of t)e=e.insert(r.key,r);return e}function S_(t){let e=C_;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function os(){return Da()}function T_(){return Da()}function Da(){return new Fi(t=>t.toString(),(t,e)=>t.isEqual(e))}const Bk=new Fe(ie.comparator),$k=new ot(ie.comparator);function pe(...t){let e=$k;for(const r of t)e=e.add(r);return e}const zk=new ot(be);function qk(){return zk}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sc(e)?"-0":e}}function I_(t){return{integerValue:""+t}}function Wk(t,e){return _k(e)?I_(e):vf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(){this._=void 0}}function Hk(t,e,r){return t instanceof kc?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&ff(i)&&(i=pf(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(r,e):t instanceof uo?P_(t,e):t instanceof ho?A_(t,e):function(s,i){const o=k_(s,i),l=cx(o)+cx(s.Pe);return $h(o)&&$h(s.Pe)?I_(l):vf(s.serializer,l)}(t,e)}function Gk(t,e,r){return t instanceof uo?P_(t,e):t instanceof ho?A_(t,e):r}function k_(t,e){return t instanceof Pc?function(n){return $h(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class kc extends hu{}class uo extends hu{constructor(e){super(),this.elements=e}}function P_(t,e){const r=R_(e);for(const n of t.elements)r.some(s=>Pr(s,n))||r.push(n);return{arrayValue:{values:r}}}class ho extends hu{constructor(e){super(),this.elements=e}}function A_(t,e){let r=R_(e);for(const n of t.elements)r=r.filter(s=>!Pr(s,n));return{arrayValue:{values:r}}}class Pc extends hu{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function cx(t){return qe(t.integerValue||t.doubleValue)}function R_(t){return gf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Kk(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof uo&&s instanceof uo||n instanceof ho&&s instanceof ho?_i(n.elements,s.elements,Pr):n instanceof Pc&&s instanceof Pc?Pr(n.Pe,s.Pe):n instanceof kc&&s instanceof kc}(t.transform,e.transform)}class Qk{constructor(e,r){this.version=e,this.transformResults=r}}class Tt{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Tt}static exists(e){return new Tt(void 0,e)}static updateTime(e){return new Tt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class mu{}function D_(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new fu(t.key,Tt.none()):new jo(t.key,t.data,Tt.none());{const r=t.data,n=Lt.empty();let s=new ot(it.comparator);for(let i of e.fields)if(!s.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new Gn(t.key,n,new Ht(s.toArray()),Tt.none())}}function Xk(t,e,r){t instanceof jo?function(s,i,o){const l=s.value.clone(),u=dx(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof Gn?function(s,i,o){if(!zl(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=dx(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(L_(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,r):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function La(t,e,r,n){return t instanceof jo?function(i,o,l,u){if(!zl(i.precondition,o))return l;const d=i.value.clone(),h=hx(i.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof Gn?function(i,o,l,u){if(!zl(i.precondition,o))return l;const d=hx(i.fieldTransforms,u,o),h=o.data;return h.setAll(L_(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(i,o,l){return zl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function Yk(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=k_(n.transform,s||null);i!=null&&(r===null&&(r=Lt.empty()),r.set(n.field,i))}return r||null}function ux(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&_i(n,s,(i,o)=>Kk(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class jo extends mu{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Gn extends mu{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function L_(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function dx(t,e,r){const n=new Map;je(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);n.set(i.field,Gk(o,l,r[s]))}return n}function hx(t,e,r){const n=new Map;for(const s of t){const i=s.transform,o=r.data.field(s.field);n.set(s.field,Hk(i,o,e))}return n}class fu extends mu{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Jk extends mu{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Xk(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=La(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=La(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=T_();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=r.has(s.key)?null:l;const u=D_(o,l);u!==null&&n.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(he.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),pe())}isEqual(e){return this.batchId===e.batchId&&_i(this.mutations,e.mutations,(r,n)=>ux(r,n))&&_i(this.baseMutations,e.baseMutations,(r,n)=>ux(r,n))}}class wf{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){je(e.mutations.length===n.length);let s=function(){return Bk}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new wf(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He,ve;function r2(t){switch(t){default:return ce();case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0}}function O_(t){if(t===void 0)return Jr("GRPC error has no .code"),G.UNKNOWN;switch(t){case He.OK:return G.OK;case He.CANCELLED:return G.CANCELLED;case He.UNKNOWN:return G.UNKNOWN;case He.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case He.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case He.INTERNAL:return G.INTERNAL;case He.UNAVAILABLE:return G.UNAVAILABLE;case He.UNAUTHENTICATED:return G.UNAUTHENTICATED;case He.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case He.NOT_FOUND:return G.NOT_FOUND;case He.ALREADY_EXISTS:return G.ALREADY_EXISTS;case He.PERMISSION_DENIED:return G.PERMISSION_DENIED;case He.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case He.ABORTED:return G.ABORTED;case He.OUT_OF_RANGE:return G.OUT_OF_RANGE;case He.UNIMPLEMENTED:return G.UNIMPLEMENTED;case He.DATA_LOSS:return G.DATA_LOSS;default:return ce()}}(ve=He||(He={}))[ve.OK=0]="OK",ve[ve.CANCELLED=1]="CANCELLED",ve[ve.UNKNOWN=2]="UNKNOWN",ve[ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ve[ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ve[ve.NOT_FOUND=5]="NOT_FOUND",ve[ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",ve[ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",ve[ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",ve[ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ve[ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ve[ve.ABORTED=10]="ABORTED",ve[ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",ve[ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",ve[ve.INTERNAL=13]="INTERNAL",ve[ve.UNAVAILABLE=14]="UNAVAILABLE",ve[ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2=new us([4294967295,4294967295],0);function mx(t){const e=n2().encode(t),r=new a_;return r.update(e),new Uint8Array(r.digest())}function fx(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new us([r,n],0),new us([s,i],0)]}class _f{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new va(`Invalid padding: ${r}`);if(n<0)throw new va(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new va(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new va(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=us.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(us.fromNumber(n)));return s.compare(s2)===1&&(s=new us([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=mx(e),[n,s]=fx(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(n,s,i);if(!this.de(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new _f(i,s,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const r=mx(e),[n,s]=fx(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(n,s,i);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class va extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Co.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new pu(he.min(),s,new Fe(be),Zr(),pe())}}class Co{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Co(n,r,pe(),pe(),pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class V_{constructor(e,r){this.targetId=e,this.me=r}}class M_{constructor(e,r,n=ct.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class px{constructor(){this.fe=0,this.ge=xx(),this.pe=ct.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=pe(),r=pe(),n=pe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:ce()}}),new Co(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=xx()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,je(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class i2{constructor(e){this.Le=e,this.Be=new Map,this.ke=Zr(),this.qe=gx(),this.Qe=new Fe(be)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:ce()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(qh(i))if(n===0){const o=new ie(i.path);this.Ue(r,o,vt.newNoDocument(o,he.min()))}else je(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(r);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,d)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let o,l;try{o=ws(n).toUint8Array()}catch(u){if(u instanceof p_)return wi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new _f(o,s,i)}catch(u){return wi(u instanceof va?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&qh(l.target)){const u=new ie(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,vt.newNoDocument(u,e))}i.be&&(r.set(o,i.ve()),i.Ce())}});let n=pe();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new pu(e,r,this.Qe,this.ke,n);return this.ke=Zr(),this.qe=gx(),this.Qe=new Fe(be),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new px,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new ot(be),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||se("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new px),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function gx(){return new Fe(ie.comparator)}function xx(){return new Fe(ie.comparator)}const a2={asc:"ASCENDING",desc:"DESCENDING"},o2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},l2={and:"AND",or:"OR"};class c2{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Hh(t,e){return t.useProto3Json||lu(e)?e:{value:e}}function Ac(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function F_(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function u2(t,e){return Ac(t,e.toTimestamp())}function Ir(t){return je(!!t),he.fromTimestamp(function(r){const n=Bn(r);return new De(n.seconds,n.nanos)}(t))}function bf(t,e){return Gh(t,e).canonicalString()}function Gh(t,e){const r=function(s){return new ke(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function U_(t){const e=ke.fromString(t);return je(W_(e)),e}function Kh(t,e){return bf(t.databaseId,e.path)}function Sd(t,e){const r=U_(e);if(r.get(1)!==t.databaseId.projectId)throw new re(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new re(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ie($_(r))}function B_(t,e){return bf(t.databaseId,e)}function d2(t){const e=U_(t);return e.length===4?ke.emptyPath():$_(e)}function Qh(t){return new ke(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $_(t){return je(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function yx(t,e,r){return{name:Kh(t,e),fields:r.value.mapValue.fields}}function h2(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ce()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(je(h===void 0||typeof h=="string"),ct.fromBase64String(h||"")):(je(h===void 0||h instanceof Buffer||h instanceof Uint8Array),ct.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const h=d.code===void 0?G.UNKNOWN:O_(d.code);return new re(h,d.message||"")}(o);r=new M_(n,s,i,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Sd(t,n.document.name),i=Ir(n.document.updateTime),o=n.document.createTime?Ir(n.document.createTime):he.min(),l=new Lt({mapValue:{fields:n.document.fields}}),u=vt.newFoundDocument(s,i,o,l),d=n.targetIds||[],h=n.removedTargetIds||[];r=new ql(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Sd(t,n.document),i=n.readTime?Ir(n.readTime):he.min(),o=vt.newNoDocument(s,i),l=n.removedTargetIds||[];r=new ql([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Sd(t,n.document),i=n.removedTargetIds||[];r=new ql([],i,s,null)}else{if(!("filter"in e))return ce();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new t2(s,i),l=n.targetId;r=new V_(l,o)}}return r}function m2(t,e){let r;if(e instanceof jo)r={update:yx(t,e.key,e.value)};else if(e instanceof fu)r={delete:Kh(t,e.key)};else if(e instanceof Gn)r={update:yx(t,e.key,e.data),updateMask:b2(e.fieldMask)};else{if(!(e instanceof Jk))return ce();r={verify:Kh(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const l=o.transform;if(l instanceof kc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof uo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ho)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Pc)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw ce()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:u2(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ce()}(t,e.precondition)),r}function f2(t,e){return t&&t.length>0?(je(e!==void 0),t.map(r=>function(s,i){let o=s.updateTime?Ir(s.updateTime):Ir(i);return o.isEqual(he.min())&&(o=Ir(i)),new Qk(o,s.transformResults||[])}(r,e))):[]}function p2(t,e){return{documents:[B_(t,e.path)]}}function g2(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=B_(t,s);const i=function(d){if(d.length!==0)return q_(gr.create(d,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(p){return{field:Fs(p.field),direction:v2(p.dir)}}(h))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=Hh(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:r,parent:s}}function x2(t){let e=d2(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){je(n===1);const h=r.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];r.where&&(i=function(f){const p=z_(f);return p instanceof gr&&v_(p)?p.getFilters():[p]}(r.where));let o=[];r.orderBy&&(o=function(f){return f.map(p=>function(_){return new co(Us(_.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(p))}(r.orderBy));let l=null;r.limit&&(l=function(f){let p;return p=typeof f=="object"?f.value:f,lu(p)?null:p}(r.limit));let u=null;r.startAt&&(u=function(f){const p=!!f.before,b=f.values||[];return new Tc(b,p)}(r.startAt));let d=null;return r.endAt&&(d=function(f){const p=!f.before,b=f.values||[];return new Tc(b,p)}(r.endAt)),Ok(e,s,o,i,l,"F",u,d)}function y2(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ce()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function z_(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Us(r.unaryFilter.field);return Ke.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Us(r.unaryFilter.field);return Ke.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Us(r.unaryFilter.field);return Ke.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Us(r.unaryFilter.field);return Ke.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ce()}}(t):t.fieldFilter!==void 0?function(r){return Ke.create(Us(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ce()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return gr.create(r.compositeFilter.filters.map(n=>z_(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ce()}}(r.compositeFilter.op))}(t):ce()}function v2(t){return a2[t]}function w2(t){return o2[t]}function _2(t){return l2[t]}function Fs(t){return{fieldPath:t.canonicalString()}}function Us(t){return it.fromServerFormat(t.fieldPath)}function q_(t){return t instanceof Ke?function(r){if(r.op==="=="){if(sx(r.value))return{unaryFilter:{field:Fs(r.field),op:"IS_NAN"}};if(nx(r.value))return{unaryFilter:{field:Fs(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(sx(r.value))return{unaryFilter:{field:Fs(r.field),op:"IS_NOT_NAN"}};if(nx(r.value))return{unaryFilter:{field:Fs(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fs(r.field),op:w2(r.op),value:r.value}}}(t):t instanceof gr?function(r){const n=r.getFilters().map(s=>q_(s));return n.length===1?n[0]:{compositeFilter:{op:_2(r.op),filters:n}}}(t):ce()}function b2(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function W_(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,r,n,s,i=he.min(),o=he.min(),l=ct.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Nn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e){this.ct=e}}function E2(t){const e=x2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ic(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(){this.un=new C2}addToCollectionParentIndex(e,r){return this.un.add(r),K.resolve()}getCollectionParents(e,r){return K.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return K.resolve()}deleteFieldIndex(e,r){return K.resolve()}deleteAllFieldIndexes(e){return K.resolve()}createTargetIndexes(e,r){return K.resolve()}getDocumentsMatchingTarget(e,r){return K.resolve(null)}getIndexType(e,r){return K.resolve(0)}getFieldIndexes(e,r){return K.resolve([])}getNextCollectionGroupToUpdate(e){return K.resolve(null)}getMinOffset(e,r){return K.resolve(Un.min())}getMinOffsetFromCollectionGroup(e,r){return K.resolve(Un.min())}updateCollectionGroup(e,r,n){return K.resolve()}updateIndexEntries(e,r){return K.resolve()}}class C2{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new ot(ke.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new ot(ke.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ei(0)}static kn(){return new Ei(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(){this.changes=new Fi(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,vt.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?K.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&La(n.mutation,s,Ht.empty(),De.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,pe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=pe()){const s=os();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let o=ya();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=os();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,pe()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,s){let i=Zr();const o=Da(),l=function(){return Da()}();return r.forEach((u,d)=>{const h=n.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Gn)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),La(h.mutation,d,h.mutation.getFieldMask(),De.now())):o.set(d.key,Ht.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,h)=>o.set(d,h)),r.forEach((d,h)=>{var f;return l.set(d,new T2(h,(f=o.get(d))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,r){const n=Da();let s=new Fe((o,l)=>o-l),i=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(u=>{const d=r.get(u);if(d===null)return;let h=n.get(u)||Ht.empty();h=l.applyToLocalView(d,h),n.set(u,h);const f=(s.get(l.batchId)||pe()).add(u);s=s.insert(l.batchId,f)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,h=u.value,f=T_();h.forEach(p=>{if(!i.has(p)){const b=D_(r.get(p),n.get(p));b!==null&&f.set(p,b),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,f))}return K.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(o){return ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):N_(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):K.resolve(os());let l=-1,u=i;return o.next(d=>K.forEach(d,(h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(h)?K.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{u=u.insert(h,p)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,pe())).next(h=>({batchId:l,changes:S_(h)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ie(r)).next(n=>{let s=ya();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let o=ya();return this.indexManager.getCollectionParents(e,i).next(l=>K.forEach(l,u=>{const d=function(f,p){return new Mi(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,n,s).next(h=>{h.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(o=>{i.forEach((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,vt.newInvalidDocument(h)))});let l=ya();return o.forEach((u,d)=>{const h=i.get(u);h!==void 0&&La(h.mutation,d,Ht.empty(),De.now()),du(r,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return K.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Ir(s.createTime)}}(r)),K.resolve()}getNamedQuery(e,r){return K.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:E2(s.bundledQuery),readTime:Ir(s.readTime)}}(r)),K.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(){this.overlays=new Fe(ie.comparator),this.Ir=new Map}getOverlay(e,r){return K.resolve(this.overlays.get(r))}getOverlays(e,r){const n=os();return K.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),K.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),K.resolve()}getOverlaysForCollection(e,r,n){const s=os(),i=r.length+1,o=new ie(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>n&&s.set(u.getKey(),u)}return K.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Fe((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let h=i.get(d.largestBatchId);h===null&&(h=os(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=os(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=s)););return K.resolve(l)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new e2(r,n));let i=this.Ir.get(r);i===void 0&&(i=pe(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(){this.sessionToken=ct.EMPTY_BYTE_STRING}getSessionToken(e){return K.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,K.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(){this.Tr=new ot(Ye.Er),this.dr=new ot(Ye.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Ye(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Ye(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new ie(new ke([])),n=new Ye(r,e),s=new Ye(r,e+1),i=[];return this.dr.forEachInRange([n,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new ie(new ke([])),n=new Ye(r,e),s=new Ye(r,e+1);let i=pe();return this.dr.forEachInRange([n,s],o=>{i=i.add(o.key)}),i}containsKey(e){const r=new Ye(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Ye{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return ie.comparator(e.key,r.key)||be(e.wr,r.wr)}static Ar(e,r){return be(e.wr,r.wr)||ie.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new ot(Ye.Er)}checkEmpty(e){return K.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Zk(i,r,n,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new Ye(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return K.resolve(o)}lookupMutationBatch(e,r){return K.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return K.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return K.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return K.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Ye(r,0),s=new Ye(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],o=>{const l=this.Dr(o.wr);i.push(l)}),K.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ot(be);return r.forEach(s=>{const i=new Ye(s,0),o=new Ye(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{n=n.add(l.wr)})}),K.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;ie.isDocumentKey(i)||(i=i.child(""));const o=new Ye(new ie(i),0);let l=new ot(be);return this.br.forEachWhile(u=>{const d=u.key.path;return!!n.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.wr)),!0)},o),K.resolve(this.Cr(l))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){je(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return K.forEach(r.mutations,s=>{const i=new Ye(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Ye(r,0),s=this.br.firstAfterOrEqual(n);return K.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,K.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e){this.Mr=e,this.docs=function(){return new Fe(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return K.resolve(n?n.document.mutableCopy():vt.newInvalidDocument(r))}getEntries(e,r){let n=Zr();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():vt.newInvalidDocument(s))}),K.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=Zr();const o=r.path,l=new ie(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||xk(gk(h),n)<=0||(s.has(h.key)||du(r,h))&&(i=i.insert(h.key,h.mutableCopy()))}return K.resolve(i)}getAllFromCollectionGroup(e,r,n,s){ce()}Or(e,r){return K.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new L2(this)}getSize(e){return K.resolve(this.size)}}class L2 extends S2{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),K.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e){this.persistence=e,this.Nr=new Fi(r=>xf(r),yf),this.lastRemoteSnapshotVersion=he.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Nf,this.targetCount=0,this.kr=Ei.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),K.resolve()}getLastRemoteSnapshotVersion(e){return K.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return K.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),K.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),K.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Ei(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,K.resolve()}updateTargetData(e,r){return this.Kn(r),K.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,K.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),K.waitFor(i).next(()=>s)}getTargetCount(e){return K.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return K.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),K.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),K.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),K.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return K.resolve(n)}containsKey(e,r){return K.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(e,r){this.qr={},this.overlays={},this.Qr=new mf(0),this.Kr=!1,this.Kr=!0,this.$r=new A2,this.referenceDelegate=e(this),this.Ur=new O2(this),this.indexManager=new j2,this.remoteDocumentCache=function(s){return new D2(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new N2(r),this.Gr=new k2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new P2,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new R2(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){se("MemoryPersistence","Starting transaction:",e);const s=new M2(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return K.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class M2 extends vk{constructor(e){super(),this.currentSequenceNumber=e}}class Ef{constructor(e){this.persistence=e,this.Jr=new Nf,this.Yr=null}static Zr(e){return new Ef(e)}get Xr(){if(this.Yr)return this.Yr;throw ce()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),K.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),K.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),K.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return K.forEach(this.Xr,n=>{const s=ie.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,he.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return K.or([()=>K.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=pe(),s=pe();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new jf(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return IS()?8:wk(bt())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new F2;return this.Xi(e,r,o).next(l=>{if(i.result=l,this.zi)return this.es(e,r,o,l.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(ca()<=ge.DEBUG&&se("QueryEngine","SDK will not create cache indexes for query:",Ms(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),K.resolve()):(ca()<=ge.DEBUG&&se("QueryEngine","Query:",Ms(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(ca()<=ge.DEBUG&&se("QueryEngine","The SDK decides to create cache indexes for query:",Ms(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Tr(r))):K.resolve())}Yi(e,r){if(lx(r))return K.resolve(null);let n=Tr(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=Ic(r,null,"F"),n=Tr(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=pe(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(u=>{const d=this.ts(r,l);return this.ns(r,d,o,u.readTime)?this.Yi(e,Ic(r,null,"F")):this.rs(e,d,r,u)}))})))}Zi(e,r,n,s){return lx(r)||s.isEqual(he.min())?K.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const o=this.ts(r,i);return this.ns(r,o,n,s)?K.resolve(null):(ca()<=ge.DEBUG&&se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ms(r)),this.rs(e,o,r,pk(s,-1)).next(l=>l))})}ts(e,r){let n=new ot(j_(e));return r.forEach((s,i)=>{du(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return ca()<=ge.DEBUG&&se("QueryEngine","Using full collection scan to execute query:",Ms(r)),this.Ji.getDocumentsMatchingQuery(e,r,Un.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new Fe(be),this._s=new Fi(i=>xf(i),yf),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new I2(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function $2(t,e,r,n){return new B2(t,e,r,n)}async function H_(t,e){const r=me(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],l=[];let u=pe();for(const d of s){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of i){l.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return r.localDocuments.getDocuments(n,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function z2(t,e){const r=me(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,d,h){const f=d.batch,p=f.keys();let b=K.resolve();return p.forEach(_=>{b=b.next(()=>h.getEntry(u,_)).next(k=>{const P=d.docVersions.get(_);je(P!==null),k.version.compareTo(P)<0&&(f.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),h.addEntry(k)))})}),b.next(()=>l.mutationQueue.removeMutationBatch(u,f))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=pe();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function G_(t){const e=me(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function q2(t,e){const r=me(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const l=[];e.targetChanges.forEach((h,f)=>{const p=s.get(f);if(!p)return;l.push(r.Ur.removeMatchingKeys(i,h.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(i,h.addedDocuments,f)));let b=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?b=b.withResumeToken(ct.EMPTY_BYTE_STRING,he.min()).withLastLimboFreeSnapshotVersion(he.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,n)),s=s.insert(f,b),function(k,P,N){return k.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0}(p,b,h)&&l.push(r.Ur.updateTargetData(i,b))});let u=Zr(),d=pe();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(W2(i,o,e.documentUpdates).next(h=>{u=h.Ps,d=h.Is})),!n.isEqual(he.min())){const h=r.Ur.getLastRemoteSnapshotVersion(i).next(f=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));l.push(h)}return K.waitFor(l).next(()=>o.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(r.os=s,i))}function W2(t,e,r){let n=pe(),s=pe();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let o=Zr();return r.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(he.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):se("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function H2(t,e){const r=me(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function G2(t,e){const r=me(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,K.resolve(s)):r.Ur.allocateTargetId(n).next(o=>(s=new Nn(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Xh(t,e,r){const n=me(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Eo(o))throw o;se("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function vx(t,e,r){const n=me(t);let s=he.min(),i=pe();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,h){const f=me(u),p=f._s.get(h);return p!==void 0?K.resolve(f.os.get(p)):f.Ur.getTargetData(d,h)}(n,o,Tr(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?s:he.min(),r?i:pe())).next(l=>(K2(n,Mk(e),l),{documents:l,Ts:i})))}function K2(t,e,r){let n=t.us.get(e)||he.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class wx{constructor(){this.activeTargetIds=qk()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Q2{constructor(){this.so=new wx,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new wx,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){se("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){se("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wl=null;function Td(){return wl===null?wl=function(){return 268435456+Math.round(2147483648*Math.random())}():wl++,"0x"+wl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gt="WebChannelConnection";class Z2 extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,o){const l=Td(),u=this.xo(r,n.toUriEncodedString());se("RestConnection",`Sending RPC '${r}' ${l}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(r,u,d,s).then(h=>(se("RestConnection",`Received RPC '${r}' ${l}: `,h),h),h=>{throw wi("RestConnection",`RPC '${r}' ${l} failed with error: `,h,"url: ",u,"request:",s),h})}Lo(r,n,s,i,o,l){return this.Mo(r,n,s,i,o)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vi}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,o)=>r[o]=i),s&&s.headers.forEach((i,o)=>r[o]=i)}xo(r,n){const s=Y2[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=Td();return new Promise((o,l)=>{const u=new o_;u.setWithCredentials(!0),u.listenOnce(l_.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Bl.NO_ERROR:const h=u.getResponseJson();se(gt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case Bl.TIMEOUT:se(gt,`RPC '${e}' ${i} timed out`),l(new re(G.DEADLINE_EXCEEDED,"Request time out"));break;case Bl.HTTP_ERROR:const f=u.getStatus();if(se(gt,`RPC '${e}' ${i} failed with status:`,f,"response text:",u.getResponseText()),f>0){let p=u.getResponseJson();Array.isArray(p)&&(p=p[0]);const b=p==null?void 0:p.error;if(b&&b.status&&b.message){const _=function(P){const N=P.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(N)>=0?N:G.UNKNOWN}(b.status);l(new re(_,b.message))}else l(new re(G.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new re(G.UNAVAILABLE,"Connection failed."));break;default:ce()}}finally{se(gt,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);se(gt,`RPC '${e}' ${i} sending request:`,s),u.send(r,"POST",d,n,15)})}Bo(e,r,n){const s=Td(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=d_(),l=u_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const h=i.join("");se(gt,`Creating RPC '${e}' stream ${s}: ${h}`,u);const f=o.createWebChannel(h,u);let p=!1,b=!1;const _=new J2({Io:P=>{b?se(gt,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(p||(se(gt,`Opening RPC '${e}' stream ${s} transport.`),f.open(),p=!0),se(gt,`RPC '${e}' stream ${s} sending:`,P),f.send(P))},To:()=>f.close()}),k=(P,N,w)=>{P.listen(N,S=>{try{w(S)}catch(R){setTimeout(()=>{throw R},0)}})};return k(f,xa.EventType.OPEN,()=>{b||(se(gt,`RPC '${e}' stream ${s} transport opened.`),_.yo())}),k(f,xa.EventType.CLOSE,()=>{b||(b=!0,se(gt,`RPC '${e}' stream ${s} transport closed`),_.So())}),k(f,xa.EventType.ERROR,P=>{b||(b=!0,wi(gt,`RPC '${e}' stream ${s} transport errored:`,P),_.So(new re(G.UNAVAILABLE,"The operation could not be completed")))}),k(f,xa.EventType.MESSAGE,P=>{var N;if(!b){const w=P.data[0];je(!!w);const S=w,R=S.error||((N=S[0])===null||N===void 0?void 0:N.error);if(R){se(gt,`RPC '${e}' stream ${s} received error:`,R);const M=R.status;let $=function(v){const y=He[v];if(y!==void 0)return O_(y)}(M),E=R.message;$===void 0&&($=G.INTERNAL,E="Unknown error status: "+M+" with message "+R.message),b=!0,_.So(new re($,E)),f.close()}else se(gt,`RPC '${e}' stream ${s} received:`,w),_.bo(w)}}),k(l,c_.STAT_EVENT,P=>{P.stat===Uh.PROXY?se(gt,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===Uh.NOPROXY&&se(gt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{_.wo()},0),_}}function Id(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(t){return new c2(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(e,r,n,s,i,o,l,u){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new K_(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===G.RESOURCE_EXHAUSTED?(Jr(r.toString()),Jr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new re(G.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return se("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(se("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eP extends Q_{constructor(e,r,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=h2(this.serializer,e),n=function(i){if(!("targetChange"in i))return he.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?he.min():o.readTime?Ir(o.readTime):he.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Qh(this.serializer),r.addTarget=function(i,o){let l;const u=o.target;if(l=qh(u)?{documents:p2(i,u)}:{query:g2(i,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=F_(i,o.resumeToken);const d=Hh(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(he.min())>0){l.readTime=Ac(i,o.snapshotVersion.toTimestamp());const d=Hh(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const n=y2(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Qh(this.serializer),r.removeTarget=e,this.a_(r)}}class tP extends Q_{constructor(e,r,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return je(!!e.streamToken),this.lastStreamToken=e.streamToken,je(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){je(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=f2(e.writeResults,e.commitTime),n=Ir(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Qh(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>m2(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new re(G.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Gh(r,n),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new re(G.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Gh(r,n),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(G.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class nP{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Jr(r),this.D_=!1):se("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{n.enqueueAndForget(async()=>{ks(this)&&(se("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=me(u);d.L_.add(4),await So(d),d.q_.set("Unknown"),d.L_.delete(4),await xu(d)}(this))})}),this.q_=new nP(n,s)}}async function xu(t){if(ks(t))for(const e of t.B_)await e(!0)}async function So(t){for(const e of t.B_)await e(!1)}function X_(t,e){const r=me(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),If(r)?Tf(r):Ui(r).r_()&&Sf(r,e))}function Cf(t,e){const r=me(t),n=Ui(r);r.N_.delete(e),n.r_()&&Y_(r,e),r.N_.size===0&&(n.r_()?n.o_():ks(r)&&r.q_.set("Unknown"))}function Sf(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(he.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Ui(t).A_(e)}function Y_(t,e){t.Q_.xe(e),Ui(t).R_(e)}function Tf(t){t.Q_=new i2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ui(t).start(),t.q_.v_()}function If(t){return ks(t)&&!Ui(t).n_()&&t.N_.size>0}function ks(t){return me(t).L_.size===0}function J_(t){t.Q_=void 0}async function iP(t){t.q_.set("Online")}async function aP(t){t.N_.forEach((e,r)=>{Sf(t,e)})}async function oP(t,e){J_(t),If(t)?(t.q_.M_(e),Tf(t)):t.q_.set("Unknown")}async function lP(t,e,r){if(t.q_.set("Online"),e instanceof M_&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(n){se("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Rc(t,n)}else if(e instanceof ql?t.Q_.Ke(e):e instanceof V_?t.Q_.He(e):t.Q_.We(e),!r.isEqual(he.min()))try{const n=await G_(t.localStore);r.compareTo(n)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=i.N_.get(d);h&&i.N_.set(d,h.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,d)=>{const h=i.N_.get(u);if(!h)return;i.N_.set(u,h.withResumeToken(ct.EMPTY_BYTE_STRING,h.snapshotVersion)),Y_(i,u);const f=new Nn(h.target,u,d,h.sequenceNumber);Sf(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){se("RemoteStore","Failed to raise snapshot:",n),await Rc(t,n)}}async function Rc(t,e,r){if(!Eo(e))throw e;t.L_.add(1),await So(t),t.q_.set("Offline"),r||(r=()=>G_(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{se("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await xu(t)})}function Z_(t,e){return e().catch(r=>Rc(t,r,e))}async function yu(t){const e=me(t),r=$n(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;cP(e);)try{const s=await H2(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,uP(e,s)}catch(s){await Rc(e,s)}eb(e)&&tb(e)}function cP(t){return ks(t)&&t.O_.length<10}function uP(t,e){t.O_.push(e);const r=$n(t);r.r_()&&r.V_&&r.m_(e.mutations)}function eb(t){return ks(t)&&!$n(t).n_()&&t.O_.length>0}function tb(t){$n(t).start()}async function dP(t){$n(t).p_()}async function hP(t){const e=$n(t);for(const r of t.O_)e.m_(r.mutations)}async function mP(t,e,r){const n=t.O_.shift(),s=wf.from(n,e,r);await Z_(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await yu(t)}async function fP(t,e){e&&$n(t).V_&&await async function(n,s){if(function(o){return r2(o)&&o!==G.ABORTED}(s.code)){const i=n.O_.shift();$n(n).s_(),await Z_(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await yu(n)}}(t,e),eb(t)&&tb(t)}async function bx(t,e){const r=me(t);r.asyncQueue.verifyOperationInProgress(),se("RemoteStore","RemoteStore received new credentials");const n=ks(r);r.L_.add(3),await So(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await xu(r)}async function pP(t,e){const r=me(t);e?(r.L_.delete(2),await xu(r)):e||(r.L_.add(2),await So(r),r.q_.set("Unknown"))}function Ui(t){return t.K_||(t.K_=function(r,n,s){const i=me(r);return i.w_(),new eP(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:iP.bind(null,t),Ro:aP.bind(null,t),mo:oP.bind(null,t),d_:lP.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),If(t)?Tf(t):t.q_.set("Unknown")):(await t.K_.stop(),J_(t))})),t.K_}function $n(t){return t.U_||(t.U_=function(r,n,s){const i=me(r);return i.w_(),new tP(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:dP.bind(null,t),mo:fP.bind(null,t),f_:hP.bind(null,t),g_:mP.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await yu(t)):(await t.U_.stop(),t.O_.length>0&&(se("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Wr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const o=Date.now()+n,l=new kf(e,r,o,s,i);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(G.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pf(t,e){if(Jr("AsyncQueue",`${e}: ${t}`),Eo(t))return new re(G.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this.comparator=e?(r,n)=>e(r,n)||ie.comparator(r.key,n.key):(r,n)=>ie.comparator(r.key,n.key),this.keyedMap=ya(),this.sortedSet=new Fe(this.comparator)}static emptySet(e){return new ui(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ui)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ui;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(){this.W_=new Fe(ie.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):ce():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class ji{constructor(e,r,n,s,i,o,l,u,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,s,i){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new ji(e,r,ui.emptySet(r),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class xP{constructor(){this.queries=Ex(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=me(r),i=s.queries;s.queries=Ex(),i.forEach((o,l)=>{for(const u of l.j_)u.onError(n)})})(this,new re(G.ABORTED,"Firestore shutting down"))}}function Ex(){return new Fi(t=>E_(t),uu)}async function Af(t,e){const r=me(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new gP,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const l=Pf(o,`Initialization of query '${Ms(e.query)}' failed`);return void e.onError(l)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&Df(r)}async function Rf(t,e){const r=me(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function yP(t,e){const r=me(t);let n=!1;for(const s of e){const i=s.query,o=r.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(n=!0);o.z_=s}}n&&Df(r)}function vP(t,e,r){const n=me(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function Df(t){t.Y_.forEach(e=>{e.next()})}var Yh,jx;(jx=Yh||(Yh={})).ea="default",jx.Cache="cache";class Lf{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new ji(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=ji.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Yh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e){this.key=e}}class nb{constructor(e){this.key=e}}class wP{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=pe(),this.mutatedKeys=pe(),this.Aa=j_(e),this.Ra=new ui(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new Nx,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const p=s.get(h),b=du(this.query,f)?f:null,_=!!p&&this.mutatedKeys.has(p.key),k=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let P=!1;p&&b?p.data.isEqual(b.data)?_!==k&&(n.track({type:3,doc:b}),P=!0):this.ga(p,b)||(n.track({type:2,doc:b}),P=!0,(u&&this.Aa(b,u)>0||d&&this.Aa(b,d)<0)&&(l=!0)):!p&&b?(n.track({type:0,doc:b}),P=!0):p&&!b&&(n.track({type:1,doc:p}),P=!0,(u||d)&&(l=!0)),P&&(b?(o=o.add(b),i=k?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),n.track({type:1,doc:h})}return{Ra:o,fa:n,ns:l,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,f)=>function(b,_){const k=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ce()}};return k(b)-k(_)}(h.type,f.type)||this.Aa(h.doc,f.doc)),this.pa(n),s=s!=null&&s;const l=r&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new ji(this.query,e.Ra,i,o,e.mutatedKeys,u===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Nx,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=pe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new nb(n))}),this.da.forEach(n=>{e.has(n)||r.push(new rb(n))}),r}ba(e){this.Ta=e.Ts,this.da=pe();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return ji.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class _P{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class bP{constructor(e){this.key=e,this.va=!1}}class NP{constructor(e,r,n,s,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Fi(l=>E_(l),uu),this.Ma=new Map,this.xa=new Set,this.Oa=new Fe(ie.comparator),this.Na=new Map,this.La=new Nf,this.Ba={},this.ka=new Map,this.qa=Ei.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function EP(t,e,r=!0){const n=cb(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await sb(n,e,r,!0),s}async function jP(t,e){const r=cb(t);await sb(r,e,!0,!1)}async function sb(t,e,r,n){const s=await G2(t.localStore,Tr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let l;return n&&(l=await CP(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&X_(t.remoteStore,s),l}async function CP(t,e,r,n,s){t.Ka=(f,p,b)=>async function(k,P,N,w){let S=P.view.ma(N);S.ns&&(S=await vx(k.localStore,P.query,!1).then(({documents:E})=>P.view.ma(E,S)));const R=w&&w.targetChanges.get(P.targetId),M=w&&w.targetMismatches.get(P.targetId)!=null,$=P.view.applyChanges(S,k.isPrimaryClient,R,M);return Sx(k,P.targetId,$.wa),$.snapshot}(t,f,p,b);const i=await vx(t.localStore,e,!0),o=new wP(e,i.Ts),l=o.ma(i.documents),u=Co.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,u);Sx(t,r,d.wa);const h=new _P(e,r,o);return t.Fa.set(e,h),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),d.snapshot}async function SP(t,e,r){const n=me(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(o=>!uu(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Xh(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Cf(n.remoteStore,s.targetId),Jh(n,s.targetId)}).catch(No)):(Jh(n,s.targetId),await Xh(n.localStore,s.targetId,!0))}async function TP(t,e){const r=me(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Cf(r.remoteStore,n.targetId))}async function IP(t,e,r){const n=OP(t);try{const s=await function(o,l){const u=me(o),d=De.now(),h=l.reduce((b,_)=>b.add(_.key),pe());let f,p;return u.persistence.runTransaction("Locally write mutations","readwrite",b=>{let _=Zr(),k=pe();return u.cs.getEntries(b,h).next(P=>{_=P,_.forEach((N,w)=>{w.isValidDocument()||(k=k.add(N))})}).next(()=>u.localDocuments.getOverlayedDocuments(b,_)).next(P=>{f=P;const N=[];for(const w of l){const S=Yk(w,f.get(w.key).overlayedDocument);S!=null&&N.push(new Gn(w.key,S,g_(S.value.mapValue),Tt.exists(!0)))}return u.mutationQueue.addMutationBatch(b,d,N,l)}).next(P=>{p=P;const N=P.applyToLocalDocumentSet(f,k);return u.documentOverlayCache.saveOverlays(b,P.batchId,N)})}).then(()=>({batchId:p.batchId,changes:S_(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new Fe(be)),d=d.insert(l,u),o.Ba[o.currentUser.toKey()]=d}(n,s.batchId,r),await To(n,s.changes),await yu(n.remoteStore)}catch(s){const i=Pf(s,"Failed to persist write");r.reject(i)}}async function ib(t,e){const r=me(t);try{const n=await q2(r.localStore,e);e.targetChanges.forEach((s,i)=>{const o=r.Na.get(i);o&&(je(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?je(o.va):s.removedDocuments.size>0&&(je(o.va),o.va=!1))}),await To(r,n,e)}catch(n){await No(n)}}function Cx(t,e,r){const n=me(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=me(o);u.onlineState=l;let d=!1;u.queries.forEach((h,f)=>{for(const p of f.j_)p.Z_(l)&&(d=!0)}),d&&Df(u)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function kP(t,e,r){const n=me(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let o=new Fe(ie.comparator);o=o.insert(i,vt.newNoDocument(i,he.min()));const l=pe().add(i),u=new pu(he.min(),new Map,new Fe(be),o,l);await ib(n,u),n.Oa=n.Oa.remove(i),n.Na.delete(e),Of(n)}else await Xh(n.localStore,e,!1).then(()=>Jh(n,e,r)).catch(No)}async function PP(t,e){const r=me(t),n=e.batch.batchId;try{const s=await z2(r.localStore,e);ob(r,n,null),ab(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await To(r,s)}catch(s){await No(s)}}async function AP(t,e,r){const n=me(t);try{const s=await function(o,l){const u=me(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return u.mutationQueue.lookupMutationBatch(d,l).next(f=>(je(f!==null),h=f.keys(),u.mutationQueue.removeMutationBatch(d,f))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>u.localDocuments.getDocuments(d,h))})}(n.localStore,e);ob(n,e,r),ab(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await To(n,s)}catch(s){await No(s)}}function ab(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function ob(t,e,r){const n=me(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function Jh(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||lb(t,n)})}function lb(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Cf(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Of(t))}function Sx(t,e,r){for(const n of r)n instanceof rb?(t.La.addReference(n.key,e),RP(t,n)):n instanceof nb?(se("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||lb(t,n.key)):ce()}function RP(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(se("SyncEngine","New document in limbo: "+r),t.xa.add(n),Of(t))}function Of(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new ie(ke.fromString(e)),n=t.qa.next();t.Na.set(n,new bP(r)),t.Oa=t.Oa.insert(r,n),X_(t.remoteStore,new Nn(Tr(cu(r.path)),n,"TargetPurposeLimboResolution",mf.oe))}}async function To(t,e,r){const n=me(t),s=[],i=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,u)=>{o.push(n.Ka(u,e,r).then(d=>{var h;if((d||r)&&n.isPrimaryClient){const f=d?!d.fromCache:(h=r==null?void 0:r.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(d){s.push(d);const f=jf.Wi(u.targetId,d);i.push(f)}}))}),await Promise.all(o),n.Ca.d_(s),await async function(u,d){const h=me(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>K.forEach(d,p=>K.forEach(p.$i,b=>h.persistence.referenceDelegate.addReference(f,p.targetId,b)).next(()=>K.forEach(p.Ui,b=>h.persistence.referenceDelegate.removeReference(f,p.targetId,b)))))}catch(f){if(!Eo(f))throw f;se("LocalStore","Failed to update sequence numbers: "+f)}for(const f of d){const p=f.targetId;if(!f.fromCache){const b=h.os.get(p),_=b.snapshotVersion,k=b.withLastLimboFreeSnapshotVersion(_);h.os=h.os.insert(p,k)}}}(n.localStore,i))}async function DP(t,e){const r=me(t);if(!r.currentUser.isEqual(e)){se("SyncEngine","User change. New user:",e.toKey());const n=await H_(r.localStore,e);r.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new re(G.CANCELLED,o))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await To(r,n.hs)}}function LP(t,e){const r=me(t),n=r.Na.get(e);if(n&&n.va)return pe().add(n.key);{let s=pe();const i=r.Ma.get(e);if(!i)return s;for(const o of i){const l=r.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function cb(t){const e=me(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ib.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=LP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=kP.bind(null,e),e.Ca.d_=yP.bind(null,e.eventManager),e.Ca.$a=vP.bind(null,e.eventManager),e}function OP(t){const e=me(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=PP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=AP.bind(null,e),e}class Dc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return $2(this.persistence,new U2,e.initialUser,this.serializer)}Ga(e){return new V2(Ef.Zr,this.serializer)}Wa(e){return new Q2}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Dc.provider={build:()=>new Dc};class Zh{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Cx(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=DP.bind(null,this.syncEngine),await pP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new xP}()}createDatastore(e){const r=gu(e.databaseInfo.databaseId),n=function(i){return new Z2(i)}(e.databaseInfo);return function(i,o,l,u){return new rP(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,o,l){return new sP(n,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>Cx(this.syncEngine,r,0),function(){return _x.D()?new _x:new X2}())}createSyncEngine(e,r){return function(s,i,o,l,u,d,h){const f=new NP(s,i,o,l,u,d);return h&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=me(s);se("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await So(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Zh.provider={build:()=>new Zh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Jr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=xt.UNAUTHENTICATED,this.clientId=m_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{se("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(se("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Pf(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function kd(t,e){t.asyncQueue.verifyOperationInProgress(),se("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await H_(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Tx(t,e){t.asyncQueue.verifyOperationInProgress();const r=await MP(t);se("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>bx(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>bx(e.remoteStore,s)),t._onlineComponents=e}async function MP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){se("FirestoreClient","Using user provided OfflineComponentProvider");try{await kd(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===G.FAILED_PRECONDITION||s.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;wi("Error using user provided cache. Falling back to memory cache: "+r),await kd(t,new Dc)}}else se("FirestoreClient","Using default OfflineComponentProvider"),await kd(t,new Dc);return t._offlineComponents}async function ub(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(se("FirestoreClient","Using user provided OnlineComponentProvider"),await Tx(t,t._uninitializedComponentsProvider._online)):(se("FirestoreClient","Using default OnlineComponentProvider"),await Tx(t,new Zh))),t._onlineComponents}function FP(t){return ub(t).then(e=>e.syncEngine)}async function Lc(t){const e=await ub(t),r=e.eventManager;return r.onListen=EP.bind(null,e.syncEngine),r.onUnlisten=SP.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=jP.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=TP.bind(null,e.syncEngine),r}function UP(t,e,r={}){const n=new Wr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new Vf({next:p=>{h.Za(),o.enqueueAndForget(()=>Rf(i,f));const b=p.docs.has(l);!b&&p.fromCache?d.reject(new re(G.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&p.fromCache&&u&&u.source==="server"?d.reject(new re(G.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),f=new Lf(cu(l.path),h,{includeMetadataChanges:!0,_a:!0});return Af(i,f)}(await Lc(t),t.asyncQueue,e,r,n)),n.promise}function BP(t,e,r={}){const n=new Wr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new Vf({next:p=>{h.Za(),o.enqueueAndForget(()=>Rf(i,f)),p.fromCache&&u.source==="server"?d.reject(new re(G.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),f=new Lf(l,h,{includeMetadataChanges:!0,_a:!0});return Af(i,f)}(await Lc(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function db(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ix=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hb(t,e,r){if(!r)throw new re(G.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $P(t,e,r,n){if(e===!0&&n===!0)throw new re(G.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function kx(t){if(!ie.isDocumentKey(t))throw new re(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Px(t){if(ie.isDocumentKey(t))throw new re(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function vu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ce()}function It(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=vu(t);throw new re(G.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function zP(t,e){if(e<=0)throw new re(G.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new re(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new re(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$P("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=db((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new re(G.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new re(G.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new re(G.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wu{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ax({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ax(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new ak;switch(n.type){case"firstParty":return new uk(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new re(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Ix.get(r);n&&(se("ComponentProvider","Removing Datastore"),Ix.delete(r),n.terminate())}(this),Promise.resolve()}}function qP(t,e,r,n={}){var s;const i=(t=It(t,wu))._getSettings(),o=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),n.mockUserToken){let l,u;if(typeof n.mockUserToken=="string")l=n.mockUserToken,u=xt.MOCK_USER;else{l=_w(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new re(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new xt(d)}t._authCredentials=new ok(new h_(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new nn(this.firestore,e,this._query)}}class wt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new On(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wt(this.firestore,e,this._key)}}class On extends nn{constructor(e,r,n){super(e,r,cu(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wt(this.firestore,null,new ie(e))}withConverter(e){return new On(this.firestore,e,this._path)}}function ut(t,e,...r){if(t=Ae(t),hb("collection","path",e),t instanceof wu){const n=ke.fromString(e,...r);return Px(n),new On(t,null,n)}{if(!(t instanceof wt||t instanceof On))throw new re(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ke.fromString(e,...r));return Px(n),new On(t.firestore,null,n)}}function et(t,e,...r){if(t=Ae(t),arguments.length===1&&(e=m_.newId()),hb("doc","path",e),t instanceof wu){const n=ke.fromString(e,...r);return kx(n),new wt(t,null,new ie(n))}{if(!(t instanceof wt||t instanceof On))throw new re(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ke.fromString(e,...r));return kx(n),new wt(t.firestore,t instanceof On?t.converter:null,new ie(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rx{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new K_(this,"async_queue_retry"),this.Vu=()=>{const n=Id();n&&se("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Id();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Id();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Wr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Eo(e))throw e;se("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw Jr("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=kf.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ce()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function Dx(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Ar extends wu{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Rx,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Rx(e),this._firestoreClient=void 0,await e}}}function WP(t,e){const r=typeof t=="object"?t:tf(),n=typeof t=="string"?t:"(default)",s=nu(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=yw("firestore");i&&qP(s,...i)}return s}function Io(t){if(t._terminated)throw new re(G.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||HP(t),t._firestoreClient}function HP(t){var e,r,n;const s=t._freezeSettings(),i=function(l,u,d,h){return new Nk(l,u,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,db(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new VP(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ci(ct.fromBase64String(e))}catch(r){throw new re(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Ci(ct.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new re(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new it(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new re(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new re(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return be(this._lat,e._lat)||be(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP=/^__.*__$/;class KP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Gn(e,this.data,this.fieldMask,r,this.fieldTransforms):new jo(e,this.data,r,this.fieldTransforms)}}class mb{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Gn(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function fb(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ce()}}class Bf{constructor(e,r,n,s,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Bf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Oc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(fb(this.Cu)&&GP.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class QP{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||gu(e)}Qu(e,r,n,s=!1){return new Bf({Cu:e,methodName:r,qu:n,path:it.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Po(t){const e=t._freezeSettings(),r=gu(t._databaseId);return new QP(t._databaseId,!!e.ignoreUndefinedProperties,r)}function $f(t,e,r,n,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);zf("Data must be an object, but it was:",o,n);const l=xb(n,o);let u,d;if(i.merge)u=new Ht(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const p=em(e,f,r);if(!o.contains(p))throw new re(G.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);vb(h,p)||h.push(p)}u=new Ht(h),d=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,d=o.fieldTransforms;return new KP(new Lt(l),u,d)}class _u extends Mf{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _u}}function pb(t,e,r,n){const s=t.Qu(1,e,r);zf("Data must be an object, but it was:",s,n);const i=[],o=Lt.empty();Is(n,(u,d)=>{const h=qf(e,u,r);d=Ae(d);const f=s.Nu(h);if(d instanceof _u)i.push(h);else{const p=Ao(d,f);p!=null&&(i.push(h),o.set(h,p))}});const l=new Ht(i);return new mb(o,l,s.fieldTransforms)}function gb(t,e,r,n,s,i){const o=t.Qu(1,e,r),l=[em(e,n,r)],u=[s];if(i.length%2!=0)throw new re(G.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)l.push(em(e,i[p])),u.push(i[p+1]);const d=[],h=Lt.empty();for(let p=l.length-1;p>=0;--p)if(!vb(d,l[p])){const b=l[p];let _=u[p];_=Ae(_);const k=o.Nu(b);if(_ instanceof _u)d.push(b);else{const P=Ao(_,k);P!=null&&(d.push(b),h.set(b,P))}}const f=new Ht(d);return new mb(h,f,o.fieldTransforms)}function XP(t,e,r,n=!1){return Ao(r,t.Qu(n?4:3,e))}function Ao(t,e){if(yb(t=Ae(t)))return zf("Unsupported field value:",e,t),xb(t,e);if(t instanceof Mf)return function(n,s){if(!fb(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let o=0;for(const l of n){let u=Ao(l,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=Ae(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Wk(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=De.fromDate(n);return{timestampValue:Ac(s.serializer,i)}}if(n instanceof De){const i=new De(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ac(s.serializer,i)}}if(n instanceof Ff)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ci)return{bytesValue:F_(s.serializer,n._byteString)};if(n instanceof wt){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:bf(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Uf)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return vf(l.serializer,u)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${vu(n)}`)}(t,e)}function xb(t,e){const r={};return f_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Is(t,(n,s)=>{const i=Ao(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function yb(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof De||t instanceof Ff||t instanceof Ci||t instanceof wt||t instanceof Mf||t instanceof Uf)}function zf(t,e,r){if(!yb(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=vu(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function em(t,e,r){if((e=Ae(e))instanceof ko)return e._internalPath;if(typeof e=="string")return qf(t,e);throw Oc("Field path arguments must be of type string or ",t,!1,void 0,r)}const YP=new RegExp("[~\\*/\\[\\]]");function qf(t,e,r){if(e.search(YP)>=0)throw Oc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new ko(...e.split("."))._internalPath}catch{throw Oc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Oc(t,e,r,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${n}`),o&&(u+=` in document ${s}`),u+=")"),new re(G.INVALID_ARGUMENT,l+t+u)}function vb(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new wt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(bu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class JP extends wb{data(){return super.data()}}function bu(t,e){return typeof e=="string"?qf(t,e):e instanceof ko?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _b(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wf{}class Hf extends Wf{}function Ot(t,e,...r){let n=[];e instanceof Wf&&n.push(e),n=n.concat(r),function(i){const o=i.filter(u=>u instanceof Gf).length,l=i.filter(u=>u instanceof Nu).length;if(o>1||o>0&&l>0)throw new re(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Nu extends Hf{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Nu(e,r,n)}_apply(e){const r=this._parse(e);return bb(e._query,r),new nn(e.firestore,e.converter,Wh(e._query,r))}_parse(e){const r=Po(e.firestore);return function(i,o,l,u,d,h,f){let p;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new re(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Ox(f,h);const b=[];for(const _ of f)b.push(Lx(u,i,_));p={arrayValue:{values:b}}}else p=Lx(u,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Ox(f,h),p=XP(l,o,f,h==="in"||h==="not-in");return Ke.create(d,h,p)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function kr(t,e,r){const n=e,s=bu("where",t);return Nu._create(s,n,r)}class Gf extends Wf{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Gf(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:gr.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)bb(o,u),o=Wh(o,u)}(e._query,r),new nn(e.firestore,e.converter,Wh(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Kf extends Hf{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Kf(e,r)}_apply(e){const r=function(s,i,o){if(s.startAt!==null)throw new re(G.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new re(G.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new co(i,o)}(e._query,this._field,this._direction);return new nn(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Mi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function bs(t,e="asc"){const r=e,n=bu("orderBy",t);return Kf._create(n,r)}class Qf extends Hf{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Qf(e,r,n)}_apply(e){return new nn(e.firestore,e.converter,Ic(e._query,this._limit,this._limitType))}}function Xf(t){return zP("limit",t),Qf._create("limit",t,"F")}function Lx(t,e,r){if(typeof(r=Ae(r))=="string"){if(r==="")throw new re(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!N_(e)&&r.indexOf("/")!==-1)throw new re(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(ke.fromString(r));if(!ie.isDocumentKey(n))throw new re(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return rx(t,new ie(n))}if(r instanceof wt)return rx(t,r._key);throw new re(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vu(r)}.`)}function Ox(t,e){if(!Array.isArray(t)||t.length===0)throw new re(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bb(t,e){const r=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new re(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class ZP{convertValue(e,r="none"){switch(_s(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ws(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ce()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Is(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(o=>qe(o.doubleValue));return new Uf(i)}convertGeoPoint(e){return new Ff(qe(e.latitude),qe(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=pf(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(ao(e));default:return null}}convertTimestamp(e){const r=Bn(e);return new De(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=ke.fromString(e);je(W_(n));const s=new oo(n.get(1),n.get(3)),i=new ie(n.popFirst(5));return s.isEqual(r)||Jr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yf(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Nb extends wb{constructor(e,r,n,s,i,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Wl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(bu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Wl extends Nb{data(e={}){return super.data(e)}}class Eb{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new wa(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Wl(this._firestore,this._userDataWriter,n.key,n,new wa(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new re(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new Wl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new wa(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Wl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new wa(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:eA(l.type),doc:u,oldIndex:d,newIndex:h}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function eA(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ce()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(t){t=It(t,wt);const e=It(t.firestore,Ar);return UP(Io(e),t._key).then(r=>jb(e,t,r))}class Jf extends ZP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ci(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new wt(this.firestore,null,r)}}function Xt(t){t=It(t,nn);const e=It(t.firestore,Ar),r=Io(e),n=new Jf(e);return _b(t._query),BP(r,t._query).then(s=>new Eb(e,n,t,s))}function tA(t,e,r){t=It(t,wt);const n=It(t.firestore,Ar),s=Yf(t.converter,e,r);return Ro(n,[$f(Po(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Tt.none())])}function Bi(t,e,r,...n){t=It(t,wt);const s=It(t.firestore,Ar),i=Po(s);let o;return o=typeof(e=Ae(e))=="string"||e instanceof ko?gb(i,"updateDoc",t._key,e,r,n):pb(i,"updateDoc",t._key,e),Ro(s,[o.toMutation(t._key,Tt.exists(!0))])}function Eu(t){return Ro(It(t.firestore,Ar),[new fu(t._key,Tt.none())])}function Zf(t,e){const r=It(t.firestore,Ar),n=et(t),s=Yf(t.converter,e);return Ro(r,[$f(Po(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Tt.exists(!1))]).then(()=>n)}function rA(t,...e){var r,n,s;t=Ae(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Dx(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Dx(e[o])){const f=e[o];e[o]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[o+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let u,d,h;if(t instanceof wt)d=It(t.firestore,Ar),h=cu(t._key.path),u={next:f=>{e[o]&&e[o](jb(d,t,f))},error:e[o+1],complete:e[o+2]};else{const f=It(t,nn);d=It(f.firestore,Ar),h=f._query;const p=new Jf(d);u={next:b=>{e[o]&&e[o](new Eb(d,p,f,b))},error:e[o+1],complete:e[o+2]},_b(t._query)}return function(p,b,_,k){const P=new Vf(k),N=new Lf(b,P,_);return p.asyncQueue.enqueueAndForget(async()=>Af(await Lc(p),N)),()=>{P.Za(),p.asyncQueue.enqueueAndForget(async()=>Rf(await Lc(p),N))}}(Io(d),h,l,u)}function Ro(t,e){return function(n,s){const i=new Wr;return n.asyncQueue.enqueueAndForget(async()=>IP(await FP(n),s,i)),i.promise}(Io(t),e)}function jb(t,e,r){const n=r.docs.get(e._key),s=new Jf(t);return new Nb(t,s,e._key,n,new wa(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Po(e)}set(e,r,n){this._verifyNotCommitted();const s=Pd(e,this._firestore),i=Yf(s.converter,r,n),o=$f(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,Tt.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=Pd(e,this._firestore);let o;return o=typeof(r=Ae(r))=="string"||r instanceof ko?gb(this._dataReader,"WriteBatch.update",i._key,r,n,s):pb(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,Tt.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Pd(e,this._firestore);return this._mutations=this._mutations.concat(new fu(r._key,Tt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new re(G.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Pd(t,e){if((t=Ae(t)).firestore!==e)throw new re(G.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(t){return Io(t=It(t,Ar)),new nA(t,e=>Ro(t,e))}(function(e,r=!0){(function(s){Vi=s})(Ss),xs(new Fn("firestore",(n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),l=new Ar(new lk(n.getProvider("auth-internal")),new hk(n.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new re(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oo(d.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:r},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),jr(Y0,"4.7.3",e),jr(Y0,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb="firebasestorage.googleapis.com",Sb="storageBucket",iA=2*60*1e3,aA=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze extends Rr{constructor(e,r,n=0){super(Ad(e),`Firebase Storage: ${r} (${Ad(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ze.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ad(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var $e;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})($e||($e={}));function Ad(t){return"storage/"+t}function ep(){const t="An unknown error occurred, please check the error payload for server response.";return new ze($e.UNKNOWN,t)}function oA(t){return new ze($e.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function lA(t){return new ze($e.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function cA(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ze($e.UNAUTHENTICATED,t)}function uA(){return new ze($e.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function dA(t){return new ze($e.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function hA(){return new ze($e.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function mA(){return new ze($e.CANCELED,"User canceled the upload/download.")}function fA(t){return new ze($e.INVALID_URL,"Invalid URL '"+t+"'.")}function pA(t){return new ze($e.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function gA(){return new ze($e.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Sb+"' property when initializing the app?")}function xA(){return new ze($e.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function yA(){return new ze($e.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function vA(t){return new ze($e.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function tm(t){return new ze($e.INVALID_ARGUMENT,t)}function Tb(){return new ze($e.APP_DELETED,"The Firebase app was deleted.")}function wA(t){return new ze($e.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Oa(t,e){return new ze($e.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ua(t){throw new ze($e.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Gt.makeFromUrl(e,r)}catch{return new Gt(e,"")}if(n.path==="")return n;throw pA(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),u={bucket:1,path:3};function d(R){R.path_=decodeURIComponent(R.path)}const h="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",b=new RegExp(`^https?://${f}/${h}/b/${s}/o${p}`,"i"),_={bucket:1,path:3},k=r===Cb?"(?:storage.googleapis.com|storage.cloud.google.com)":r,P="([^?#]*)",N=new RegExp(`^https?://${k}/${s}/${P}`,"i"),S=[{regex:l,indices:u,postModify:i},{regex:b,indices:_,postModify:d},{regex:N,indices:{bucket:1,path:2},postModify:d}];for(let R=0;R<S.length;R++){const M=S[R],$=M.regex.exec(e);if($){const E=$[M.indices.bucket];let x=$[M.indices.path];x||(x=""),n=new Gt(E,x),M.postModify(n);break}}if(n==null)throw fA(e);return n}}class _A{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(t,e,r){let n=1,s=null,i=null,o=!1,l=0;function u(){return l===2}let d=!1;function h(...P){d||(d=!0,e.apply(null,P))}function f(P){s=setTimeout(()=>{s=null,t(b,u())},P)}function p(){i&&clearTimeout(i)}function b(P,...N){if(d){p();return}if(P){p(),h.call(null,P,...N);return}if(u()||o){p(),h.call(null,P,...N);return}n<64&&(n*=2);let S;l===1?(l=2,S=0):S=(n+Math.random())*1e3,f(S)}let _=!1;function k(P){_||(_=!0,p(),!d&&(s!==null?(P||(l=2),clearTimeout(s),f(0)):P||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,k(!0)},r),k}function NA(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EA(t){return t!==void 0}function jA(t){return typeof t=="object"&&!Array.isArray(t)}function tp(t){return typeof t=="string"||t instanceof String}function Vx(t){return rp()&&t instanceof Blob}function rp(){return typeof Blob<"u"}function Mx(t,e,r,n){if(n<e)throw tm(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw tm(`Invalid value for '${t}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function np(t,e,r){let n=e;return r==null&&(n=`https://${e}`),`${r}://${n}/v0${t}`}function Ib(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var ds;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ds||(ds={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,r,n,s,i,o,l,u,d,h,f,p=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=f,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,_)=>{this.resolve_=b,this.reject_=_,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new _l(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===ds.NO_ERROR,u=i.getStatus();if(!l||CA(u,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===ds.ABORT;n(!1,new _l(!1,null,h));return}const d=this.successCodes_.indexOf(u)!==-1;n(!0,new _l(d,i))})},r=(n,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());EA(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=ep();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(s.canceled){const u=this.appDelete_?Tb():mA();o(u)}else{const u=hA();o(u)}};this.canceled_?r(!1,new _l(!1,null,!0)):this.backoffId_=bA(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&NA(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class _l{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function TA(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function IA(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function kA(t,e){e&&(t["X-Firebase-GMPID"]=e)}function PA(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function AA(t,e,r,n,s,i,o=!0){const l=Ib(t.urlParams),u=t.url+l,d=Object.assign({},t.headers);return kA(d,e),TA(d,r),IA(d,i),PA(d,n),new SA(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function DA(...t){const e=RA();if(e!==void 0){const r=new e;for(let n=0;n<t.length;n++)r.append(t[n]);return r.getBlob()}else{if(rp())return new Blob(t);throw new ze($e.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function LA(t,e,r){return t.webkitSlice?t.webkitSlice(e,r):t.mozSlice?t.mozSlice(e,r):t.slice?t.slice(e,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(t){if(typeof atob>"u")throw vA("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Rd{constructor(e,r){this.data=e,this.contentType=r||null}}function VA(t,e){switch(t){case br.RAW:return new Rd(kb(e));case br.BASE64:case br.BASE64URL:return new Rd(Pb(t,e));case br.DATA_URL:return new Rd(FA(e),UA(e))}throw ep()}function kb(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<t.length-1&&(t.charCodeAt(r+1)&64512)===56320))e.push(239,191,189);else{const i=n,o=t.charCodeAt(++r);n=65536|(i&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function MA(t){let e;try{e=decodeURIComponent(t)}catch{throw Oa(br.DATA_URL,"Malformed data URL.")}return kb(e)}function Pb(t,e){switch(t){case br.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Oa(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case br.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Oa(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=OA(e)}catch(s){throw s.message.includes("polyfill")?s:Oa(t,"Invalid character found")}const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}class Ab{constructor(e){this.base64=!1,this.contentType=null;const r=e.match(/^data:([^,]+)?,/);if(r===null)throw Oa(br.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=BA(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function FA(t){const e=new Ab(t);return e.base64?Pb(br.BASE64,e.rest):MA(e.rest)}function UA(t){return new Ab(t).contentType}function BA(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,r){let n=0,s="";Vx(e)?(this.data_=e,n=e.size,s=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,r){if(Vx(this.data_)){const n=this.data_,s=LA(n,e,r);return s===null?null:new vn(s)}else{const n=new Uint8Array(this.data_.buffer,e,r-e);return new vn(n,!0)}}static getBlob(...e){if(rp()){const r=e.map(n=>n instanceof vn?n.data_:n);return new vn(DA.apply(null,r))}else{const r=e.map(o=>tp(o)?VA(br.RAW,o).data:o.data_);let n=0;r.forEach(o=>{n+=o.byteLength});const s=new Uint8Array(n);let i=0;return r.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new vn(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rb(t){let e;try{e=JSON.parse(t)}catch{return null}return jA(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function zA(t,e){const r=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?r:t+"/"+r}function Db(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qA(t,e){return e}class jt{constructor(e,r,n,s){this.server=e,this.local=r||e,this.writable=!!n,this.xform=s||qA}}let bl=null;function WA(t){return!tp(t)||t.length<2?t:Db(t)}function Lb(){if(bl)return bl;const t=[];t.push(new jt("bucket")),t.push(new jt("generation")),t.push(new jt("metageneration")),t.push(new jt("name","fullPath",!0));function e(i,o){return WA(o)}const r=new jt("name");r.xform=e,t.push(r);function n(i,o){return o!==void 0?Number(o):o}const s=new jt("size");return s.xform=n,t.push(s),t.push(new jt("timeCreated")),t.push(new jt("updated")),t.push(new jt("md5Hash",null,!0)),t.push(new jt("cacheControl",null,!0)),t.push(new jt("contentDisposition",null,!0)),t.push(new jt("contentEncoding",null,!0)),t.push(new jt("contentLanguage",null,!0)),t.push(new jt("contentType",null,!0)),t.push(new jt("metadata","customMetadata",!0)),bl=t,bl}function HA(t,e){function r(){const n=t.bucket,s=t.fullPath,i=new Gt(n,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:r})}function GA(t,e,r){const n={};n.type="file";const s=r.length;for(let i=0;i<s;i++){const o=r[i];n[o.local]=o.xform(n,e[o.server])}return HA(n,t),n}function Ob(t,e,r){const n=Rb(e);return n===null?null:GA(t,n,r)}function KA(t,e,r,n){const s=Rb(e);if(s===null||!tp(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,f=t.fullPath,p="/b/"+o(h)+"/o/"+o(f),b=np(p,r,n),_=Ib({alt:"media",token:d});return b+_})[0]}function QA(t,e){const r={},n=e.length;for(let s=0;s<n;s++){const i=e[s];i.writable&&(r[i.server]=t[i.local])}return JSON.stringify(r)}class Vb{constructor(e,r,n,s){this.url=e,this.method=r,this.handler=n,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mb(t){if(!t)throw ep()}function XA(t,e){function r(n,s){const i=Ob(t,s,e);return Mb(i!==null),i}return r}function YA(t,e){function r(n,s){const i=Ob(t,s,e);return Mb(i!==null),KA(i,s,t.host,t._protocol)}return r}function Fb(t){function e(r,n){let s;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?s=uA():s=cA():r.getStatus()===402?s=lA(t.bucket):r.getStatus()===403?s=dA(t.path):s=n,s.status=r.getStatus(),s.serverResponse=n.serverResponse,s}return e}function JA(t){const e=Fb(t);function r(n,s){let i=e(n,s);return n.getStatus()===404&&(i=oA(t.path)),i.serverResponse=s.serverResponse,i}return r}function ZA(t,e,r){const n=e.fullServerUrl(),s=np(n,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new Vb(s,i,YA(t,r),o);return l.errorHandler=JA(e),l}function eR(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function tR(t,e,r){const n=Object.assign({},r);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=eR(null,e)),n}function rR(t,e,r,n,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let S="";for(let R=0;R<2;R++)S=S+Math.random().toString().slice(2);return S}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const d=tR(e,n,s),h=QA(d,r),f="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+u+`\r
Content-Type: `+d.contentType+`\r
\r
`,p=`\r
--`+u+"--",b=vn.getBlob(f,n,p);if(b===null)throw xA();const _={name:d.fullPath},k=np(i,t.host,t._protocol),P="POST",N=t.maxUploadRetryTime,w=new Vb(k,P,XA(t,r),N);return w.urlParams=_,w.headers=o,w.body=b.uploadData(),w.errorHandler=Fb(e),w}class nR{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ds.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ds.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ds.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,s){if(this.sent_)throw ua("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ua("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ua("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ua("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ua("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class sR extends nR{initXhr(){this.xhr_.responseType="text"}}function Ub(){return new sR}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,r){this._service=e,r instanceof Gt?this._location=r:this._location=Gt.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Ns(e,r)}get root(){const e=new Gt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Db(this._location.path)}get storage(){return this._service}get parent(){const e=$A(this._location.path);if(e===null)return null;const r=new Gt(this._location.bucket,e);return new Ns(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw wA(e)}}function iR(t,e,r){t._throwIfRoot("uploadBytes");const n=rR(t.storage,t._location,Lb(),new vn(e,!0),r);return t.storage.makeRequestWithTokens(n,Ub).then(s=>({metadata:s,ref:t}))}function aR(t){t._throwIfRoot("getDownloadURL");const e=ZA(t.storage,t._location,Lb());return t.storage.makeRequestWithTokens(e,Ub).then(r=>{if(r===null)throw yA();return r})}function oR(t,e){const r=zA(t._location.path,e),n=new Gt(t._location.bucket,r);return new Ns(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(t){return/^[A-Za-z]+:\/\//.test(t)}function cR(t,e){return new Ns(t,e)}function Bb(t,e){if(t instanceof sp){const r=t;if(r._bucket==null)throw gA();const n=new Ns(r,r._bucket);return e!=null?Bb(n,e):n}else return e!==void 0?oR(t,e):t}function uR(t,e){if(e&&lR(e)){if(t instanceof sp)return cR(t,e);throw tm("To use ref(service, url), the first argument must be a Storage instance.")}else return Bb(t,e)}function Fx(t,e){const r=e==null?void 0:e[Sb];return r==null?null:Gt.makeFromBucketSpec(r,t)}function dR(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:_w(s,t.app.options.projectId))}class sp{constructor(e,r,n,s,i){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=Cb,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=iA,this._maxUploadRetryTime=aA,this._requests=new Set,s!=null?this._bucket=Gt.makeFromBucketSpec(s,this._host):this._bucket=Fx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Gt.makeFromBucketSpec(this._url,e):this._bucket=Fx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Mx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Mx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ns(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new _A(Tb());{const o=AA(e,this._appId,n,s,r,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const Ux="@firebase/storage",Bx="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b="storage";function hR(t,e,r){return t=Ae(t),iR(t,e,r)}function mR(t){return t=Ae(t),aR(t)}function fR(t,e){return t=Ae(t),uR(t,e)}function pR(t=tf(),e){t=Ae(t);const n=nu(t,$b).getImmediate({identifier:e}),s=yw("storage");return s&&gR(n,...s),n}function gR(t,e,r,n={}){dR(t,e,r,n)}function xR(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new sp(r,n,s,e,Ss)}function yR(){xs(new Fn($b,xR,"PUBLIC").setMultipleInstances(!0)),jr(Ux,Bx,""),jr(Ux,Bx,"esm2017")}yR();const vR={apiKey:"AIzaSyAMbdKhLxdzaigZW95MC9G0hPGR4r-b5d0",authDomain:"rosema-pos.firebaseapp.com",projectId:"rosema-pos",storageBucket:"rosema-pos.firebasestorage.app",messagingSenderId:"1097595627472",appId:"1:1097595627472:web:18e4f622b01b4ec8643bd5",measurementId:"G-D7RDWF848P"};let ju;try{ju=Ew(vR),console.log("Firebase inicializado correctamente para Rosema POS")}catch(t){throw console.error("Error al inicializar Firebase:",t),new Error("No se pudo conectar con Firebase. Verifique la configuración.")}const Dd=rk(ju),xe=WP(ju),wR=pR(ju),Cu=()=>{const[t,e]=T.useState(null),[r,n]=T.useState(!0),[s,i]=T.useState(null);T.useEffect(()=>{const d=q1(Dd,h=>{e(h),n(!1)});return()=>d()},[]);const o=async(d,h)=>{try{return i(null),n(!0),(await B1(Dd,d,h)).user}catch(f){throw console.error("Error en login:",f),i(u(f.code)),f}finally{n(!1)}},l=async()=>{try{i(null),await W1(Dd)}catch(d){throw console.error("Error en logout:",d),i("Error al cerrar sesión"),d}},u=d=>{switch(d){case"auth/user-not-found":return"Usuario no encontrado";case"auth/wrong-password":return"Contraseña incorrecta";case"auth/invalid-email":return"Email inválido";case"auth/user-disabled":return"Usuario deshabilitado";case"auth/too-many-requests":return"Demasiados intentos. Intente más tarde";default:return"Error de autenticación. Verifique sus credenciales"}};return{user:t,loading:r,error:s,login:o,logout:l,isAuthenticated:!!t}},_R=()=>{var i;const{user:t,logout:e}=Cu(),r=Cs(),n=async()=>{try{await e()}catch(o){console.error("Error al cerrar sesión:",o)}},s=[{name:"Inicio",path:"/",icon:"🏠"},{name:"Estadísticas",path:"/statistics",icon:"📊"},{name:"Ventas",path:"/sales",icon:"💰"},{name:"Productos",path:"/products",icon:"👕"},{name:"Clientes",path:"/customers",icon:"👥"},{name:"Proveedores",path:"/suppliers",icon:"🏪"},{name:"Metas",path:"/goals",icon:"🎯"},{name:"Facturas ARCA",path:"/invoices",icon:"📄"}];return a.jsxs("div",{className:"w-64 bg-red-600 text-white flex flex-col h-full shadow-lg",style:{backgroundColor:"#D62818"},children:[a.jsx("div",{className:"p-6 border-b border-red-700",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"h-12 w-12 bg-white rounded-lg flex items-center justify-center mr-3",children:a.jsx("span",{className:"text-red-600 text-xl font-bold",children:"R"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold",children:"Rosema POS"}),a.jsx("p",{className:"text-red-200 text-sm",children:"Sistema de Ventas"})]})]})}),a.jsx("div",{className:"p-4 border-b border-red-700",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"h-8 w-8 bg-red-700 rounded-full flex items-center justify-center mr-3",children:a.jsx("span",{className:"text-white text-sm font-medium",children:((i=t==null?void 0:t.email)==null?void 0:i.charAt(0).toUpperCase())||"U"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-white truncate",children:(t==null?void 0:t.email)||"Usuario"}),a.jsx("p",{className:"text-xs text-red-200",children:"Administrador"})]})]})}),a.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2 overflow-y-auto",children:s.map(o=>{const l=r.pathname===o.path;return a.jsxs(dS,{to:o.path,className:`
                flex items-center px-4 py-3 rounded-lg transition-all duration-200 group
                ${l?"bg-white text-red-600 shadow-md":"text-red-100 hover:bg-red-700 hover:text-white"}
              `,children:[a.jsx("span",{className:"text-lg mr-3",children:o.icon}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:`font-medium ${l?"text-red-600":"text-white"}`,children:o.name}),a.jsx("div",{className:`text-xs ${l?"text-red-500":"text-red-200"} group-hover:text-red-100`,children:o.description})]})]},o.path)})}),a.jsx("div",{className:"p-4 border-t border-red-700",children:a.jsx("div",{className:"space-y-3",children:a.jsxs("button",{onClick:n,className:"w-full flex items-center justify-center px-4 py-2 bg-red-700 hover:bg-red-800 rounded-lg transition-colors duration-200",children:[a.jsx("span",{className:"text-sm mr-2",children:"🚪"}),a.jsx("span",{className:"text-sm font-medium",children:"Cerrar Sesión"})]})})})]})},bR=()=>a.jsxs("div",{className:"flex h-screen bg-gray-50",children:[a.jsx(_R,{}),a.jsx("div",{className:"flex-1 flex flex-col overflow-hidden",children:a.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto",children:a.jsx(JC,{})})})]}),NR=()=>{const[t,e]=T.useState(""),[r,n]=T.useState(""),[s,i]=T.useState(!1),{login:o,error:l,isAuthenticated:u,loading:d}=Cu();if(u)return a.jsx(Ol,{to:"/",replace:!0});if(d)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando..."})]})});const h=async f=>{if(f.preventDefault(),!(!t||!r)){i(!0);try{await o(t,r)}catch(p){console.error("Error en login:",p)}finally{i(!1)}}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mx-auto h-16 w-16 bg-red-600 rounded-full flex items-center justify-center mb-4",children:a.jsx("span",{className:"text-white text-2xl font-bold",children:"R"})}),a.jsx("h2",{className:"text-3xl font-extrabold text-gray-900",children:"Rosema POS"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Sistema de Punto de Venta"})]}),a.jsxs("form",{className:"mt-8 space-y-6",onSubmit:h,children:[a.jsx("div",{className:"card-rosema",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"input-rosema",placeholder:"Ingrese su email",value:t,onChange:f=>e(f.target.value),disabled:s})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña"}),a.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"input-rosema",placeholder:"Ingrese su contraseña",value:r,onChange:f=>n(f.target.value),disabled:s})]}),l&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:a.jsx("p",{className:"text-sm",children:l})}),a.jsx("button",{type:"submit",disabled:s||!t||!r,className:"btn-rosema w-full flex justify-center items-center disabled:opacity-50 disabled:cursor-not-allowed",children:s?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Iniciando sesión..."]}):"Iniciar Sesión"})]})}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Sistema POS para Tienda Rosema"}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Salto de las Rosas - WhatsApp: 260 438-1502"})]})]})]})})},mr="articulos",zb=async()=>{try{console.log("🔍 Intentando obtener productos de la colección:",mr);const t=await Xt(ut(xe,mr));console.log("📊 Documentos encontrados:",t.size);const e=t.docs.map(r=>{const n=r.data();console.log("📄 Documento encontrado:",r.id,n);const s=Array.isArray(n.variantes)?n.variantes.reduce((i,o)=>i+(o.stock||0),0):0;return{id:r.id,...n,name:n.articulo||"Sin nombre",variantes:n.variantes||[],stock:s}});return console.log("✅ Productos procesados:",e.length),e}catch(t){console.error("❌ Error al obtener productos:",t),console.error("Error details:",t.message);try{const e=await Xt(ut(xe,mr));if(e.size>0){const r=e.docs[0];console.log("🔍 Estructura del primer documento:",r.data())}}catch(e){console.error("❌ Error en debug query:",e)}throw new Error("No se pudieron cargar los productos: "+t.message)}},ER=async t=>{try{if(!t.trim())return[];const e=t.toLowerCase().trim(),r=await zb(),n=[],s=[],i=[],o=[],l=[],u=[];return r.forEach(h=>{var P,N;const f=((P=h.id)==null?void 0:P.toLowerCase())||"",p=((N=h.articulo)==null?void 0:N.toLowerCase())||"",b=Array.isArray(h.tags)?h.tags.map(w=>w.toLowerCase()).join(" "):"",_=h.proveedorId?h.proveedorId.toString().toLowerCase():"",k=h.variantes&&Array.isArray(h.variantes)?h.variantes.some(w=>w.talle&&w.talle.toLowerCase().includes(e)):!1;f===e?n.push(h):f.includes(e)?s.push(h):p.includes(e)?i.push(h):b.includes(e)?o.push(h):_.includes(e)?l.push(h):k&&u.push(h)}),[...n,...s,...i,...o,...l,...u].slice(0,10)}catch(e){throw console.error("Error al buscar productos:",e),new Error("Error en la búsqueda de productos")}},jR=async t=>{const e=et(xe,articulos,t),r=await Kn(e);return r.exists()?{id:r.id,...r.data()}:null},qb=async(t,e=null)=>{try{const r=Ot(ut(xe,mr),kr("id","==",t)),n=await Xt(r);return e?n.docs.some(s=>s.id!==e):n.size>0}catch(r){return console.error("Error al verificar código:",r),!1}},Wb=async t=>{try{if(await qb(t.id))throw new Error("Ya existe un producto con este código de barras");const r={...t,searchName:(t.articulo||"").toLowerCase(),createdAt:new Date,updatedAt:new Date},n=et(xe,mr,t.id);return await tA(n,r),{id:t.id,...r}}catch(e){throw console.error("Error al crear producto:",e),new Error(e.message||"No se pudo crear el producto")}},CR=async(t,e)=>{try{const r=et(xe,mr,t),n={...e,searchName:e.name?e.name.toLowerCase():void 0,updatedAt:new Date};return Object.keys(n).forEach(s=>{n[s]===void 0&&delete n[s]}),await Bi(r,n),{id:t,...n}}catch(r){throw console.error("Error al actualizar producto:",r),new Error("No se pudo actualizar el producto")}},SR=async t=>{try{return await Eu(et(xe,mr,t)),t}catch(e){throw console.error("Error al eliminar producto:",e),new Error("No se pudo eliminar el producto")}},TR=async(t,e)=>{try{const r=et(xe,mr,t);return await Bi(r,{stock:e,updatedAt:new Date}),e}catch(r){throw console.error("Error al actualizar stock:",r),new Error("No se pudo actualizar el stock")}},IR=async()=>{try{const t=[{name:"Remera Básica Mujer",code:"RBM001",purchasePrice:1500,salePrice:3e3,profitMargin:100,category:"mujer",tags:["básico","remera","algodón"],stock:25,sizes:["XS","S","M","L","XL"],colors:["#FF0000","#000000","#FFFFFF","#0000FF"],supplier:"Proveedor Ejemplo"},{name:"Jean Clásico Hombre",code:"JCH002",purchasePrice:2500,salePrice:5e3,profitMargin:100,category:"hombre",tags:["jean","clásico","denim"],stock:15,sizes:["28","30","32","34","36","38"],colors:["#1E3A8A","#000000"],supplier:"Proveedor Ejemplo"},{name:"Vestido Fiesta",code:"VF003",purchasePrice:3e3,salePrice:7500,profitMargin:150,category:"mujer",tags:["vestido","fiesta","elegante"],stock:8,sizes:["S","M","L"],colors:["#000000","#FF0000","#800080"],supplier:"Proveedor Ejemplo"},{name:"Campera Niños",code:"CN004",purchasePrice:2e3,salePrice:4e3,profitMargin:100,category:"niños",tags:["campera","abrigo","invierno"],stock:12,sizes:["2","4","6","8","10","12"],colors:["#FF0000","#0000FF","#008000"],supplier:"Proveedor Ejemplo"},{name:"Zapatillas Deportivas",code:"ZD005",purchasePrice:4e3,salePrice:8e3,profitMargin:100,category:"otros",tags:["zapatillas","deporte","running"],stock:20,sizes:["35","36","37","38","39","40","41","42"],colors:["#FFFFFF","#000000","#FF0000"],supplier:"Proveedor Ejemplo"}],e=[];for(const r of t){const n=await Wb(r);e.push(n)}return e}catch(t){throw console.error("Error al crear productos de ejemplo:",t),new Error("No se pudieron crear los productos de ejemplo")}},kR=t=>{const e=ut(xe,mr);return rA(e,r=>{const n=r.docs.map(s=>{const i=s.data(),o=Array.isArray(i.variantes)?i.variantes.reduce((l,u)=>l+(u.stock||0),0):0;return{id:s.id,...i,name:i.articulo||"Sin nombre",variantes:i.variantes||[],stock:o}});t(n)},r=>{console.error("Error en suscripción a productos:",r)})},PR=async(t,e,r)=>{try{const n=et(xe,mr,t),s=await Kn(n);if(!s.exists())throw new Error("Producto no encontrado");const l=(s.data().variantes||[]).map(u=>{if(u.talle===e.talle&&u.color===e.color){if(u.stock<r)throw new Error(`Stock insuficiente. Disponible: ${u.stock}, Solicitado: ${r}`);return{...u,stock:u.stock-r}}return u});return await Bi(n,{variantes:l,updatedAt:new Date}),console.log(`✅ Stock descontado para producto ${t}:`,e),l}catch(n){throw console.error("Error actualizando stock de variante:",n),n}},AR=async(t,e,r)=>{try{const n=et(xe,mr,t),s=await Kn(n);if(!s.exists())throw new Error("Producto no encontrado");const l=(s.data().variantes||[]).map(u=>u.talle===e.talle&&u.color===e.color?{...u,stock:u.stock+r}:u);return await Bi(n,{variantes:l,updatedAt:new Date}),console.log(`✅ Stock incrementado para producto ${t}:`,e),l}catch(n){throw console.error("Error incrementando stock de variante:",n),n}},Su=()=>{const[t,e]=T.useState([]),[r,n]=T.useState(!1),[s,i]=T.useState(null),[o,l]=T.useState([]),[u,d]=T.useState([]),h=T.useCallback(async()=>{n(!0),i(null);try{const I=await zb();return e(I),I}catch(I){return i(I.message),console.error("Error al cargar productos:",I),[]}finally{n(!1)}},[]),f=T.useCallback(async I=>{if(!I.trim())return l([]),e([]),[];n(!0),i(null);try{const j=await ER(I);return l(j),e(j),j}catch(j){return i(j.message),console.error("Error al buscar productos:",j),[]}finally{n(!1)}},[]),p=T.useCallback(async I=>{n(!0),i(null);try{return await jR(I)}catch(j){return i(j.message),console.error("Error al obtener producto:",j),null}finally{n(!1)}},[]),b=T.useCallback(async I=>{n(!0),i(null);try{const j=await Wb(I);return e(te=>[j,...te]),j}catch(j){throw i(j.message),console.error("Error al crear producto:",j),j}finally{n(!1)}},[]),_=T.useCallback(async(I,j)=>{n(!0),i(null);try{const te=await CR(I,j);return e(B=>B.map(V=>V.id===I?{...V,...te}:V)),te}catch(te){throw i(te.message),console.error("Error al actualizar producto:",te),te}finally{n(!1)}},[]),k=T.useCallback(async I=>{n(!0),i(null);try{return await SR(I),e(j=>j.filter(te=>te.id!==I)),I}catch(j){throw i(j.message),console.error("Error al eliminar producto:",j),j}finally{n(!1)}},[]),P=T.useCallback(async(I,j)=>{i(null);try{return await TR(I,j),e(te=>te.map(B=>B.id===I?{...B,stock:j}:B)),j}catch(te){throw i(te.message),console.error("Error al actualizar stock:",te),te}},[]),N=T.useCallback(async()=>{n(!0),i(null);try{const I=await IR();return e(j=>[...I,...j]),I}catch(I){throw i(I.message),console.error("Error al crear productos de ejemplo:",I),I}finally{n(!1)}},[]),w=T.useCallback(()=>{l([]),e([]),i(null)},[]),S=T.useCallback(async()=>{try{return await R()}catch(I){return console.error("Error al obtener estadísticas:",I),{totalProducts:t.length,totalStock:t.reduce((j,te)=>j+(te.stock||0),0),lowStockProducts:t.filter(j=>(j.stock||0)<=5).length,outOfStockProducts:t.filter(j=>(j.stock||0)===0).length,categories:{}}}},[t]),R=T.useCallback(()=>({totalProducts:t.length,totalStock:t.reduce((I,j)=>I+(j.stock||0),0),lowStockProducts:t.filter(I=>(I.stock||0)<=5).length,outOfStockProducts:t.filter(I=>(I.stock||0)===0).length,categories:t.reduce((I,j)=>{const te=j.category||"otros";return I[te]=(I[te]||0)+1,I},{})}),[t]),M=T.useCallback(I=>I==="all"?t:t.filter(j=>j.category===I),[t]),$=T.useCallback((I=5)=>t.filter(j=>(j.stock||0)<=I),[t]),E=T.useCallback(()=>t.filter(I=>(I.stock||0)===0),[t]),x=T.useCallback(async I=>{n(!0),i(null);try{return await x(I)}catch(j){return i(j.message),console.error("Error al buscar producto por código:",j),null}finally{n(!1)}},[]),v=T.useCallback(async(I,j,te)=>{i(null);try{const B=await PR(I,j,te);return e(V=>V.map(L=>{if(L.id===I){const O=B.reduce((H,q)=>H+(q.stock||0),0);return{...L,variantes:B,stock:O}}return L})),B}catch(B){throw i(B.message),console.error("Error al actualizar stock de variante:",B),B}},[]),y=T.useCallback(async(I,j,te)=>{i(null);try{const B=await AR(I,j,te);return e(V=>V.map(L=>{if(L.id===I){const O=B.reduce((H,q)=>H+(q.stock||0),0);return{...L,variantes:B,stock:O}}return L})),B}catch(B){throw i(B.message),console.error("Error al incrementar stock de variante:",B),B}},[]),D=T.useCallback(async(I,j=null)=>{try{return await qb(I,j)}catch(te){return console.error("Error al validar código:",te),!1}},[]);return T.useEffect(()=>{console.log("🔄 Iniciando suscripción en tiempo real a productos...");const I=kR(j=>{if(console.log("📡 Productos actualizados en tiempo real:",j.length),d(j),o.length>0){const te=o.map(B=>j.find(V=>V.id===B.id)||B).filter(Boolean);l(te)}j.length>0&&e(j)});return()=>{console.log("🔌 Desconectando suscripción de productos..."),I()}},[o]),{products:t,loading:r,error:s,searchResults:o,realtimeProducts:u,loadProducts:h,searchProductsByTerm:f,getProduct:p,getProductByBarcode:x,addProduct:b,updateProductData:_,removeProduct:k,updateStock:P,updateVariantStockData:v,incrementVariantStockData:y,clearSearch:w,createSampleData:N,getProductStats:R,getProductStatistics:S,filterByCategory:M,getLowStockProducts:$,getOutOfStockProducts:E,validateProductCode:D}},Si="proveedores",sn=async()=>{try{console.log("🔍 Obteniendo proveedores de la colección:",Si);const t=await Xt(ut(xe,Si));console.log("📊 Proveedores encontrados:",t.size);const e=t.docs.map(r=>{const n=r.data();return{id:r.id,...n,proveedor:n.proveedor||n.name||n.nombre||"Sin nombre",locales:n.locales||[{direccion:"",area:"",galeria:"",pasillo:"",local:""}],tags:n.tags||[],talles:n.talles||[]}});return console.log("✅ Proveedores procesados:",e.length),e}catch(t){throw console.error("❌ Error al obtener proveedores:",t),new Error("No se pudieron cargar los proveedores: "+t.message)}},RR=async t=>{try{const e=et(xe,Si,t),r=await Kn(e);if(r.exists()){const n=r.data();return{id:r.id,...n,proveedor:n.proveedor||"Sin nombre",locales:n.locales||[{direccion:"",area:"",galeria:"",pasillo:"",local:""}],tags:n.tags||[],talles:n.talles||[]}}else throw new Error("Proveedor no encontrado")}catch(e){throw console.error("Error al obtener proveedor:",e),e}},DR=async t=>{try{if(!t.proveedor||!t.proveedor.trim())throw new Error("El nombre del proveedor es requerido");const e={proveedor:t.proveedor.trim(),cuit:t.cuit||null,whattsapp:t.whattsapp||null,whattsapp2:t.whattsapp2||null,catalogo:t.catalogo||null,web:t.web||null,categoria:t.categoria||null,locales:t.locales&&t.locales.length>0?t.locales:[{direccion:"",area:"",galeria:"",pasillo:"",local:""}],tags:t.tags||[],instagram:t.instagram||null,tiktok:t.tiktok||null,calidad:t.calidad||null,precios:t.precios||null,notas:t.notas||null,talles:t.talles||[],createdAt:new Date,updatedAt:new Date};return{id:(await Zf(ut(xe,Si),e)).id,...e}}catch(e){throw console.error("Error al crear proveedor:",e),new Error("No se pudo crear el proveedor: "+e.message)}},LR=async(t,e)=>{try{const r=et(xe,Si,t);if(e.proveedor!==void 0&&(!e.proveedor||!e.proveedor.trim()))throw new Error("El nombre del proveedor es requerido");const n={...e,updatedAt:new Date};return Object.keys(n).forEach(s=>{n[s]===void 0&&delete n[s]}),await Bi(r,n),{id:t,...n}}catch(r){throw console.error("Error al actualizar proveedor:",r),new Error("No se pudo actualizar el proveedor: "+r.message)}},OR=async t=>{try{return await Eu(et(xe,Si,t)),t}catch(e){throw console.error("Error al eliminar proveedor:",e),new Error("No se pudo eliminar el proveedor: "+e.message)}},VR=async()=>{try{const t=await sn(),e={totalProviders:t.length,activeProviders:t.filter(r=>r.active!==!1).length,areas:{},categorias:{},tags:{},galerias:{}};return t.forEach(r=>{r.locales&&Array.isArray(r.locales)&&r.locales.forEach(n=>{n.area&&(e.areas[n.area]=(e.areas[n.area]||0)+1),n.galeria&&(e.galerias[n.galeria]=(e.galerias[n.galeria]||0)+1)}),r.categoria&&(e.categorias[r.categoria]=(e.categorias[r.categoria]||0)+1),r.tags&&Array.isArray(r.tags)&&r.tags.forEach(n=>{e.tags[n]=(e.tags[n]||0)+1})}),e}catch(t){throw console.error("Error al obtener estadísticas de proveedores:",t),new Error("No se pudieron obtener las estadísticas: "+t.message)}},MR=async t=>{try{if(!t.trim())return[];const e=await sn(),r=t.toLowerCase().trim();return e.filter(n=>n.proveedor&&n.proveedor.toLowerCase().includes(r)||n.tags&&Array.isArray(n.tags)&&n.tags.some(s=>s.toLowerCase().includes(r))||n.talles&&Array.isArray(n.talles)&&n.talles.some(s=>s.toLowerCase().includes(r))?!0:n.locales&&Array.isArray(n.locales)?n.locales.some(s=>s.direccion&&s.direccion.toLowerCase().includes(r)||s.area&&s.area.toLowerCase().includes(r)||s.galeria&&s.galeria.toLowerCase().includes(r)):!1)}catch(e){throw console.error("Error al buscar proveedores:",e),new Error("Error en la búsqueda de proveedores: "+e.message)}},FR=async t=>{try{return(await sn()).filter(r=>r.categoria===t)}catch(e){throw console.error("Error al filtrar por categoría:",e),new Error("Error al filtrar proveedores por categoría: "+e.message)}},UR=async t=>{try{return(await sn()).filter(r=>r.locales&&r.locales.some(n=>n.area===t))}catch(e){throw console.error("Error al filtrar por área:",e),new Error("Error al filtrar proveedores por área: "+e.message)}},BR=async t=>{try{return(await sn()).filter(r=>r.locales&&r.locales.some(n=>n.galeria===t))}catch(e){throw console.error("Error al filtrar por galería:",e),new Error("Error al filtrar proveedores por galería: "+e.message)}},$R=async t=>{try{console.log("🔍 Obteniendo estadísticas de productos para proveedor:",t);const e=parseInt(t),r=Ot(ut(xe,"articulos"),kr("proveedorId","==",e)),s=(await Xt(r)).docs.map(p=>({id:p.id,...p.data()}));console.log("📦 Productos encontrados para el proveedor:",s.length);const i=s.length,o=s.filter(p=>{var _;return(((_=p.variantes)==null?void 0:_.reduce((k,P)=>k+(P.stock||0),0))||0)>0}).length;let l=0,u=null,d=0;try{const p=Ot(ut(xe,"ventas"));(await Xt(p)).docs.forEach(_=>{const k=_.data();k.items&&Array.isArray(k.items)&&k.items.forEach(P=>{if(s.find(w=>w.id===P.productId)&&!P.isReturn&&!P.isQuickItem){l+=P.quantity||0,d+=P.price*P.quantity||0;const w=k.saleDate?k.saleDate.seconds?new Date(k.saleDate.seconds*1e3):new Date(k.saleDate):k.createdAt?new Date(k.createdAt.seconds*1e3):null;w&&(!u||w>u)&&(u=w)}})}),console.log(`💰 Total vendidos del proveedor ${t}: ${l} unidades, $${d.toLocaleString()}`)}catch(p){console.log("ℹ️ Error al acceder a ventas:",p.message)}const h=s.length>0?s.reduce((p,b)=>{const _=b.createdAt?b.createdAt.seconds?new Date(b.createdAt.seconds*1e3):new Date(b.createdAt):null;return!p||_&&_>p?_:p},null):null,f={totalComprados:i,totalVendidos:l,productosActivos:o,ingresosTotales:d,ultimaCompra:h,ultimaVenta:u,productos:s};return console.log("📊 Estadísticas calculadas para proveedor:",f),f}catch(e){return console.error("❌ Error al obtener estadísticas de productos del proveedor:",e),{totalComprados:0,totalVendidos:0,productosActivos:0,ingresosTotales:0,ultimaCompra:null,ultimaVenta:null,productos:[]}}},zR=async()=>{try{const t=await sn(),e=new Set;return t.forEach(r=>{r.categoria&&e.add(r.categoria)}),Array.from(e).sort()}catch(t){return console.error("Error al obtener categorías:",t),[]}},qR=async()=>{try{const t=await sn(),e=new Set;return t.forEach(r=>{r.locales&&Array.isArray(r.locales)&&r.locales.forEach(n=>{n.area&&e.add(n.area)})}),Array.from(e).sort()}catch(t){return console.error("Error al obtener áreas:",t),[]}},WR=async()=>{try{const t=await sn(),e=new Set;return t.forEach(r=>{r.locales&&Array.isArray(r.locales)&&r.locales.forEach(n=>{n.galeria&&e.add(n.galeria)})}),Array.from(e).sort()}catch(t){return console.error("Error al obtener galerías:",t),[]}},Do=()=>{const[t,e]=T.useState([]),[r,n]=T.useState(!1),[s,i]=T.useState(null),[o,l]=T.useState([]),[u,d]=T.useState([]),[h,f]=T.useState([]),[p,b]=T.useState([]),_=T.useCallback(async()=>{n(!0),i(null);try{const V=await sn();return e(V),V}catch(V){i(V.message||"Error al cargar proveedores"),console.error("Error loading providers:",V)}finally{n(!1)}},[]),k=T.useCallback(async()=>{try{const V=await zR();return d(V),V}catch(V){return console.error("Error loading categories:",V),[]}},[]),P=T.useCallback(async()=>{try{const V=await qR();return f(V),V}catch(V){return console.error("Error loading areas:",V),[]}},[]),N=T.useCallback(async()=>{try{const V=await WR();return b(V),V}catch(V){return console.error("Error loading galleries:",V),[]}},[]),w=T.useCallback(async V=>{if(!V.trim())return l([]),e([]),[];n(!0),i(null);try{const L=await MR(V);return l(L),e(L),L}catch(L){return i(L.message||"Error en la búsqueda"),console.error("Error searching providers:",L),[]}finally{n(!1)}},[]),S=T.useCallback(async V=>{n(!0),i(null);try{const L=await FR(V);return e(L),L}catch(L){return i(L.message||"Error al filtrar por categoría"),console.error("Error filtering by category:",L),[]}finally{n(!1)}},[]),R=T.useCallback(async V=>{n(!0),i(null);try{const L=await UR(V);return e(L),L}catch(L){return i(L.message||"Error al filtrar por área"),console.error("Error filtering by area:",L),[]}finally{n(!1)}},[]),M=T.useCallback(async V=>{n(!0),i(null);try{const L=await BR(V);return e(L),L}catch(L){return i(L.message||"Error al filtrar por galería"),console.error("Error filtering by gallery:",L),[]}finally{n(!1)}},[]),$=T.useCallback(async V=>{n(!0),i(null);try{return await RR(V)}catch(L){throw i(L.message||"Error al obtener proveedor"),console.error("Error getting provider:",L),L}finally{n(!1)}},[]),E=T.useCallback(async V=>{try{return await $R(V)}catch(L){return console.error("Error getting provider product stats:",L),{totalComprados:0,totalVendidos:0,productosActivos:0,ultimaCompra:null,ultimaVenta:null}}},[]),x=T.useCallback(async V=>{n(!0),i(null);try{const L=await DR(V);return e(O=>[L,...O]),k(),P(),N(),L}catch(L){throw i(L.message||"Error al crear proveedor"),console.error("Error adding provider:",L),L}finally{n(!1)}},[k,P,N]),v=T.useCallback(async(V,L)=>{n(!0),i(null);try{const O=await LR(V,L);return e(H=>H.map(q=>q.id===V?{...q,...O}:q)),(L.categoria||L.locales)&&(k(),P(),N()),O}catch(O){throw i(O.message||"Error al actualizar proveedor"),console.error("Error updating provider:",O),O}finally{n(!1)}},[k,P,N]),y=T.useCallback(async V=>{n(!0),i(null);try{return await OR(V),e(L=>L.filter(O=>O.id!==V)),k(),P(),N(),V}catch(L){throw i(L.message||"Error al eliminar proveedor"),console.error("Error removing provider:",L),L}finally{n(!1)}},[k,P,N]),D=T.useCallback(()=>{l([]),e([]),i(null)},[]),I=T.useCallback(async()=>{try{return await VR()}catch(V){return console.error("Error getting provider stats:",V),{totalProviders:t.length,activeProviders:t.filter(L=>L.active!==!1).length,areas:{},categorias:{},tags:{},galerias:{}}}},[t]),j=T.useCallback(()=>{const V={totalProviders:t.length,activeProviders:t.filter(L=>L.active!==!1).length,areas:{},categorias:{},tags:{},galerias:{}};return t.forEach(L=>{L.locales&&Array.isArray(L.locales)&&L.locales.forEach(O=>{O.area&&(V.areas[O.area]=(V.areas[O.area]||0)+1),O.galeria&&(V.galerias[O.galeria]=(V.galerias[O.galeria]||0)+1)}),L.categoria&&(V.categorias[L.categoria]=(V.categorias[L.categoria]||0)+1),L.tags&&Array.isArray(L.tags)&&L.tags.forEach(O=>{V.tags[O]=(V.tags[O]||0)+1})}),V},[t]),te=T.useCallback(V=>!V||V.length===0?t:t.filter(L=>L.tags&&L.tags.some(O=>V.includes(O))),[t]),B=T.useCallback(V=>!V||V.length===0?t:t.filter(L=>L.talles&&L.talles.some(O=>V.includes(O))),[t]);return T.useEffect(()=>{k(),P(),N()},[k,P,N]),{providers:t,loading:r,error:s,searchResults:o,categories:u,areas:h,galleries:p,loadProviders:_,searchProvidersByTerm:w,getProvider:$,addProvider:x,updateProviderData:v,removeProvider:y,clearSearch:D,filterByCategory:S,filterByArea:R,filterByGallery:M,filterByTags:te,filterByTalles:B,getProviderStatistics:I,getProviderStatsLocal:j,getProviderProductStatistics:E,loadCategories:k,loadAreas:P,loadGalleries:N}},HR=()=>{const[t,e]=T.useState({products:{loading:!1,data:[],error:null},providers:{loading:!1,data:[],error:null}}),{loadProducts:r}=Su(),{loadProviders:n}=Do(),s=async()=>{e(o=>({...o,products:{...o.products,loading:!0,error:null}}));try{console.log("🧪 Iniciando test de productos...");const o=await r();console.log("🧪 Productos obtenidos:",o),e(l=>({...l,products:{loading:!1,data:o||[],error:null}}))}catch(o){console.error("🧪 Error en test de productos:",o),e(l=>({...l,products:{loading:!1,data:[],error:o.message}}))}},i=async()=>{e(o=>({...o,providers:{...o.providers,loading:!0,error:null}}));try{console.log("🧪 Iniciando test de proveedores...");const o=await n();console.log("🧪 Proveedores obtenidos:",o),e(l=>({...l,providers:{loading:!1,data:o||[],error:null}}))}catch(o){console.error("🧪 Error en test de proveedores:",o),e(l=>({...l,providers:{loading:!1,data:[],error:o.message}}))}};return a.jsxs("div",{className:"p-6 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx("h2",{className:"text-xl font-bold text-yellow-800 mb-4",children:"🔧 Diagnóstico de Firestore"}),a.jsx("p",{className:"text-sm text-yellow-700 mb-4",children:"Este panel te ayuda a diagnosticar la conexión con Firestore. Revisa la consola del navegador (F12) para ver los logs detallados."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white p-4 rounded border",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"📦 Test de Productos (articulos)"}),a.jsx("button",{onClick:s,disabled:t.products.loading,className:"mb-3 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:t.products.loading?"Cargando...":"Probar Conexión"}),t.products.error&&a.jsx("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded",children:a.jsxs("p",{className:"text-red-600 text-sm",children:[a.jsx("strong",{children:"Error:"})," ",t.products.error]})}),t.products.data.length>0&&a.jsxs("div",{className:"mb-3 p-3 bg-green-50 border border-green-200 rounded",children:[a.jsxs("p",{className:"text-green-600 text-sm mb-2",children:[a.jsx("strong",{children:"✅ Éxito:"})," ",t.products.data.length," productos encontrados"]}),a.jsxs("div",{className:"text-xs text-gray-600 max-h-32 overflow-y-auto",children:[a.jsx("strong",{children:"Primer producto:"}),a.jsx("pre",{children:JSON.stringify(t.products.data[0],null,2)})]})]}),!t.products.loading&&t.products.data.length===0&&!t.products.error&&a.jsx("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded",children:a.jsx("p",{className:"text-gray-600 text-sm",children:'No se han cargado productos aún. Haz clic en "Probar Conexión".'})})]}),a.jsxs("div",{className:"bg-white p-4 rounded border",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"🏪 Test de Proveedores (proveedores)"}),a.jsx("button",{onClick:i,disabled:t.providers.loading,className:"mb-3 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:t.providers.loading?"Cargando...":"Probar Conexión"}),t.providers.error&&a.jsx("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded",children:a.jsxs("p",{className:"text-red-600 text-sm",children:[a.jsx("strong",{children:"Error:"})," ",t.providers.error]})}),t.providers.data.length>0&&a.jsxs("div",{className:"mb-3 p-3 bg-green-50 border border-green-200 rounded",children:[a.jsxs("p",{className:"text-green-600 text-sm mb-2",children:[a.jsx("strong",{children:"✅ Éxito:"})," ",t.providers.data.length," proveedores encontrados"]}),a.jsxs("div",{className:"text-xs text-gray-600 max-h-32 overflow-y-auto",children:[a.jsx("strong",{children:"Primer proveedor:"}),a.jsx("pre",{children:JSON.stringify(t.providers.data[0],null,2)})]})]}),!t.providers.loading&&t.providers.data.length===0&&!t.providers.error&&a.jsx("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded",children:a.jsx("p",{className:"text-gray-600 text-sm",children:'No se han cargado proveedores aún. Haz clic en "Probar Conexión".'})})]})]}),a.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded",children:[a.jsx("p",{className:"text-blue-700 text-sm",children:a.jsx("strong",{children:"💡 Instrucciones:"})}),a.jsxs("ul",{className:"text-blue-600 text-sm mt-1 ml-4 list-disc",children:[a.jsx("li",{children:"Haz clic en los botones para probar cada conexión"}),a.jsx("li",{children:"Abre la consola del navegador (F12) para ver logs detallados"}),a.jsx("li",{children:"Si hay errores, revisa los permisos de Firestore"}),a.jsx("li",{children:"Si no hay datos, verifica que las colecciones existan y tengan documentos"})]})]})]})},GR=()=>{const{user:t}=Cu(),e=()=>new Date().toLocaleDateString("es-AR",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"🏠 Dashboard Principal"}),a.jsx("p",{className:"text-gray-600 mt-2",children:e()}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Bienvenido, ",t==null?void 0:t.email]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsx(ts,{to:"/sales",className:"btn-rosema text-center p-6 h-auto block hover:no-underline",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("span",{className:"text-3xl mr-4",children:"💰"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xl font-bold",children:"Realizar Venta"}),a.jsx("div",{className:"text-sm opacity-90",children:"Iniciar nueva transacción"})]})]})}),a.jsx(ts,{to:"/products",className:"btn-secondary text-center p-6 h-auto block hover:no-underline",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("span",{className:"text-3xl mr-4",children:"👕"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xl font-bold",children:"Agregar Producto"}),a.jsx("div",{className:"text-sm opacity-75",children:"Gestionar inventario"})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-red-600 mb-2",children:"$0"}),a.jsx("div",{className:"text-gray-600",children:"Ventas Hoy"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"0 transacciones"})]}),a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"$0"}),a.jsx("div",{className:"text-gray-600",children:"Ventas Mes"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"0 transacciones"})]}),a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"0"}),a.jsx("div",{className:"text-gray-600",children:"Productos"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"En inventario"})]}),a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:"0"}),a.jsx("div",{className:"text-gray-600",children:"Clientes"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Registrados"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{className:"card-rosema",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Estado del Sistema"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"✅ Etapa 1: Configuración Base"}),a.jsx("span",{className:"text-green-600 font-medium",children:"Completada"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"🔄 Etapa 2: Dashboard y Navegación"}),a.jsx("span",{className:"text-blue-600 font-medium",children:"En Progreso"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"⏳ Etapa 3: Sistema de Ventas"}),a.jsx("span",{className:"text-gray-500 font-medium",children:"Pendiente"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"⏳ Etapa 4: Gestión de Productos"}),a.jsx("span",{className:"text-gray-500 font-medium",children:"Pendiente"})]})]})]}),a.jsxs("div",{className:"card-rosema",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Información de la Tienda"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-red-600 mr-3",children:"🏪"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:"Rosema"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Tienda de Ropa"})]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-blue-600 mr-3",children:"📍"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:"Salto de las Rosas"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Ubicación"})]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-green-600 mr-3",children:"📱"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:"260 438-1502"}),a.jsx("div",{className:"text-sm text-gray-500",children:"WhatsApp"})]})]})]})]})]}),a.jsxs("div",{className:"card-rosema",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Acceso Rápido a Secciones"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs(ts,{to:"/statistics",className:"bg-gray-50 hover:bg-gray-100 p-4 rounded-lg text-center transition-colors",children:[a.jsx("div",{className:"text-2xl mb-2",children:"📊"}),a.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Estadísticas"})]}),a.jsxs(ts,{to:"/customers",className:"bg-gray-50 hover:bg-gray-100 p-4 rounded-lg text-center transition-colors",children:[a.jsx("div",{className:"text-2xl mb-2",children:"👥"}),a.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Clientes"})]}),a.jsxs(ts,{to:"/suppliers",className:"bg-gray-50 hover:bg-gray-100 p-4 rounded-lg text-center transition-colors",children:[a.jsx("div",{className:"text-2xl mb-2",children:"🏪"}),a.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Proveedores"})]}),a.jsxs(ts,{to:"/goals",className:"bg-gray-50 hover:bg-gray-100 p-4 rounded-lg text-center transition-colors",children:[a.jsx("div",{className:"text-2xl mb-2",children:"🎯"}),a.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Metas"})]})]})]}),a.jsx("div",{className:"card-rosema mt-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"¡Bienvenido al Sistema POS de Rosema!"}),a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[a.jsx("p",{className:"text-green-800 font-medium",children:"🎉 Etapa 2 Implementada: Dashboard y Navegación"}),a.jsx("p",{className:"text-green-600 text-sm mt-1",children:"Sistema con menú lateral funcional y páginas organizadas"})]})]})}),a.jsx("div",{className:"mt-8",children:a.jsx(HR,{})})]})},KR=()=>a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"📊 Estadísticas"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Reportes y análisis de ventas"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"card-rosema",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Próximamente en Etapa 7"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"✅"}),"Gráficos con Chart.js o Recharts"]}),a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"✅"}),"Ventas diarias, semanales y mensuales"]}),a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"✅"}),"Total en $ de activos"]}),a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"✅"}),"Total en $ invertido en productos"]})]})]}),a.jsxs("div",{className:"card-rosema",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Vista Previa"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("div",{className:"text-6xl mb-4",children:"📈"}),a.jsx("p",{className:"text-gray-600",children:"Aquí se mostrarán gráficos interactivos con las estadísticas de ventas"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6",children:[a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-red-600 mb-2",children:"$0"}),a.jsx("div",{className:"text-gray-600",children:"Ventas Hoy"})]}),a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"$0"}),a.jsx("div",{className:"text-gray-600",children:"Ventas Mes"})]}),a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"0"}),a.jsx("div",{className:"text-gray-600",children:"Productos Vendidos"})]})]})]}),Ti="clientes",Lo=async()=>{try{console.log("🔍 Obteniendo clientes de la colección:",Ti);const t=await Xt(Ot(ut(xe,Ti),bs("createdAt","desc")));console.log("📊 Clientes encontrados:",t.size);const e=t.docs.map(r=>{const n=r.data();return{id:r.id,...n,nombre:n.nombre||n.name||"Sin nombre",telefono:n.telefono||n.phone||"",email:n.email||"",direccion:n.direccion||n.address||"",fechaNacimiento:n.fechaNacimiento||null,notas:n.notas||"",tags:n.tags||[],totalCompras:n.totalCompras||0,montoTotalGastado:n.montoTotalGastado||0,ultimaCompra:n.ultimaCompra||null,categoriasPreferidas:n.categoriasPreferidas||[],tallesPreferidos:n.tallesPreferidos||[]}});return console.log("✅ Clientes procesados:",e.length),e}catch(t){throw console.error("❌ Error al obtener clientes:",t),new Error("No se pudieron cargar los clientes: "+t.message)}},ip=async t=>{try{const e=et(xe,Ti,t),r=await Kn(e);if(r.exists()){const n=r.data();return{id:r.id,...n,nombre:n.nombre||"Sin nombre",telefono:n.telefono||"",email:n.email||"",direccion:n.direccion||"",fechaNacimiento:n.fechaNacimiento||null,notas:n.notas||"",tags:n.tags||[],totalCompras:n.totalCompras||0,montoTotalGastado:n.montoTotalGastado||0,ultimaCompra:n.ultimaCompra||null,categoriasPreferidas:n.categoriasPreferidas||[],tallesPreferidos:n.tallesPreferidos||[]}}else throw new Error("Cliente no encontrado")}catch(e){throw console.error("Error al obtener cliente:",e),e}},Hb=async t=>{try{if(!t.nombre||!t.nombre.trim())throw new Error("El nombre del cliente es requerido");const e={nombre:t.nombre.trim(),telefono:t.telefono||"",email:t.email||"",direccion:t.direccion||"",fechaNacimiento:t.fechaNacimiento||null,notas:t.notas||"",tags:t.tags||[],totalCompras:0,montoTotalGastado:0,ultimaCompra:null,categoriasPreferidas:[],tallesPreferidos:[],createdAt:new Date,updatedAt:new Date};return{id:(await Zf(ut(xe,Ti),e)).id,...e}}catch(e){throw console.error("Error al crear cliente:",e),new Error("No se pudo crear el cliente: "+e.message)}},Gb=async(t,e)=>{try{const r=et(xe,Ti,t);if(e.nombre!==void 0&&(!e.nombre||!e.nombre.trim()))throw new Error("El nombre del cliente es requerido");const n={...e,updatedAt:new Date};return Object.keys(n).forEach(s=>{n[s]===void 0&&delete n[s]}),await Bi(r,n),{id:t,...n}}catch(r){throw console.error("Error al actualizar cliente:",r),new Error("No se pudo actualizar el cliente: "+r.message)}},QR=async t=>{try{return await Eu(et(xe,Ti,t)),t}catch(e){throw console.error("Error al eliminar cliente:",e),new Error("No se pudo eliminar el cliente: "+e.message)}},XR=async t=>{try{if(!t.trim())return[];const e=await Lo(),r=t.toLowerCase().trim();return e.filter(n=>!!(n.nombre&&n.nombre.toLowerCase().includes(r)||n.telefono&&n.telefono.includes(r)||n.email&&n.email.toLowerCase().includes(r)||n.tags&&Array.isArray(n.tags)&&n.tags.some(s=>s.toLowerCase().includes(r))))}catch(e){throw console.error("Error al buscar clientes:",e),new Error("Error en la búsqueda de clientes: "+e.message)}},YR=async()=>{try{const t=await Lo(),e={totalCustomers:t.length,activeCustomers:t.filter(n=>n.totalCompras>0).length,newCustomersThisMonth:0,topCustomers:[],averageSpending:0,totalRevenue:0},r=new Date;return r.setDate(1),r.setHours(0,0,0,0),e.newCustomersThisMonth=t.filter(n=>n.createdAt?(n.createdAt.seconds?new Date(n.createdAt.seconds*1e3):new Date(n.createdAt))>=r:!1).length,e.totalRevenue=t.reduce((n,s)=>n+(s.montoTotalGastado||0),0),e.averageSpending=t.length>0?e.totalRevenue/t.length:0,e.topCustomers=t.filter(n=>n.totalCompras>0).sort((n,s)=>(s.montoTotalGastado||0)-(n.montoTotalGastado||0)).slice(0,10).map(n=>({id:n.id,nombre:n.nombre,totalCompras:n.totalCompras,montoTotalGastado:n.montoTotalGastado,ultimaCompra:n.ultimaCompra})),e}catch(t){throw console.error("Error al obtener estadísticas de clientes:",t),new Error("No se pudieron obtener las estadísticas: "+t.message)}},Kb=async t=>{try{console.log("🔍 Obteniendo historial de compras para cliente:",t);const e=await ip(t),r=Ot(ut(xe,"ventas"),kr("customerName","==",e.nombre),bs("saleDate","desc")),s=(await Xt(r)).docs.map(i=>{var o;return{id:i.id,...i.data(),saleDate:((o=i.data().saleDate)==null?void 0:o.toDate())||new Date}});return console.log(`📦 Compras encontradas para ${e.nombre}:`,s.length),s}catch(e){return console.error("❌ Error al obtener historial de compras:",e),[]}},Qb=async(t,e)=>{try{if(!t||!t.trim()){console.log("ℹ️ No hay nombre de cliente para actualizar estadísticas");return}console.log("🔄 Actualizando estadísticas para cliente:",t);let n=(await Lo()).find(h=>h.nombre.toLowerCase()===t.toLowerCase());n||(console.log("👤 Creando nuevo cliente automáticamente:",t),n=await Hb({nombre:t,telefono:"",email:"",direccion:"",notas:"Cliente creado automáticamente desde venta"}));const s=(n.totalCompras||0)+1,i=(n.montoTotalGastado||0)+(e.total||0),o=[],l=[];e.items&&Array.isArray(e.items)&&e.items.forEach(h=>{h.talle&&l.push(h.talle)});const u=[...n.categoriasPreferidas||[],...o],d=[...n.tallesPreferidos||[],...l];await Gb(n.id,{totalCompras:s,montoTotalGastado:i,ultimaCompra:new Date,categoriasPreferidas:[...new Set(u)],tallesPreferidos:[...new Set(d)]}),console.log("✅ Estadísticas de cliente actualizadas")}catch(r){console.error("❌ Error al actualizar estadísticas de cliente:",r)}},JR=async(t=10)=>{try{return(await Lo()).filter(r=>r.totalCompras>0).sort((r,n)=>n.totalCompras!==r.totalCompras?n.totalCompras-r.totalCompras:(n.montoTotalGastado||0)-(r.montoTotalGastado||0)).slice(0,t)}catch(e){return console.error("Error al obtener top clientes:",e),[]}},ZR=async t=>{try{const e=await ip(t),r=await Kb(t),n={},s={},i={};r.forEach(u=>{const d=u.saleDate.toISOString().slice(0,7);i[d]=(i[d]||0)+(u.total||0),u.items&&Array.isArray(u.items)&&u.items.forEach(h=>{h.talle&&(s[h.talle]=(s[h.talle]||0)+(h.quantity||1))})});const o=Object.entries(s).sort(([,u],[,d])=>d-u).slice(0,5).map(([u,d])=>({size:u,count:d})),l=Object.entries(i).sort(([u],[d])=>u.localeCompare(d)).map(([u,d])=>({month:u,amount:d}));return{customer:e,purchases:r,preferences:{topSizes:o,monthlySpending:l,averageOrderValue:r.length>0?r.reduce((u,d)=>u+(d.total||0),0)/r.length:0,purchaseFrequency:r.length,lastPurchase:r.length>0?r[0].saleDate:null}}}catch(e){throw console.error("Error al obtener preferencias del cliente:",e),e}},Ps="ventas",ap="articulos",eD=async t=>{try{if(!t.trim())return[];const e=Ot(ut(xe,ap)),n=(await Xt(e)).docs.map(i=>({id:i.id,...i.data()})),s=t.toLowerCase();return n.filter(i=>i.id.toLowerCase().includes(s)||i.articulo&&i.articulo.toLowerCase().includes(s))}catch(e){throw console.error("Error buscando productos:",e),new Error("Error al buscar productos")}},Xb=async t=>{try{console.log(`🔍 Buscando producto por ID: ${t}`);const e=et(xe,ap,t),r=await Kn(e);if(r.exists()){const n={id:r.id,...r.data()};return console.log("✅ Producto encontrado:",n),n}return console.log(`❌ Producto no encontrado con ID: ${t}`),null}catch(e){throw console.error("Error obteniendo producto por ID:",e),new Error("Error al obtener producto")}},tD=Xb,Yb=async(t,e,r,n)=>{var s,i;try{console.log(`🔍 Validando stock para producto ID: ${t}, talle: ${e}, color: ${r}, cantidad: ${n}`);const o=await Xb(t);if(!o)throw console.error(`❌ Producto no encontrado con ID: ${t}`),new Error(`Producto no encontrado: ${t}`);console.log("📦 Producto encontrado:",o.articulo,"Variantes:",o.variantes);const l=(s=o.variantes)==null?void 0:s.find(u=>u.talle===e&&u.color===r);if(!l)throw console.error(`❌ Variante no encontrada. Buscando: ${e}/${r}`),console.log("📋 Variantes disponibles:",(i=o.variantes)==null?void 0:i.map(u=>`${u.talle}/${u.color}`)),new Error(`Variante ${e}/${r} no encontrada en producto ${o.articulo}`);if(l.stock<n)throw console.error(`❌ Stock insuficiente. Disponible: ${l.stock}, Solicitado: ${n}`),new Error(`Stock insuficiente. Disponible: ${l.stock}, Solicitado: ${n}`);return console.log(`✅ Validación exitosa. Stock disponible: ${l.stock}`),{available:!0,currentStock:l.stock,price:l.precioVenta||o.precioCosto||0}}catch(o){throw console.error("❌ Error validando stock:",o),o}},rD=async()=>{try{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1),n=Ot(ut(xe,Ps),kr("saleDate",">=",e),kr("saleDate","<",r),bs("saleDate","desc"),Xf(1)),s=await Xt(n);let i=1;if(!s.empty){const u=s.docs[0].data();u.saleNumber&&(i=(parseInt(u.saleNumber.split("-")[1])||0)+1)}return`${t.toISOString().slice(0,10).replace(/-/g,"")}-${i.toString().padStart(3,"0")}`}catch(t){return console.error("Error al generar número de venta:",t),`${Date.now()}`}},Jb=async t=>{const e=sA(xe);try{const{items:r,paymentMethod:n,discount:s,total:i,customerName:o,clientId:l,cardName:u,installments:d,commission:h}=t;console.log("🔄 Procesando venta con items:",r);for(const _ of r)_.productId&&!_.isQuickItem&&(console.log(`🔍 Validando stock para producto ${_.productId}, talle: ${_.size}, color: ${_.color}`),await Yb(_.productId,_.size,_.color,_.quantity));const p={saleNumber:await rD(),items:r.map(_=>({productId:_.productId||null,productName:_.productName||_.name,articulo:_.articulo||_.name,code:_.code||_.productId,talle:_.size||null,color:_.color||null,price:_.price,quantity:_.quantity,subtotal:_.price*_.quantity,proveedorId:_.proveedorId||null,providerName:_.providerName||null,isReturn:_.isReturn||!1,isQuickItem:_.isQuickItem||!1})),paymentMethod:n,discount:s||0,subtotal:r.reduce((_,k)=>_+k.price*k.quantity,0),total:i,customerName:o||"",clientId:l||null,cardName:u||null,installments:d||null,commission:h||null,saleDate:new Date,createdAt:De.now(),updatedAt:De.now(),status:"completed"};console.log("💾 Guardando venta:",p);const b=await Zf(ut(xe,Ps),p);for(const _ of r)if(_.productId&&!_.isQuickItem){console.log(`📦 Actualizando stock para producto ${_.productId}`);const k=et(xe,ap,_.productId),P=await Kn(k);if(P.exists()){const w=P.data().variantes.map(S=>{if(S.talle===_.size&&S.color===_.color){const R=_.isReturn?_.quantity:-_.quantity;return console.log(`📊 Stock change para ${S.talle}/${S.color}: ${R}`),{...S,stock:Math.max(0,S.stock+R)}}return S});e.update(k,{variantes:w,updatedAt:De.now()})}else console.warn(`⚠️ Producto ${_.productId} no encontrado para actualizar stock`)}if(await e.commit(),o&&o.trim())try{console.log("👤 Actualizando estadísticas de cliente:",o),await Qb(o,p),console.log("✅ Estadísticas de cliente actualizadas")}catch(_){console.error("⚠️ Error al actualizar estadísticas de cliente:",_)}return console.log("✅ Venta procesada exitosamente"),{id:b.id,...p}}catch(r){throw console.error("❌ Error al procesar venta:",r),r}},nD=async()=>{try{const t=Ot(ut(xe,Ps),bs("createdAt","desc"));return(await Xt(t)).docs.map(r=>{var n;return{id:r.id,...r.data(),createdAt:((n=r.data().createdAt)==null?void 0:n.toDate())||new Date}})}catch(t){throw console.error("Error obteniendo ventas:",t),new Error("Error al obtener ventas")}},op=async(t={})=>{try{let e=Ot(ut(xe,Ps),bs("saleDate","desc"));return t.startDate&&(e=Ot(e,kr("saleDate",">=",t.startDate))),t.endDate&&(e=Ot(e,kr("saleDate","<=",t.endDate))),t.paymentMethod&&(e=Ot(e,kr("paymentMethod","==",t.paymentMethod))),t.limit&&(e=Ot(e,Xf(t.limit))),(await Xt(e)).docs.map(n=>{var s;return{id:n.id,...n.data(),saleDate:((s=n.data().saleDate)==null?void 0:s.toDate())||new Date}})}catch(e){throw console.error("Error al obtener historial de ventas:",e),new Error("No se pudo cargar el historial de ventas")}},sD=async t=>{try{if(!t.trim())return await op({limit:50});const e=t.toLowerCase().trim(),r=Ot(ut(xe,Ps),kr("customerName",">=",e),kr("customerName","<=",e+""),bs("customerName"),bs("saleDate","desc"),Xf(20));return(await Xt(r)).docs.map(s=>{var i;return{id:s.id,...s.data(),saleDate:((i=s.data().saleDate)==null?void 0:i.toDate())||new Date}})}catch(e){throw console.error("Error al buscar ventas:",e),new Error("Error en la búsqueda de ventas")}},iD=async t=>{var e;try{const r=et(xe,Ps,t),n=await Kn(r);if(n.exists()){const s=n.data();return{id:n.id,...s,saleDate:((e=s.saleDate)==null?void 0:e.toDate())||new Date}}else throw new Error("Venta no encontrada")}catch(r){throw console.error("Error al obtener venta:",r),r}},aD=async t=>{try{const e=await iD(t),r=[];return e.items.forEach(n=>{if(n.productId&&!n.isQuickItem){const s=n.isReturn?-n.quantity:n.quantity;r.push({productId:n.productId,stockChange:s})}}),await Eu(et(xe,Ps,t)),t}catch(e){throw console.error("Error al eliminar venta:",e),new Error("No se pudo eliminar la venta")}},Hl=async(t="today")=>{try{const e=new Date;let r;switch(t){case"today":r=new Date(e.getFullYear(),e.getMonth(),e.getDate());break;case"week":r=new Date(e.getTime()-7*24*60*60*1e3);break;case"month":r=new Date(e.getFullYear(),e.getMonth(),1);break;default:r=new Date(e.getFullYear(),e.getMonth(),e.getDate())}const n=await op({startDate:De.fromDate(r),endDate:De.fromDate(e)}),s={totalSales:n.length,totalRevenue:n.reduce((i,o)=>i+(o.total||0),0),averageSale:n.length>0?n.reduce((i,o)=>i+(o.total||0),0)/n.length:0,paymentMethods:{},topProducts:{}};return n.forEach(i=>{const o=i.paymentMethod||"Efectivo";s.paymentMethods[o]=(s.paymentMethods[o]||0)+1}),n.forEach(i=>{var o;(o=i.items)==null||o.forEach(l=>{if(!l.isReturn){const u=l.name;s.topProducts[u]=(s.topProducts[u]||0)+l.quantity}})}),s}catch(e){throw console.error("Error al obtener estadísticas de ventas:",e),new Error("No se pudieron obtener las estadísticas")}},oD=t=>({saleId:t.id,date:t.saleDate||new Date,items:t.items||[],subtotal:t.subtotal||0,discount:t.discount||0,total:t.total||0,paymentMethod:t.paymentMethod||"Efectivo",customerName:t.customerName||"",storeInfo:{name:"Rosema",location:"Salto de las Rosas",whatsapp:"260 438-1502",returnPolicy:"Cambios en 3 días hábiles"}}),Bs={EFECTIVO:"Efectivo",TRANSFERENCIA:"Transferencia",DEBITO:"Débito",CREDITO:"Crédito",QR:"QR"},$x=6,Zb="pos.sessions.v1",eN=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,Nl=t=>({id:eN(),label:t||`Cliente ${Date.now()}`,status:"open",items:[],customerId:null,customerName:"",discountPercent:0,paymentMethod:Bs.EFECTIVO,cashReceived:0,cardName:"",installments:0,commission:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),lD=()=>{try{const t=localStorage.getItem(Zb);if(t){const e=JSON.parse(t);return{sessions:e.sessions||{},activeSessionId:e.activeSessionId||null}}}catch(t){console.error("Error loading sessions from storage:",t)}return{sessions:{},activeSessionId:null}},cD=(t,e)=>{try{const r=Object.fromEntries(Object.entries(t).filter(([n,s])=>s.status==="open"));localStorage.setItem(Zb,JSON.stringify({sessions:r,activeSessionId:e}))}catch(r){console.error("Error saving sessions to storage:",r)}},tN=()=>{const[t,e]=T.useState(()=>{const B=lD();if(Object.keys(B.sessions).length===0){const V=Nl("Cliente 1");return{sessions:{[V.id]:V},activeSessionId:V.id}}return{sessions:B.sessions,activeSessionId:B.activeSessionId||Object.keys(B.sessions)[0]}}),[r,n]=T.useState([]),[s,i]=T.useState(!1),[o,l]=T.useState(null),u=T.useCallback(()=>t.sessions[t.activeSessionId]||null,[t]),d=T.useCallback(B=>Math.round(B/500)*500,[]),h=T.useCallback(B=>{if(!B)return{subtotal:0,discountValue:0,total:0,change:0,itemCount:0};const V=B.items.reduce((J,A)=>J+A.price*A.qty,0),L=V*(B.discountPercent/100),O=V-L,H=d(Math.max(0,O)),q=Math.max(0,B.cashReceived-H);return{subtotal:V,discountValue:L,total:H,change:q,itemCount:B.items.reduce((J,A)=>J+A.qty,0)}},[d]),f=T.useCallback(B=>{e(V=>{const L=typeof B=="function"?B(V):B;return cD(L.sessions,L.activeSessionId),L})},[]),p=T.useCallback(B=>{const V=Object.keys(t.sessions).length;if(V>=$x)throw new Error(`Máximo ${$x} ventas abiertas permitidas`);const L=Nl(B||`Cliente ${V+1}`);return f(O=>({sessions:{...O.sessions,[L.id]:L},activeSessionId:L.id})),L.id},[t.sessions,f]),b=T.useCallback(B=>{if(!t.sessions[B]){console.error(`Session ${B} not found`);return}f(V=>({...V,activeSessionId:B}))},[t.sessions,f]),_=T.useCallback(B=>{const V=t.sessions[B];V&&(V.items.length>0&&!confirm(`¿Estás seguro de cancelar la venta "${V.label}"? Se perderán todos los productos.`)||f(L=>{const O={...L.sessions};delete O[B];let H=L.activeSessionId;if(L.activeSessionId===B){const q=Object.keys(O);if(q.length>0)H=q[0];else{const J=Nl("Cliente 1");O[J.id]=J,H=J.id}}return{sessions:O,activeSessionId:H}}))},[t.sessions,f]),k=T.useCallback(async B=>{const V=t.sessions[B];if(!V||V.items.length===0)throw new Error("No hay productos en la venta");const L=h(V);if(L.total<=0)throw new Error("El total debe ser mayor a cero");if(V.paymentMethod===Bs.CREDITO&&!V.cardName.trim())throw new Error("El nombre de la tarjeta es requerido para pagos con crédito");i(!0),l(null);try{console.log("🔍 DEBUG: Items en sesión antes de mapear:",V.items);const O={items:V.items.map(q=>{var J,A;return console.log("🔍 DEBUG: Mapeando item:",{productId:q.productId,variant:q.variant,isQuickItem:q.isQuickItem}),{productId:q.productId,name:q.nombre,price:q.price,quantity:q.qty,size:(J=q.variant)==null?void 0:J.talle,color:(A=q.variant)==null?void 0:A.color,subtotal:q.price*q.qty,isReturn:q.isReturn||!1,isQuickItem:q.isQuickItem||!1}}),paymentMethod:V.paymentMethod,discount:L.discountValue,total:L.total,customerName:V.customerName,clientId:B,cardName:V.paymentMethod===Bs.CREDITO?V.cardName:null,installments:V.paymentMethod===Bs.CREDITO?V.installments:null,commission:V.paymentMethod===Bs.CREDITO?V.commission:null};console.log("📤 DEBUG: SaleData enviado a processSale:",O);const H=await Jb(O);return f(q=>{const J={...q.sessions};delete J[B];let A=q.activeSessionId;if(q.activeSessionId===B){const Q=Object.keys(J);if(Q.length>0)A=Q[0];else{const ae=Nl("Cliente 1");J[ae.id]=ae,A=ae.id}}return{sessions:J,activeSessionId:A}}),n(q=>[H,...q]),console.log("✅ Venta procesada exitosamente"),H}catch(O){throw l(O.message),console.error("❌ Error al procesar venta:",O),O}finally{i(!1)}},[t.sessions,h,f]),P=T.useCallback((B,V)=>{const L=t.sessions[B];if(!L)return;console.log("🔍 DEBUG: addItem recibió:",V);const O={lineId:eN(),productId:V.productId||null,name:V.name,nombre:V.name,price:V.price,qty:V.quantity||1,variant:{talle:V.size||null,color:V.color||null},stock:V.stock||null,isReturn:V.isReturn||!1,isQuickItem:V.isQuickItem||!1};console.log("🔍 DEBUG: lineItem creado:",O);const H=!O.isQuickItem&&O.productId?L.items.findIndex(J=>{var A,Q,ae,le;return J.productId===O.productId&&((A=J.variant)==null?void 0:A.talle)===((Q=O.variant)==null?void 0:Q.talle)&&((ae=J.variant)==null?void 0:ae.color)===((le=O.variant)==null?void 0:le.color)&&!J.isReturn&&!J.isQuickItem}):-1;let q;return H>=0&&!O.isReturn&&!O.isQuickItem?(q=[...L.items],q[H]={...q[H],qty:q[H].qty+O.qty}):q=[...L.items,O],f(J=>({...J,sessions:{...J.sessions,[B]:{...L,items:q,updatedAt:new Date().toISOString()}}})),O.lineId},[t.sessions,f]),N=T.useCallback((B,V)=>{const L=t.sessions[B];if(!L)return;const O=L.items.filter(H=>H.lineId!==V);f(H=>({...H,sessions:{...H.sessions,[B]:{...L,items:O,updatedAt:new Date().toISOString()}}}))},[t.sessions,f]),w=T.useCallback((B,V,L)=>{const O=t.sessions[B];if(!O)return;let H;L<=0?H=O.items.filter(q=>q.lineId!==V):H=O.items.map(q=>q.lineId===V?{...q,qty:L}:q),f(q=>({...q,sessions:{...q.sessions,[B]:{...O,items:H,updatedAt:new Date().toISOString()}}}))},[t.sessions,f]),S=T.useCallback((B,V)=>{const L=t.sessions[B];L&&f(O=>({...O,sessions:{...O.sessions,[B]:{...L,discountPercent:V,updatedAt:new Date().toISOString()}}}))},[t.sessions,f]),R=T.useCallback((B,V)=>{const L=t.sessions[B];L&&f(O=>({...O,sessions:{...O.sessions,[B]:{...L,paymentMethod:V,updatedAt:new Date().toISOString()}}}))},[t.sessions,f]),M=T.useCallback((B,V)=>{const L=t.sessions[B];L&&f(O=>({...O,sessions:{...O.sessions,[B]:{...L,cashReceived:V,updatedAt:new Date().toISOString()}}}))},[t.sessions,f]),$=T.useCallback((B,V)=>{const L=t.sessions[B];L&&f(O=>({...O,sessions:{...O.sessions,[B]:{...L,customerName:V||"",updatedAt:new Date().toISOString()}}}))},[t.sessions,f]),E=T.useCallback((B,V,L,O)=>{const H=t.sessions[B];H&&f(q=>({...q,sessions:{...q.sessions,[B]:{...H,cardName:V||"",installments:L||0,commission:O||0,updatedAt:new Date().toISOString()}}}))},[t.sessions,f]),x=T.useCallback(B=>{const V=t.sessions[B];if(!V)return;const L={...V,items:[],discountPercent:0,cashReceived:0,customerName:"",cardName:"",installments:0,commission:0,updatedAt:new Date().toISOString()};f(O=>({...O,sessions:{...O.sessions,[B]:L}}))},[t.sessions,f]),v=u(),y=h(v),D=T.useCallback((B,V=1,L=null)=>{if(t.activeSessionId){if(!L){alert("Debe seleccionar una variante para el producto");return}if(L.stock<V){alert(`Stock insuficiente. Disponible: ${L.stock}, Solicitado: ${V}`);return}return console.log("🔍 DEBUG: addToCart llamado con:",{productId:B.id,codigo:B.id,variant:L,quantity:V}),P(t.activeSessionId,{productId:B.id,name:B.articulo,code:B.id,price:L.precioVenta||B.precioVenta,quantity:V,size:L.talle,color:L.color,stock:L.stock,isReturn:B.isReturn||!1,isQuickItem:!B.id})}},[t.activeSessionId,P]),I=T.useCallback((B,V)=>{t.activeSessionId&&w(t.activeSessionId,B,V)},[t.activeSessionId,w]),j=T.useCallback(B=>{t.activeSessionId&&N(t.activeSessionId,B)},[t.activeSessionId,N]),te=T.useCallback(async(B={})=>{i(!0);try{const V=await op(B);return n(V),V}catch(V){return l(V.message),[]}finally{i(!1)}},[]);return{sessions:t.sessions,activeSessionId:t.activeSessionId,cart:(v==null?void 0:v.items)||[],paymentMethod:(v==null?void 0:v.paymentMethod)||Bs.EFECTIVO,discountPercent:(v==null?void 0:v.discountPercent)||0,cashReceived:(v==null?void 0:v.cashReceived)||0,customerName:(v==null?void 0:v.customerName)||"",cardName:(v==null?void 0:v.cardName)||"",installments:(v==null?void 0:v.installments)||0,commission:(v==null?void 0:v.commission)||0,totals:y,salesHistory:r,loading:s,error:o,activeClient:t.activeSessionId,createSession:p,switchSession:b,cancelSession:_,finalizeSession:k,addItem:P,removeItem:N,updateItemQty:w,applyDiscountPercent:S,setPaymentMethod:B=>t.activeSessionId&&R(t.activeSessionId,B),setCashReceived:B=>t.activeSessionId&&M(t.activeSessionId,B),attachCustomer:B=>t.activeSessionId&&$(t.activeSessionId,B),setCreditCardData:(B,V,L)=>t.activeSessionId&&E(t.activeSessionId,B,V,L),clearSession:()=>t.activeSessionId&&x(t.activeSessionId),addToCart:D,updateCartItemQuantity:I,removeFromCart:j,completeSale:()=>t.activeSessionId&&k(t.activeSessionId),changeActiveClient:b,clearCart:()=>t.activeSessionId&&x(t.activeSessionId),setDiscountPercent:B=>t.activeSessionId&&S(t.activeSessionId,B),setCustomerName:B=>t.activeSessionId&&$(t.activeSessionId,B),setCardName:B=>t.activeSessionId&&E(t.activeSessionId,B,v==null?void 0:v.installments,v==null?void 0:v.commission),setInstallments:B=>t.activeSessionId&&E(t.activeSessionId,v==null?void 0:v.cardName,B,v==null?void 0:v.commission),setCommission:B=>t.activeSessionId&&E(t.activeSessionId,v==null?void 0:v.cardName,v==null?void 0:v.installments,B),loadSalesHistory:te,generateReceipt:oD,getSalesStatistics:Hl,addQuickItem:B=>t.activeSessionId&&P(t.activeSessionId,{...B,isQuickItem:!0}),addReturnItem:B=>t.activeSessionId&&P(t.activeSessionId,{...B,isReturn:!0,price:-Math.abs(B.price),qty:B.quantity||1}),deletePendingSaleData:_,savePendingSaleData:()=>Promise.resolve(null),loadPendingSaleData:()=>Promise.resolve(null),searchSalesHistory:sD,deleteSaleFromHistory:aD}},Ii=t=>!t.variantes||!Array.isArray(t.variantes)?0:t.variantes.reduce((e,r)=>e+(r.stock||0),0),rN=t=>{if(!t.variantes||!Array.isArray(t.variantes)||t.variantes.length===0)return t.precioCosto||0;const e=t.variantes.reduce((r,n)=>r+(n.precioVenta||0),0);return Math.round(e/t.variantes.length)},uD=t=>Math.round(t/500)*500,dD=t=>{if(!t||!Array.isArray(t))return{totalProducts:0,totalStock:0,lowStockProducts:0,outOfStockProducts:0,categories:{}};const e={totalProducts:t.length,totalStock:0,lowStockProducts:0,outOfStockProducts:0,categories:{}};return t.forEach(r=>{const n=Ii(r);e.totalStock+=n,n===0?e.outOfStockProducts++:n<=5&&e.lowStockProducts++;const s=r.categoria||"Sin categoría";e.categories[s]||(e.categories[s]=0),e.categories[s]++}),e},hD=(t,e)=>{if(!e.trim())return[];const r=e.toLowerCase(),n=t.filter(i=>{var o,l,u,d;return((o=i.articulo)==null?void 0:o.toLowerCase().includes(r))||((l=i.id)==null?void 0:l.toLowerCase().includes(r))||((u=i.codigoBarras)==null?void 0:u.toLowerCase().includes(r))||((d=i.tags)==null?void 0:d.some(h=>h.toLowerCase().includes(r)))}),s=n.find(i=>i.codigoBarras===e||i.id===e);return s?[s,...n.filter(i=>i.codigoBarras!==e&&i.id!==e)]:n},mD=t=>!t.variantes||!Array.isArray(t.variantes)?[]:t.variantes.filter(e=>e.stock>0),fD=t=>{if(!t)return{canAdd:!1,reason:"Producto no válido"};if(!t.variantes||t.variantes.length===0)return{canAdd:!1,reason:"El producto no tiene variantes disponibles"};const e=mD(t);return e.length===0?{canAdd:!1,reason:"Producto sin stock disponible en ninguna variante"}:{canAdd:!0,availableVariants:e}},pD=t=>{if(!t)return{subtotal:0,discountValue:0,total:0};const e=t.items.reduce((i,o)=>i+o.price*o.qty,0),r=e*(t.discountPercent/100),n=e-r,s=uD(n);return{subtotal:e,discountValue:r,total:s<0?0:s}},gD=t=>Object.values(t).map(e=>{const r=pD(e);return{id:e.id,name:e.label,total:r.total,items:e.items||[]}}),xD=(t,e,r,n,s)=>({saleNumber:`PREV-${Date.now()}`,items:t.map(i=>{var o,l;return{name:i.nombre||i.name,code:i.productId||i.id||"N/A",quantity:i.qty||i.quantity||1,price:i.price||0,talle:(o=i.variant)==null?void 0:o.talle,color:(l=i.variant)==null?void 0:l.color,isReturn:i.isReturn||!1,isQuickItem:i.isQuickItem||!1}}),customerName:n||"",paymentMethod:r,subtotal:e.subtotal||0,discount:e.discountValue||0,discountValue:e.discountValue||0,total:e.total||0,cashReceived:s||0,change:e.change||0,saleDate:new Date,createdAt:new Date}),yD=(t,e)=>t.length===0?{isValid:!1,message:"El carrito está vacío"}:e.total<=0?{isValid:!1,message:"El total debe ser mayor a cero"}:{isValid:!0,message:null},vD=(t,e,r)=>`¿Confirmar venta por $${t.total.toLocaleString()}?

Método de pago: ${e}
Descuento: ${r}%
Total: $${t.total.toLocaleString()}`,wD=(t,e)=>{if(!e||e<=0)return{commissionAmount:0,netAmount:t};const r=t*e/100,n=t-r;return{commissionAmount:r,netAmount:n}},_D=t=>{if(!t||t.length===0)return"Sin precio";const e=t.map(s=>s.precioVenta||0),r=Math.min(...e),n=Math.max(...e);return r===n?`$${r.toLocaleString()}`:`$${r.toLocaleString()} - $${n.toLocaleString()}`},bD=(t,e)=>{const[r,n]=T.useState(""),[s,i]=T.useState([]),[o,l]=T.useState(!1),u=T.useCallback(async p=>{if(n(p),p.trim()){const b=hD(t,p);i(b),l(!0)}else i([]),l(!1)},[t]),d=T.useCallback(p=>{console.log("📦 Producto seleccionado:",p);const b=fD(p);if(!b.canAdd){alert(b.reason);return}const{availableVariants:_}=b;if(_.length===1){const k=_[0];console.log("✅ Agregando variante única:",k),e(p,1,k),h()}else console.log("🔄 Abriendo modal para seleccionar variante"),e(p,null,null,!0),h()},[e]),h=T.useCallback(()=>{n(""),i([]),l(!1)},[]),f=T.useCallback(async(p,b)=>{try{console.log("🔍 Buscando producto por código:",p);const _=await b(p);if(!_){alert("Producto no encontrado");return}d(_)}catch(_){console.error("Error al buscar producto por código:",_),alert(`Error al buscar producto: ${_.message}`)}},[d]);return{searchTerm:r,searchResults:s,showResults:o,handleSearch:u,handleProductSelect:d,handleBarcodeScan:f,clearSearch:h}},nN=(t=[])=>{const[e,r]=T.useState(()=>{const d={};return t.forEach(h=>{d[h]={isOpen:!1,data:null}}),d}),n=T.useCallback((d,h=null)=>{r(f=>({...f,[d]:{isOpen:!0,data:h}}))},[]),s=T.useCallback(d=>{r(h=>({...h,[d]:{isOpen:!1,data:null}}))},[]),i=T.useCallback(()=>{r(d=>{const h={};return Object.keys(d).forEach(f=>{h[f]={isOpen:!1,data:null}}),h})},[]),o=T.useCallback(d=>{r(h=>{var f,p,b;return{...h,[d]:{isOpen:!((f=h[d])!=null&&f.isOpen),data:(p=h[d])!=null&&p.isOpen?null:(b=h[d])==null?void 0:b.data}}})},[]),l=T.useCallback(d=>{var h;return((h=e[d])==null?void 0:h.isOpen)||!1},[e]),u=T.useCallback(d=>{var h;return((h=e[d])==null?void 0:h.data)||null},[e]);return{modals:e,openModal:n,closeModal:s,closeAllModals:i,toggleModal:o,isModalOpen:l,getModalData:u}},ND=[{value:"mujer",label:"Mujer"},{value:"hombre",label:"Hombre"},{value:"niños-bebes",label:"Niños-Bebés"},{value:"otros",label:"Otros"}],ED=[{value:"Efectivo",label:"Efectivo"},{value:"Transferencia",label:"Transferencia"},{value:"Débito",label:"Débito"},{value:"Crédito",label:"Crédito"},{value:"QR",label:"QR"}],jD=[{value:0,label:"0% (sin descuento)"},{value:5,label:"5% OFF"},{value:10,label:"10% OFF"},{value:15,label:"15% OFF"},{value:20,label:"20% OFF"}],CD=[{value:"created",label:"Más Recientes"},{value:"name",label:"Ordenar por Nombre"},{value:"price",label:"Ordenar por Precio"},{value:"stock",label:"Ordenar por Stock"},{value:"category",label:"Ordenar por Categoría"}],SD=[{value:"asc",label:"Ascendente"},{value:"desc",label:"Descendente"}],ns={SUCCESS:{PRODUCT_CREATED:"Producto creado exitosamente",PRODUCT_UPDATED:"Producto actualizado exitosamente",PRODUCT_DELETED:"Producto eliminado exitosamente",SALE_PROCESSED:"Venta procesada exitosamente",PROVIDER_CREATED:"Proveedor creado exitosamente",PROVIDER_UPDATED:"Proveedor actualizado exitosamente"},ERROR:{PRODUCT_NOT_FOUND:"Producto no encontrado",INSUFFICIENT_STOCK:"Stock insuficiente",INVALID_BARCODE:"Código de barras inválido",UPLOAD_FAILED:"Error al subir archivo",NETWORK_ERROR:"Error de conexión. Intente nuevamente",VALIDATION_ERROR:"Por favor corrija los errores en el formulario"},CONFIRM:{DELETE_PRODUCT:"¿Estás seguro de que deseas eliminar este producto? Esta acción no se puede deshacer.",DELETE_PROVIDER:"¿Estás seguro de que deseas eliminar este proveedor?",PROCESS_SALE:"¿Confirmar venta?",CREATE_SAMPLE_DATA:"¿Crear productos de ejemplo? Esto agregará productos de prueba a la base de datos."}},TD=({isOpen:t,onClose:e,onAddItem:r})=>{const[n,s]=T.useState({name:"",price:"",quantity:1,size:""}),[i,o]=T.useState({}),l=()=>{const f={};return n.name.trim()||(f.name="El nombre es requerido"),(!n.price||n.price<=0)&&(f.price="El precio debe ser mayor a 0"),(!n.quantity||n.quantity<=0)&&(f.quantity="La cantidad debe ser mayor a 0"),o(f),Object.keys(f).length===0},u=f=>{if(f.preventDefault(),!l())return;const p={name:n.name.trim(),price:parseFloat(n.price),quantity:parseInt(n.quantity),size:n.size.trim()||null};r(p),d()},d=()=>{s({name:"",price:"",quantity:1,size:""}),o({}),e()},h=(f,p)=>{s(b=>({...b,[f]:p})),i[f]&&o(b=>({...b,[f]:""}))};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Agregar Artículo Rápido"]}),a.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("form",{onSubmit:u,className:"p-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Artículo *"}),a.jsx("input",{type:"text",value:n.name,onChange:f=>h("name",f.target.value),className:`w-full input-rosema ${i.name?"border-red-500":""}`,placeholder:"Ej: Remera básica",maxLength:100}),i.name&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio de Venta *"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),a.jsx("input",{type:"number",value:n.price,onChange:f=>h("price",f.target.value),className:`w-full input-rosema pl-8 ${i.price?"border-red-500":""}`,placeholder:"0",min:"0",step:"0.01"})]}),i.price&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.price})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad *"}),a.jsx("input",{type:"number",value:n.quantity,onChange:f=>h("quantity",f.target.value),className:`w-full input-rosema ${i.quantity?"border-red-500":""}`,placeholder:"1",min:"1",max:"999"}),i.quantity&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.quantity})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Talla (Opcional)"}),a.jsx("input",{type:"text",value:n.size,onChange:f=>h("size",f.target.value),className:"w-full input-rosema",placeholder:"Ej: M, L, XL, 38, 40",maxLength:10})]})]}),a.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Artículo Rápido"}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Este artículo no se registrará en el inventario. Es ideal para productos únicos o servicios."})]})]})}),a.jsxs("div",{className:"flex space-x-3 mt-6",children:[a.jsx("button",{type:"button",onClick:d,className:"flex-1 btn-secondary",children:"Cancelar"}),a.jsx("button",{type:"submit",className:"flex-1 btn-rosema",children:"Agregar al Carrito"})]})]})]})}):null},ID=({sale:t,onPrint:e,onClose:r,show:n=!1})=>{const s=l=>typeof l!="number"?"$0":`$${l.toLocaleString()}`,i=l=>l?new Date(l).toLocaleString("es-AR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):new Date().toLocaleString("es-AR"),o=()=>{window.print(),e&&e()};return!n||!t?null:a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md max-h-90vh overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 print:hidden",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Vista Previa del Recibo"}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx("span",{className:"text-2xl",children:"×"})})]}),a.jsxs("div",{id:"receipt-content",className:"p-6 print:p-4",children:[a.jsxs("div",{className:"text-center mb-6 print:mb-4",children:[a.jsx("div",{className:"mx-auto w-16 h-16 bg-red-600 rounded-full flex items-center justify-center mb-3 print:w-12 print:h-12 print:mb-2",children:a.jsx("span",{className:"text-white text-2xl font-bold print:text-xl",children:"R"})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 print:text-xl",children:"ROSEMA"}),a.jsx("p",{className:"text-sm text-gray-600 print:text-xs",children:"Moda Familiar"}),a.jsxs("div",{className:"mt-3 text-sm text-gray-600 print:text-xs print:mt-2",children:[a.jsx("p",{children:"Salto de las Rosas"}),a.jsx("p",{children:"WhatsApp: 260 438-1502"})]})]}),a.jsxs("div",{className:"border-t border-b border-gray-300 py-3 mb-4 print:py-2 print:mb-3",children:[a.jsxs("div",{className:"flex justify-between text-sm print:text-xs",children:[a.jsx("span",{children:"Venta #:"}),a.jsx("span",{className:"font-medium",children:t.saleNumber||"N/A"})]}),a.jsxs("div",{className:"flex justify-between text-sm print:text-xs",children:[a.jsx("span",{children:"Fecha:"}),a.jsx("span",{children:i(t.createdAt||t.saleDate)})]}),a.jsxs("div",{className:"flex justify-between text-sm print:text-xs",children:[a.jsx("span",{children:"Método de Pago:"}),a.jsx("span",{className:"capitalize",children:t.paymentMethod||"Efectivo"})]}),t.customerName&&a.jsxs("div",{className:"flex justify-between text-sm print:text-xs",children:[a.jsx("span",{children:"Cliente:"}),a.jsx("span",{children:t.customerName})]})]}),a.jsxs("div",{className:"mb-4 print:mb-3",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-2 print:text-sm print:mb-1",children:"Detalle de Productos"}),a.jsx("div",{className:"space-y-2 print:space-y-1",children:Array.isArray(t.items)&&t.items.map((l,u)=>{const d=l.quantity||l.qty||1,h=l.name||l.nombre||"Producto",f=l.price||0,p=l.talle||l.variant&&l.variant.talle,b=l.color||l.variant&&l.variant.color,_=l.code||l.id||"N/A";return a.jsxs("div",{className:"text-sm print:text-xs",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-medium",children:h}),a.jsx("span",{children:s(f*d)})]}),a.jsx("div",{className:"flex justify-between text-gray-600 ml-2",children:a.jsxs("span",{children:[d," x ",s(f),p&&` • Talle: ${p}`,b&&` • Color: ${b}`,l.isReturn&&" • DEVOLUCIÓN",l.isQuickItem&&" • ARTÍCULO RÁPIDO"]})}),_!=="N/A"&&a.jsxs("div",{className:"text-xs text-gray-500 ml-2",children:["Código: ",_]})]},u)})}),(!Array.isArray(t.items)||t.items.length===0)&&a.jsx("div",{className:"text-center py-4 text-gray-500",children:a.jsx("p",{children:"No hay productos en esta venta"})})]}),a.jsx("div",{className:"border-t border-gray-300 pt-3 mb-4 print:pt-2 print:mb-3",children:a.jsxs("div",{className:"space-y-1 text-sm print:text-xs",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{children:s(t.subtotal||0)})]}),(t.discount&&t.discount>0||t.discountValue&&t.discountValue>0)&&a.jsxs("div",{className:"flex justify-between text-green-600",children:[a.jsx("span",{children:"Descuento:"}),a.jsxs("span",{children:["-",s(t.discount||t.discountValue||0)]})]}),a.jsxs("div",{className:"flex justify-between font-bold text-lg border-t border-gray-300 pt-2 print:text-base print:pt-1",children:[a.jsx("span",{children:"TOTAL:"}),a.jsx("span",{children:s(t.total||0)})]})]})}),a.jsxs("div",{className:"text-center text-sm text-gray-600 print:text-xs",children:[a.jsxs("div",{className:"border border-gray-300 rounded p-3 mb-3 print:p-2 print:mb-2",children:[a.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"POLÍTICA DE CAMBIOS"}),a.jsx("p",{children:"Cambios en 3 días hábiles"}),a.jsx("p",{children:"Presentar este recibo"}),a.jsx("p",{children:"Producto en perfecto estado"})]}),a.jsx("p",{className:"text-xs text-gray-500 print:text-xs",children:"¡Gracias por su compra!"}),a.jsx("p",{className:"text-xs text-gray-500 print:text-xs",children:"Síguenos en redes sociales"})]}),a.jsxs("div",{className:"text-center mt-4 print:mt-3",children:[a.jsx("div",{className:"inline-block w-16 h-16 bg-gray-200 rounded print:w-12 print:h-12",children:a.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-500",children:"QR"})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Escanea para contactarnos"})]})]}),a.jsxs("div",{className:"flex space-x-3 p-4 border-t border-gray-200 print:hidden",children:[a.jsx("button",{onClick:r,className:"flex-1 px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-colors",children:"Cerrar"}),a.jsxs("button",{onClick:o,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors flex items-center justify-center space-x-2",children:[a.jsx("span",{children:"🖨"}),a.jsx("span",{children:"Imprimir"})]})]})]})}),a.jsx("style",{jsx:!0,children:`
        @media print {
          body * {
            visibility: hidden;
          }
          
          #receipt-content,
          #receipt-content * {
            visibility: visible;
          }
          
          #receipt-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            max-width: 300px;
            margin: 0;
            padding: 10px;
            font-size: 12px;
            line-height: 1.3;
          }
          
          .print\\:hidden {
            display: none !important;
          }
          
          .print\\:text-xs {
            font-size: 10px !important;
          }
          
          .print\\:text-sm {
            font-size: 11px !important;
          }
          
          .print\\:text-base {
            font-size: 12px !important;
          }
          
          .print\\:text-xl {
            font-size: 16px !important;
          }
          
          .print\\:w-12 {
            width: 3rem !important;
          }
          
          .print\\:h-12 {
            height: 3rem !important;
          }
          
          .print\\:mb-1 {
            margin-bottom: 0.25rem !important;
          }
          
          .print\\:mb-2 {
            margin-bottom: 0.5rem !important;
          }
          
          .print\\:mb-3 {
            margin-bottom: 0.75rem !important;
          }
          
          .print\\:mt-3 {
            margin-top: 0.75rem !important;
          }
          
          .print\\:p-2 {
            padding: 0.5rem !important;
          }
          
          .print\\:p-4 {
            padding: 1rem !important;
          }
          
          .print\\:py-2 {
            padding-top: 0.5rem !important;
            padding-bottom: 0.5rem !important;
          }
          
          .print\\:pt-1 {
            padding-top: 0.25rem !important;
          }
          
          .print\\:space-y-1 > * + * {
            margin-top: 0.25rem !important;
          }
        }
      `})]})},sN=({isOpen:t,onClose:e,saleData:r})=>{if(!t||!r)return null;const n=()=>{window.print()},s={saleNumber:r.saleNumber||`VENTA-${Date.now()}`,createdAt:r.saleDate||r.createdAt||new Date,paymentMethod:r.paymentMethod||"Efectivo",customerName:r.customerName||"",items:Array.isArray(r.items)?r.items.map(i=>({name:i.name||i.nombre||"Producto",code:i.code||i.id||"N/A",quantity:i.quantity||i.qty||1,price:i.price||0,talle:i.talle||i.variant&&i.variant.talle,color:i.color||i.variant&&i.variant.color,isReturn:i.isReturn||!1,isQuickItem:i.isQuickItem||!1})):[],subtotal:r.subtotal||0,discount:r.discount||r.discountValue||0,total:r.total||0,cashReceived:r.cashReceived||0,change:r.change||0};return a.jsx(ID,{sale:s,show:t,onClose:e,onPrint:n})},kD=({isOpen:t,onClose:e})=>{var V,L,O,H,q,J;const{salesHistory:r,loading:n,loadSalesHistory:s,searchSalesHistory:i,deleteSaleFromHistory:o}=tN(),[l,u]=T.useState(""),[d,h]=T.useState(null),[f,p]=T.useState(null),[b,_]=T.useState(!1),[k,P]=T.useState(null),[N,w]=T.useState(""),[S,R]=T.useState(""),[M,$]=T.useState("all");T.useEffect(()=>{t&&s({limit:50})},[t,s]);const E=async(A=l)=>{u(A),A.trim()?await i(A):x()},x=async()=>{const A={limit:50};if(N&&(A.startDate=new Date(N)),S){const Q=new Date(S);Q.setHours(23,59,59,999),A.endDate=Q}M!=="all"&&(A.paymentMethod=M),await s(A)},v=()=>{w(""),R(""),$("all"),u(""),s({limit:50})},y=A=>A?(A instanceof Date?A:new Date(A)).toLocaleDateString("es-AR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Fecha no disponible",D=A=>({Efectivo:"bg-green-100 text-green-800",Transferencia:"bg-blue-100 text-blue-800",Débito:"bg-purple-100 text-purple-800",Crédito:"bg-orange-100 text-orange-800",QR:"bg-gray-100 text-gray-800"})[A]||"bg-gray-100 text-gray-800",I=async A=>{try{await o(A),p(null),alert("Venta eliminada exitosamente")}catch(Q){alert(`Error al eliminar venta: ${Q.message}`)}},j=A=>A.paymentMethod==="Efectivo"?A.cashReceived||A.total:["Crédito","Débito","QR"].includes(A.paymentMethod)&&A.commission?A.total-A.total*A.commission/100:A.total,te=A=>{var ae;const Q={saleNumber:A.id.slice(-8).toUpperCase(),items:((ae=A.items)==null?void 0:ae.map(le=>({name:le.name,quantity:le.quantity,price:le.price})))||[],customerName:A.customerName,paymentMethod:A.paymentMethod,subtotal:A.subtotal,discount:A.discount,total:A.total,cashReceived:A.cashReceived,change:A.change,saleDate:A.saleDate};P(Q),_(!0)},B=()=>{u(""),h(null),p(null),_(!1),P(null),e()};return t?a.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Historial de Ventas"]}),a.jsx("button",{onClick:B,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de inicio"}),a.jsx("input",{type:"date",value:N,onChange:A=>w(A.target.value),className:"w-full input-rosema"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de fin"}),a.jsx("input",{type:"date",value:S,onChange:A=>R(A.target.value),className:"w-full input-rosema"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Método de pago"}),a.jsxs("select",{value:M,onChange:A=>$(A.target.value),className:"w-full input-rosema",children:[a.jsx("option",{value:"all",children:"Todos los métodos"}),a.jsx("option",{value:"Efectivo",children:"Efectivo"}),a.jsx("option",{value:"Transferencia",children:"Transferencia"}),a.jsx("option",{value:"Débito",children:"Débito"}),a.jsx("option",{value:"Crédito",children:"Crédito"}),a.jsx("option",{value:"QR",children:"QR"})]})]})]}),a.jsxs("div",{className:"flex space-x-3 mb-4",children:[a.jsxs("button",{onClick:x,className:"btn-rosema flex items-center space-x-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"})}),a.jsx("span",{children:"Aplicar Filtros"})]}),a.jsxs("button",{onClick:v,className:"btn-secondary flex items-center space-x-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),a.jsx("span",{children:"Limpiar"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Buscar por cliente o N° Venta...",value:l,onChange:A=>E(A.target.value),className:"w-full input-rosema pl-10"}),a.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:n?a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando historial..."})]}):r.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("p",{children:"No hay ventas registradas"}),a.jsx("p",{className:"text-sm",children:"Las ventas aparecerán aquí una vez que proceses la primera venta"})]}):a.jsx("div",{className:"divide-y divide-gray-200",children:r.map(A=>{var Q,ae,le,ee,ue,ye;return a.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:A.customerName||"Cliente sin nombre"}),a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${D(A.paymentMethod)}`,children:A.paymentMethod}),a.jsx("span",{className:"text-sm text-gray-500",children:y(A.saleDate)})]}),a.jsx("div",{className:"mb-2",children:a.jsxs("span",{className:"text-xs text-gray-500",children:["N° Venta: ",A.id.slice(-8).toUpperCase()]})}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[((Q=A.items)==null?void 0:Q.length)||0," artículo(s):"]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[(ae=A.items)==null?void 0:ae.slice(0,3).map((tt,Bt)=>a.jsxs("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:[tt.quantity,"x ",tt.name]},Bt)),((le=A.items)==null?void 0:le.length)>3&&a.jsxs("span",{className:"text-xs text-gray-400",children:["+",A.items.length-3," más"]})]})]}),a.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[a.jsxs("span",{className:"text-gray-600",children:["Subtotal: $",((ee=A.subtotal)==null?void 0:ee.toLocaleString())||"0"]}),A.discount>0&&a.jsxs("span",{className:"text-orange-600",children:["Descuento: -$",(ue=A.discount)==null?void 0:ue.toLocaleString()]}),a.jsxs("span",{className:"font-semibold text-green-600",children:["Total: $",((ye=A.total)==null?void 0:ye.toLocaleString())||"0"]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[a.jsxs("button",{onClick:()=>te(A),className:"text-green-600 hover:text-green-700 text-sm font-medium flex items-center space-x-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),a.jsx("span",{children:"Imprimir"})]}),a.jsx("button",{onClick:()=>h(A),className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Ver Detalle"}),a.jsx("button",{onClick:()=>p(A.id),className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"Eliminar"})]})]})},A.id)})})}),a.jsx("div",{className:"p-6 border-t border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:"text-sm text-gray-500",children:[r.length," venta(s) encontrada(s)"]}),a.jsx("button",{onClick:B,className:"btn-secondary",children:"Cerrar"})]})})]}),d&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Detalle de Venta"}),a.jsx("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500",children:"N° Venta"}),a.jsx("p",{className:"text-gray-900 font-mono",children:d.id.slice(-8).toUpperCase()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Cliente"}),a.jsx("p",{className:"text-gray-900",children:d.customerName||"Sin nombre"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Fecha"}),a.jsx("p",{className:"text-gray-900",children:y(d.saleDate)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Método de Pago"}),a.jsx("p",{className:"text-gray-900",children:d.paymentMethod})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Total"}),a.jsxs("p",{className:"text-green-600 font-semibold",children:["$",(V=d.total)==null?void 0:V.toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Dinero Recibido"}),a.jsxs("p",{className:"text-blue-600 font-semibold",children:["$",((L=j(d))==null?void 0:L.toLocaleString())||"0"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-500 mb-2 block",children:"Artículos"}),a.jsx("div",{className:"space-y-2",children:(O=d.items)==null?void 0:O.map((A,Q)=>{var ae;return a.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:A.name}),A.code&&a.jsxs("p",{className:"text-sm text-gray-500",children:["Código: ",A.code]}),(A.size||A.color)&&a.jsxs("p",{className:"text-sm text-gray-500",children:[A.size&&`Talle: ${A.size}`,A.size&&A.color&&" | ",A.color&&`Color: ${A.color}`]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-medium text-gray-900",children:[A.quantity," x $",(ae=A.price)==null?void 0:ae.toLocaleString()]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["$",(A.price*A.quantity).toLocaleString()]})]})]},Q)})})]}),a.jsx("div",{className:"border-t border-gray-200 pt-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsxs("span",{className:"text-gray-900",children:["$",(H=d.subtotal)==null?void 0:H.toLocaleString()]})]}),d.discount>0&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Descuento:"}),a.jsxs("span",{className:"text-orange-600",children:["-$",(q=d.discount)==null?void 0:q.toLocaleString()]})]}),a.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[a.jsx("span",{className:"text-gray-900",children:"Total:"}),a.jsxs("span",{className:"text-green-600",children:["$",(J=d.total)==null?void 0:J.toLocaleString()]})]})]})})]})]})})}),f&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("svg",{className:"w-6 h-6 text-red-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Confirmar Eliminación"})]}),a.jsx("p",{className:"text-gray-600 mb-6",children:"¿Estás seguro de que deseas eliminar esta venta? Esta acción no se puede deshacer."}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:()=>p(null),className:"flex-1 btn-secondary",children:"Cancelar"}),a.jsx("button",{onClick:()=>I(f),className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:"Eliminar"})]})]})})}),b&&k&&a.jsx(sN,{isOpen:b,onClose:()=>_(!1),saleData:k})]}):null},PD=({product:t,show:e,onClose:r,onAddReturn:n})=>{var h;const[s,i]=T.useState(null),[o,l]=T.useState(0),u=()=>{if(!s){alert("Por favor seleccione la variante devuelta");return}if(o<0||o>100){alert("El descuento debe estar entre 0% y 100%");return}const f=s.precioVenta,p=f*o/100,b=f-p,_={productId:t.id,nombre:t.articulo,code:t.id,price:b,originalPrice:f,discountApplied:o,quantity:1,variant:{talle:s.talle,color:s.color},isReturn:!0};n(_),d()},d=()=>{i(null),l(0),r()};return!e||!t?null:a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Cambio de Prenda"}),a.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:t.articulo}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Código: ",t.id]}),a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"* Se pueden seleccionar variantes sin stock para devoluciones"})]}),t.variantes&&t.variantes.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Variante Devuelta *"}),a.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:t.variantes.map((f,p)=>{var b;return a.jsx("button",{onClick:()=>i(f),className:`w-full p-4 text-left rounded-lg border transition-colors ${s===f?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-gray-300 hover:border-red-300"}`,children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium",children:["Talle: ",f.talle,f.color&&` • Color: ${f.color}`]}),a.jsxs("div",{className:"text-lg font-semibold text-green-600",children:["$",(b=f.precioVenta)==null?void 0:b.toLocaleString()]})]}),a.jsxs("div",{className:`text-sm ${f.stock<=0?"text-red-600":"text-gray-600"}`,children:["Stock: ",f.stock,f.stock<=0&&a.jsx("span",{className:"block text-xs text-red-500",children:"Sin stock"})]})]})},p)})})]}),s&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descuento Aplicado (opcional)"}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"number",value:o,onChange:f=>l(Math.max(0,Math.min(100,Number(f.target.value)||0))),className:"flex-1 input-rosema",placeholder:"0",min:"0",max:"100"}),a.jsx("span",{className:"text-sm text-gray-500",children:"%"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Si el producto fue vendido con descuento, ingrese el porcentaje aplicado"})]}),s&&a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a.jsxs("div",{className:"text-sm text-yellow-800 space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Precio de lista:"}),a.jsxs("span",{children:["$",(h=s.precioVenta)==null?void 0:h.toLocaleString()]})]}),o>0&&a.jsxs("div",{className:"flex justify-between text-red-600",children:[a.jsxs("span",{children:["Descuento (",o,"%):"]}),a.jsxs("span",{children:["-$",(s.precioVenta*o/100).toLocaleString()]})]}),a.jsxs("div",{className:"flex justify-between font-medium border-t border-yellow-300 pt-1",children:[a.jsx("span",{children:"Valor de devolución:"}),a.jsxs("span",{children:["$",(s.precioVenta-s.precioVenta*o/100).toLocaleString()]})]})]})}),(!t.variantes||t.variantes.length===0)&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),a.jsx("p",{children:"No hay variantes disponibles"}),a.jsx("p",{className:"text-sm",children:"Este producto no tiene variantes configuradas"})]})]}),a.jsxs("div",{className:"flex space-x-3 p-6 border-t border-gray-200",children:[a.jsx("button",{onClick:d,className:"flex-1 btn-secondary",children:"Cancelar"}),a.jsx("button",{onClick:u,disabled:!s,className:"flex-1 btn-rosema disabled:opacity-50 disabled:cursor-not-allowed",children:"Procesar Devolución"})]})]})})},AD=({isOpen:t,onClose:e,onAddReturn:r})=>{const{loading:n,searchProductsByTerm:s}=Su(),[i,o]=T.useState(""),[l,u]=T.useState([]),[d,h]=T.useState(!1),[f,p]=T.useState(null),[b,_]=T.useState(!1),k=async S=>{if(o(S),S.trim())try{const R=await s(S);u(R),h(!0)}catch(R){console.error("Error en búsqueda:",R),u([]),h(!1)}else u([]),h(!1)},P=S=>{if(console.log("📦 Producto seleccionado para devolución:",S),!S.variantes||S.variantes.length===0){alert("El producto no tiene variantes disponibles");return}p(S),_(!0),o(""),u([]),h(!1)},N=S=>{console.log("✅ Devolución procesada:",S),r(S),_(!1),p(null)},w=()=>{o(""),u([]),h(!1),p(null),_(!1),e()};return t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("span",{className:"text-red-600 mr-2",children:"🔄"}),"Cambio de Prenda"]}),a.jsx("button",{onClick:w,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx("span",{className:"text-2xl",children:"×"})})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"text-blue-600 mt-0.5 mr-2",children:"ℹ️"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Flujo de Cambio de Prenda"}),a.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["1. Escanee o busque el código de barras del producto a devolver",a.jsx("br",{}),"2. Seleccione la variante exacta (talle y color)",a.jsx("br",{}),"3. Configure el descuento aplicado si corresponde",a.jsx("br",{}),"4. El stock se incrementará automáticamente al finalizar"]})]})]})}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Buscar Producto a Devolver"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Escanee o escriba el código de barras del producto...",value:i,onChange:S=>k(S.target.value),className:"w-full input-rosema pl-10"}),a.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:"🔍"}),d&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:n?a.jsxs("div",{className:"p-4 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-red-600 mx-auto"}),a.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Buscando productos..."})]}):l.length===0?a.jsx("div",{className:"p-4 text-center text-gray-500",children:a.jsx("p",{children:"No se encontraron productos"})}):a.jsx("div",{className:"divide-y divide-gray-200",children:l.map(S=>{var R;return a.jsx("div",{onClick:()=>P(S),className:"p-4 hover:bg-gray-50 cursor-pointer transition-colors",children:a.jsx("div",{className:"flex justify-between items-start",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:S.articulo||S.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Código: ",S.id]}),a.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[a.jsx("span",{className:"text-lg font-semibold text-green-600",children:S.variantes&&S.variantes.length>0?`$${Math.min(...S.variantes.map(M=>M.precioVenta)).toLocaleString()} - $${Math.max(...S.variantes.map(M=>M.precioVenta)).toLocaleString()}`:"Sin precio"}),a.jsxs("span",{className:"text-sm text-gray-600",children:[((R=S.variantes)==null?void 0:R.length)||0," variantes"]})]})]})})},S.id)})})})]})]}),a.jsx("div",{className:"mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("span",{className:"text-orange-600 mt-0.5 mr-2",children:"⚠️"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-orange-800 font-medium",children:"Política de Cambios"}),a.jsxs("p",{className:"text-xs text-orange-700 mt-1",children:["• Se pueden seleccionar variantes sin stock (para devoluciones)",a.jsx("br",{}),"• El valor se ajusta según el descuento aplicado en la venta original",a.jsx("br",{}),"• El stock se incrementa automáticamente al finalizar la operación"]})]})]})}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:w,className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-colors",children:"Cerrar"})})]})]})}),a.jsx(PD,{product:f,show:b,onClose:()=>{_(!1),p(null)},onAddReturn:N})]}):null},RD=({product:t,show:e,onClose:r,onAddToCart:n})=>{var f;const[s,i]=T.useState(null),[o,l]=T.useState(1),u=()=>{if(!s){alert("Por favor seleccione una variante");return}if(o>s.stock){alert(`Stock insuficiente. Disponible: ${s.stock}`);return}if(o<=0){alert("La cantidad debe ser mayor a 0");return}n(t,o,s),d()},d=()=>{i(null),l(1),r()};if(!e||!t)return null;const h=((f=t.variantes)==null?void 0:f.filter(p=>p.stock>0))||[];return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Seleccionar Opciones"}),a.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:t.articulo||t.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Código: ",t.id]}),h.length===0&&a.jsx("p",{className:"text-sm text-red-600 mt-1",children:"Sin variantes disponibles"})]}),h.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Variantes Disponibles *"}),a.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:h.map((p,b)=>{var _;return a.jsx("button",{onClick:()=>i(p),className:`w-full p-4 text-left rounded-lg border transition-colors ${s===p?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-gray-300 hover:border-red-300"}`,children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium",children:["Talle: ",p.talle,p.color&&` • Color: ${p.color}`]}),a.jsxs("div",{className:"text-lg font-semibold text-green-600",children:["$",(_=p.precioVenta)==null?void 0:_.toLocaleString()]})]}),a.jsxs("div",{className:`text-sm ${p.stock<=5?"text-red-600":"text-gray-600"}`,children:["Stock: ",p.stock]})]})},b)})})]}),s&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cantidad"}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("button",{onClick:()=>l(Math.max(1,o-1)),className:"w-8 h-8 flex items-center justify-center bg-gray-200 hover:bg-gray-300 rounded-full transition-colors",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),a.jsx("span",{className:"w-12 text-center font-medium text-lg",children:o}),a.jsx("button",{onClick:()=>l(Math.min(s.stock,o+1)),className:"w-8 h-8 flex items-center justify-center bg-gray-200 hover:bg-gray-300 rounded-full transition-colors",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Stock disponible: ",s.stock]})]}),s&&a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-medium text-gray-900",children:"Total:"}),a.jsxs("span",{className:"text-xl font-bold text-green-600",children:["$",(s.precioVenta*o).toLocaleString()]})]})}),h.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),a.jsx("p",{children:"No hay variantes disponibles"}),a.jsx("p",{className:"text-sm",children:"Todas las variantes están sin stock"})]})]}),a.jsxs("div",{className:"flex space-x-3 p-6 border-t border-gray-200",children:[a.jsx("button",{onClick:d,className:"flex-1 btn-secondary",children:"Cancelar"}),a.jsx("button",{onClick:u,disabled:!s||h.length===0,className:"flex-1 btn-rosema disabled:opacity-50 disabled:cursor-not-allowed",children:"Agregar al Carrito"})]})]})})},iN=({value:t,onChange:e,onClear:r,placeholder:n="Buscar...",className:s="",disabled:i=!1,autoFocus:o=!1})=>{const l=h=>{e(h.target.value)},u=()=>{r?r():e("")},d=h=>{h.key==="Escape"&&u()};return a.jsxs("div",{className:`relative ${s}`,children:[a.jsx("input",{type:"text",value:t,onChange:l,onKeyDown:d,placeholder:n,disabled:i,autoFocus:o,className:"w-full input-rosema pl-10 pr-10"}),a.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm font-medium",children:"🔍"}),t&&a.jsx("button",{type:"button",onClick:u,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",title:"Limpiar búsqueda",children:a.jsx("span",{className:"text-lg",children:"×"})})]})},aN=({size:t="md",color:e="red",text:r="Cargando...",showText:n=!0,className:s=""})=>{const i={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12",xl:"h-16 w-16"},o={red:"border-red-600",blue:"border-blue-600",green:"border-green-600",gray:"border-gray-600"},l=i[t]||i.md,u=o[e]||o.red;return a.jsxs("div",{className:`flex flex-col items-center justify-center ${s}`,children:[a.jsx("div",{className:`animate-spin rounded-full border-b-2 ${l} ${u} mb-4`}),n&&r&&a.jsx("p",{className:"text-gray-600 text-center",children:r})]})},DD=({searchTerm:t,searchResults:e,showResults:r,productsLoading:n,productStats:s,onSearch:i,onProductSelect:o,onCreateSampleData:l,onQuickItemClick:u})=>a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("span",{className:"text-xl mr-2",children:"🔍"}),"Buscar Productos"]}),a.jsxs("button",{onClick:u,className:"btn-rosema text-sm flex items-center space-x-1",children:[a.jsx("span",{children:"➕"}),a.jsx("span",{children:"Artículo Rápido"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(iN,{value:t,onChange:i,placeholder:"Buscar por código o nombre del producto..."}),r&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-96 overflow-y-auto",children:n?a.jsx("div",{className:"p-4",children:a.jsx(aN,{size:"sm",text:"Buscando productos..."})}):e.length===0?a.jsxs("div",{className:"p-4 text-center text-gray-500",children:[a.jsx("p",{children:"No se encontraron productos"}),s.totalProducts===0&&a.jsx("button",{onClick:l,className:"mt-2 text-sm text-red-600 hover:text-red-700 underline",children:"Crear productos de ejemplo"})]}):a.jsx("div",{className:"divide-y divide-gray-200",children:e.map(d=>a.jsx(LD,{product:d,onSelect:()=>o(d)},d.id))})})]})]}),LD=({product:t,onSelect:e})=>{var n;const r=((n=t.variantes)==null?void 0:n.reduce((s,i)=>s+(i.stock||0),0))||0;return a.jsxs("div",{onClick:e,className:`p-4 hover:bg-gray-50 cursor-pointer transition-colors ${r<=0?"opacity-50":""}`,children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:t.articulo||t.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Código: ",t.id]}),a.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[a.jsx("span",{className:"text-lg font-semibold text-green-600",children:_D(t.variantes)}),a.jsxs("span",{className:`text-sm ${r<=5?"text-red-600":"text-gray-600"}`,children:["Stock: ",r]}),t.categoria&&a.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:t.categoria})]})]}),r<=0&&a.jsx("span",{className:"text-xs bg-red-100 text-red-600 px-2 py-1 rounded",children:"Sin Stock"})]}),t.variantes&&t.variantes.length>0&&a.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{className:"text-xs text-gray-500",children:"Variantes:"}),t.variantes.slice(0,3).map((s,i)=>a.jsxs("span",{className:"text-xs bg-blue-100 text-blue-600 px-1 py-0.5 rounded",children:[s.talle,s.color?` - ${s.color}`:""," (",s.stock,")"]},i)),t.variantes.length>3&&a.jsxs("span",{className:"text-xs text-gray-400",children:["+",t.variantes.length-3]})]})})]})},kt=t=>typeof t!="number"?"$0":`$${t.toLocaleString()}`,_a=t=>{if(!t)return"Sin fecha";const e=t.seconds?new Date(t.seconds*1e3):new Date(t);return{date:e.toLocaleDateString("es-ES"),time:e.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}},OD=({sessions:t,activeSessionId:e,onSessionChange:r,onDeleteSession:n,onNewSession:s})=>a.jsxs("div",{className:"flex space-x-2 mb-6",children:[t.map(i=>a.jsx(VD,{session:i,isActive:e===i.id,canDelete:t.length>1,onSelect:()=>r(i.id),onDelete:()=>n(i.id)},i.id)),a.jsxs("button",{onClick:s,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-t-lg font-medium transition-colors flex items-center space-x-1",title:"Nueva venta",children:[a.jsx("span",{children:"➕"}),a.jsx("span",{children:"Nueva"})]})]}),VD=({session:t,isActive:e,canDelete:r,onSelect:n,onDelete:s})=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("button",{onClick:n,className:`px-4 py-2 rounded-t-lg font-medium transition-colors ${e?"bg-gray-800 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:t.name}),a.jsxs("div",{className:`flex items-center px-2 py-2 ${e?"bg-gray-800":"bg-gray-200"} rounded-t-lg`,children:[a.jsx("span",{className:`text-sm mr-2 ${e?"text-white":"text-gray-600"}`,children:kt(t.total)}),r&&a.jsx("button",{onClick:s,className:`w-5 h-5 rounded-full flex items-center justify-center transition-colors ${e?"bg-red-600 hover:bg-red-700 text-white":"bg-red-500 hover:bg-red-600 text-white"}`,title:"Eliminar sesión",children:a.jsx("span",{className:"text-xs",children:"×"})})]})]}),MD=({paymentMethod:t,discountPercent:e,cashReceived:r,cardName:n,installments:s,commission:i,totals:o,onPaymentMethodChange:l,onDiscountChange:u,onCashReceivedChange:d,onCardNameChange:h,onInstallmentsChange:f,onCommissionChange:p})=>{const b=wD(o.total,i);return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Método de Pago"}),a.jsx("select",{value:t,onChange:_=>l(_.target.value),className:"w-full input-rosema",children:ED.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descuento"}),a.jsx("select",{value:e,onChange:_=>u(Number(_.target.value)),className:"w-full input-rosema",children:jD.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))})]}),o.subtotal>0&&a.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{children:kt(o.subtotal)})]}),o.discountValue>0&&a.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[a.jsxs("span",{children:["Descuento (",e,"%):"]}),a.jsxs("span",{children:["-",kt(o.discountValue)]})]})]}),t==="Efectivo"&&a.jsx(FD,{cashReceived:r,totals:o,onCashReceivedChange:d}),t==="Crédito"&&a.jsx(UD,{cardName:n,installments:s,commission:i,totals:o,commissionInfo:b,onCardNameChange:h,onInstallmentsChange:f,onCommissionChange:p}),(t==="Débito"||t==="QR")&&a.jsx(BD,{commission:i,totals:o,commissionInfo:b,onCommissionChange:p}),a.jsx("div",{className:"border-t border-gray-200 pt-4",children:a.jsxs("div",{className:"flex justify-between items-center text-2xl font-bold",children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{className:"text-green-600",children:kt(o.total)})]})})]})},FD=({cashReceived:t,totals:e,onCashReceivedChange:r})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recibido en Efectivo"}),a.jsx("input",{type:"number",value:t||"",onChange:n=>r(Number(n.target.value)||0),className:"w-full input-rosema",placeholder:"Ingrese monto recibido"})]}),a.jsx("div",{children:a.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[a.jsx("span",{children:"Vuelto:"}),a.jsx("span",{className:e.change>=0?"text-green-600":"text-red-600",children:kt(e.change)})]})})]}),UD=({cardName:t,installments:e,commission:r,totals:n,commissionInfo:s,onCardNameChange:i,onInstallmentsChange:o,onCommissionChange:l})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de la Tarjeta"}),a.jsx("input",{type:"text",value:t,onChange:u=>i(u.target.value),className:"w-full input-rosema",placeholder:"Ingrese nombre de la tarjeta",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cuotas sin Interés"}),a.jsx("input",{type:"number",value:e||"",onChange:u=>o(Number(u.target.value)||0),className:"w-full input-rosema",placeholder:"Número de cuotas",min:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comisión (%)"}),a.jsx("input",{type:"number",value:r||"",onChange:u=>l(Number(u.target.value)||0),className:"w-full input-rosema",placeholder:"% de comisión",min:"0",max:"100",step:"0.1"})]})]}),r>0&&a.jsx(oN,{commissionInfo:s})]}),BD=({commission:t,totals:e,commissionInfo:r,onCommissionChange:n})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comisión (%)"}),a.jsx("input",{type:"number",value:t||"",onChange:s=>n(Number(s.target.value)||0),className:"w-full input-rosema",placeholder:"% de comisión",min:"0",max:"100",step:"0.1"})]}),t>0&&a.jsx(oN,{commissionInfo:r})]}),oN=({commissionInfo:t})=>a.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:a.jsxs("div",{className:"text-sm text-yellow-800",children:[a.jsx("p",{className:"font-medium",children:"Información de Comisión:"}),a.jsxs("p",{children:["Comisión: ",kt(t.commissionAmount)]}),a.jsxs("p",{children:["Neto a recibir: ",kt(t.netAmount)]})]})}),$D=({cart:t,customerName:e,onCustomerNameChange:r,onUpdateQuantity:n,onRemoveItem:s})=>a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[a.jsx("span",{className:"text-xl mr-2",children:"🛒"}),"Carrito de Compra"]}),a.jsx("div",{className:"w-8 h-8 bg-gray-800 hover:bg-gray-900 text-white rounded-lg flex items-center justify-center transition-colors",children:a.jsx("span",{className:"text-sm font-bold",children:t.length})})]}),a.jsx("div",{className:"mb-6",children:a.jsx("input",{type:"text",placeholder:"Cliente (Opcional)",value:e,onChange:i=>r(i.target.value),className:"w-full input-rosema"})}),a.jsx("div",{className:"space-y-4 mb-6",children:t.map(i=>a.jsx(zD,{item:i,onUpdateQuantity:n,onRemove:s},i.lineId||i.id))}),t.length===0&&a.jsx(WD,{})]}),zD=({item:t,onUpdateQuantity:e,onRemove:r})=>{var o,l;const n=t.lineId||t.id,s=t.qty||t.quantity||1,i=t.price*s;return a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:t.nombre||t.name}),a.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[a.jsxs("p",{children:["Código: ",t.productId]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"Talle:"})," ",((o=t.variant)==null?void 0:o.talle)||"N/A",((l=t.variant)==null?void 0:l.color)&&a.jsxs("span",{className:"ml-2",children:[a.jsx("span",{className:"font-medium",children:"Color:"})," ",t.variant.color]})]})]}),a.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.jsxs("p",{className:"text-lg font-semibold text-green-600",children:[kt(t.price)," x ",s]}),a.jsxs("p",{className:"text-lg font-bold text-gray-900",children:["= ",kt(i)]})]})]}),a.jsxs("div",{className:"flex items-center space-x-3 ml-4",children:[a.jsx(qD,{quantity:s,onDecrease:()=>e(n,s-1),onIncrease:()=>e(n,s+1)}),a.jsx("button",{onClick:()=>r(n),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center transition-colors",title:"Eliminar producto",children:a.jsx("span",{className:"text-sm",children:"🗑️"})})]})]})},qD=({quantity:t,onDecrease:e,onIncrease:r})=>a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:e,className:"w-8 h-8 bg-gray-200 hover:bg-gray-300 rounded-full flex items-center justify-center transition-colors",title:"Disminuir cantidad",children:a.jsx("span",{className:"text-lg",children:"−"})}),a.jsx("span",{className:"w-8 text-center font-medium",children:t}),a.jsx("button",{onClick:r,className:"w-8 h-8 bg-gray-200 hover:bg-gray-300 rounded-full flex items-center justify-center transition-colors",title:"Aumentar cantidad",children:a.jsx("span",{className:"text-lg",children:"+"})})]}),WD=()=>a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("div",{className:"text-6xl mb-4",children:"🛒"}),a.jsx("p",{children:"El carrito está vacío"}),a.jsx("p",{className:"text-sm",children:"Busca productos para agregar a la venta"})]}),HD=()=>{const{products:t,loading:e,createSampleData:r,getProductStats:n}=Su(),{sessions:s,activeSessionId:i,cart:o,paymentMethod:l,discountPercent:u,cashReceived:d,customerName:h,cardName:f,installments:p,commission:b,totals:_,loading:k,createSession:P,switchSession:N,cancelSession:w,addToCart:S,updateCartItemQuantity:R,removeFromCart:M,finalizeSession:$,setPaymentMethod:E,setDiscountPercent:x,setCashReceived:v,setCustomerName:y,setCardName:D,setInstallments:I,setCommission:j,addQuickItem:te,addReturnItem:B}=tN(),{searchTerm:V,searchResults:L,showResults:O,handleSearch:H,handleProductSelect:q}=bD(t,ue),{openModal:J,closeModal:A,isModalOpen:Q,getModalData:ae}=nN(["quickItem","return","history","print","productSelection"]),le=gD(s),ee=n();function ue(W,U=1,Y=null,de=!1){de?J("productSelection",W):S(W,U,Y)}const ye=(W,U,Y)=>{console.log("✅ Variante seleccionada:",{product:W.articulo,variant:Y,quantity:U}),S(W,U,Y),A("productSelection")},tt=()=>{try{const W=Object.keys(s).length,U=P(`Cliente ${W+1}`);console.log("Nueva sesión creada:",U)}catch(W){console.error("Error al crear nueva venta:",W),alert(`Error al crear nueva venta: ${W.message}`)}},Bt=async()=>{try{const W=yD(o,_);if(!W.isValid){alert(W.message);return}const U=vD(_,l,u);if(!confirm(U))return;const Y=await $(i);alert(ns.SUCCESS.SALE_PROCESSED||"Venta procesada exitosamente"),console.log("Venta completada:",Y)}catch(W){alert(`Error al procesar venta: ${W.message}`)}},xr=()=>{if(o.length===0){alert("No hay productos en el carrito para imprimir");return}const W=xD(o,_,l,h,d);console.log("📄 Datos del recibo preparados:",W),J("print",W)},yr=async()=>{if(confirm(ns.CONFIRM.CREATE_SAMPLE_DATA))try{await r(),alert("Productos de ejemplo creados exitosamente")}catch(W){alert(`Error al crear productos: ${W.message}`)}};return a.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Ventas"}),a.jsx("p",{className:"text-gray-600",children:"Busca productos y agrégalos al carrito para procesar una venta"})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs("button",{onClick:tt,className:"btn-rosema flex items-center space-x-2",children:[a.jsx("span",{children:"➕"}),a.jsx("span",{children:"Nueva Venta"})]}),a.jsxs("button",{onClick:()=>J("history"),className:"btn-secondary flex items-center space-x-2",children:[a.jsx("span",{children:"🕒"}),a.jsx("span",{children:"Historial de Ventas"})]})]})]}),a.jsx(OD,{sessions:le,activeSessionId:i,onSessionChange:N,onDeleteSession:w,onNewSession:tt}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsx(DD,{searchTerm:V,searchResults:L,showResults:O,productsLoading:e,productStats:ee,onSearch:H,onProductSelect:q,onCreateSampleData:yr,onQuickItemClick:()=>J("quickItem")}),a.jsx("button",{onClick:()=>J("return"),className:"w-full bg-gray-800 hover:bg-gray-900 text-white font-medium py-3 px-4 rounded-lg transition-colors",children:"🔄 Realizar Cambio de Prenda"}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center mb-4",children:[a.jsx("span",{className:"text-xl mr-2",children:"💳"}),"Información de Pago"]}),a.jsx(MD,{paymentMethod:l,discountPercent:u,cashReceived:d,cardName:f,installments:p,commission:b,totals:_,onPaymentMethodChange:E,onDiscountChange:x,onCashReceivedChange:v,onCardNameChange:D,onInstallmentsChange:I,onCommissionChange:j}),a.jsxs("div",{className:"flex space-x-3 mt-6",children:[a.jsxs("button",{onClick:xr,className:"flex-1 btn-secondary flex items-center justify-center space-x-2",children:[a.jsx("span",{children:"🖨️"}),a.jsx("span",{children:"Imprimir recibo"})]}),a.jsx("button",{onClick:Bt,disabled:k||o.length===0,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50",children:k?"Procesando...":"💰 Procesar Venta"})]})]})]}),a.jsx($D,{cart:o,customerName:h,onCustomerNameChange:y,onUpdateQuantity:R,onRemoveItem:M})]}),a.jsx(TD,{isOpen:Q("quickItem"),onClose:()=>A("quickItem"),onAddItem:W=>{te(W),A("quickItem")}}),a.jsx(kD,{isOpen:Q("history"),onClose:()=>A("history")}),a.jsx(AD,{isOpen:Q("return"),onClose:()=>A("return"),onAddReturn:W=>{B(W),A("return")}}),a.jsx(sN,{isOpen:Q("print"),onClose:()=>A("print"),saleData:ae("print")}),a.jsx(RD,{product:ae("productSelection"),show:Q("productSelection"),onClose:()=>A("productSelection"),onAddToCart:ye})]},i)},GD=({onSaleComplete:t})=>{var J;const[e,r]=T.useState(""),[n,s]=T.useState([]),[i,o]=T.useState(null),[l,u]=T.useState([]),[d,h]=T.useState(!1),[f,p]=T.useState(!1),[b,_]=T.useState("Efectivo"),[k,P]=T.useState(0),[N,w]=T.useState(""),[S,R]=T.useState(""),[M,$]=T.useState({}),[E,x]=T.useState({}),{providers:v}=Do(),y=T.useRef(null);T.useEffect(()=>{y.current&&y.current.focus()},[]);const D=async A=>{if(r(A),!A.trim()){s([]);return}try{h(!0);const Q=await tD(A.trim());if(Q){o(Q),p(!0),s([]),r("");return}const ae=await eD(A);s(ae)}catch(Q){console.error("Error en búsqueda:",Q),$({search:Q.message})}finally{h(!1)}},I=A=>{o(A),p(!0),s([]),r("")},j=async(A,Q=1)=>{try{if(!(await Yb(i.id,A.talle,A.color,Q)).available){x({[A.talle+A.color]:"Stock insuficiente"});return}const le=v.find(ye=>ye.id===i.proveedorId),ee={id:`${i.id}-${A.talle}-${A.color}`,productId:i.id,productName:i.articulo,articulo:i.articulo,talle:A.talle,color:A.color,price:A.precioVenta||i.precioCosto||0,quantity:Q,subtotal:(A.precioVenta||i.precioCosto||0)*Q,currentStock:A.stock,proveedorId:i.proveedorId,providerName:(le==null?void 0:le.proveedor)||"Sin proveedor",isQuickItem:!1},ue=l.findIndex(ye=>ye.id===ee.id);if(ue>=0){const ye=[...l],tt=ye[ue].quantity+Q;if(tt>A.stock){x({[A.talle+A.color]:`Solo hay ${A.stock} unidades disponibles`});return}ye[ue].quantity=tt,ye[ue].subtotal=ye[ue].price*tt,u(ye)}else u([...l,ee]);x({}),o(null),p(!1),y.current&&y.current.focus()}catch(ae){console.error("Error agregando al carrito:",ae),x({[A.talle+A.color]:ae.message})}},te=A=>{u(l.filter(Q=>Q.id!==A))},B=(A,Q)=>{if(Q<=0){te(A);return}const ae=l.map(le=>le.id===A?Q>le.currentStock?(x({[A]:`Solo hay ${le.currentStock} unidades disponibles`}),le):{...le,quantity:Q,subtotal:le.price*Q}:le);u(ae),x({})},V=()=>{const A=l.reduce((le,ee)=>le+ee.subtotal,0),Q=A*k/100,ae=A-Q;return{subtotal:A,discountAmount:Q,total:ae}},L=async()=>{try{if(l.length===0){$({cart:"El carrito está vacío"});return}const{total:A}=V();if(b==="Efectivo"&&(!N||parseFloat(N)<A)){$({payment:"El monto recibido debe ser mayor o igual al total"});return}h(!0),$({});const Q={items:l,paymentMethod:b,discount:k,total:A,cashReceived:b==="Efectivo"?parseFloat(N):A,change:b==="Efectivo"?parseFloat(N)-A:0,customerName:S.trim()},ae=await Jb(Q);u([]),P(0),w(""),R(""),r(""),o(null),p(!1),t&&t(ae),alert("Venta procesada exitosamente"),y.current&&y.current.focus()}catch(A){console.error("Error procesando venta:",A),$({sale:A.message})}finally{h(!1)}},{subtotal:O,discountAmount:H,total:q}=V();return a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-full",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Buscar Productos"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{ref:y,type:"text",value:e,onChange:A=>D(A.target.value),placeholder:"Escanear código o buscar por nombre...",className:"w-full input-rosema pl-10",autoFocus:!0}),a.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),M.search&&a.jsx("p",{className:"text-red-500 text-sm mt-2",children:M.search}),d&&a.jsx("div",{className:"text-center py-4",children:a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-red-600 mx-auto"})})]}),n.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:["Resultados (",n.length,")"]}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:n.map(A=>{var Q;return a.jsxs("button",{onClick:()=>I(A),className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsx("div",{className:"font-medium",children:A.articulo}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Código: ",A.id]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Variantes: ",((Q=A.variantes)==null?void 0:Q.length)||0]})]},A.id)})})]}),f&&i&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h4",{className:"text-md font-semibold text-gray-900",children:["Seleccionar Variante - ",i.articulo]}),a.jsx("button",{onClick:()=>{p(!1),o(null),x({})},className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:(J=i.variantes)==null?void 0:J.map((A,Q)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium",children:[A.talle," - ",A.color]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Stock: ",A.stock," | Precio: $",(A.precioVenta||0).toLocaleString()]})]}),a.jsx("button",{onClick:()=>j(A,1),disabled:A.stock===0,className:`px-3 py-1 rounded text-sm font-medium ${A.stock===0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,children:A.stock===0?"Sin Stock":"Agregar"})]}),E[A.talle+A.color]&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:E[A.talle+A.color]})]},Q))})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Carrito (",l.length," items)"]}),l.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5H19M7 13v8a2 2 0 002 2h6a2 2 0 002-2v-8m-8 0V9a2 2 0 012-2h4a2 2 0 012 2v4.01"})}),a.jsx("p",{children:"El carrito está vacío"}),a.jsx("p",{className:"text-sm",children:"Busca productos para agregar"})]}):a.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:l.map(A=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium",children:A.productName}),a.jsxs("div",{className:"text-sm text-gray-500",children:[A.talle," - ",A.color," | $",A.price.toLocaleString()]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>B(A.id,A.quantity-1),className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 hover:bg-gray-300",children:"-"}),a.jsx("span",{className:"w-8 text-center",children:A.quantity}),a.jsx("button",{onClick:()=>B(A.id,A.quantity+1),className:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 hover:bg-gray-300",children:"+"}),a.jsx("button",{onClick:()=>te(A.id),className:"text-red-600 hover:text-red-800 ml-2",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),a.jsxs("div",{className:"text-right text-sm font-medium mt-2",children:["Subtotal: $",A.subtotal.toLocaleString()]}),E[A.id]&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:E[A.id]})]},A.id))}),M.cart&&a.jsx("p",{className:"text-red-500 text-sm mt-2",children:M.cart})]}),l.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pago"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente (opcional)"}),a.jsx("input",{type:"text",value:S,onChange:A=>R(A.target.value),className:"w-full input-rosema",placeholder:"Nombre del cliente"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descuento (%)"}),a.jsx("input",{type:"number",value:k,onChange:A=>P(Math.max(0,Math.min(100,parseFloat(A.target.value)||0))),className:"w-full input-rosema",min:"0",max:"100",step:"0.1"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Método de Pago"}),a.jsxs("select",{value:b,onChange:A=>_(A.target.value),className:"w-full input-rosema",children:[a.jsx("option",{value:"Efectivo",children:"Efectivo"}),a.jsx("option",{value:"Tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"Transferencia",children:"Transferencia"})]})]}),b==="Efectivo"&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto Recibido"}),a.jsx("input",{type:"number",value:N,onChange:A=>w(A.target.value),className:"w-full input-rosema",placeholder:"0",min:"0",step:"0.01"}),M.payment&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:M.payment})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Subtotal:"}),a.jsxs("span",{children:["$",O.toLocaleString()]})]}),k>0&&a.jsxs("div",{className:"flex justify-between text-green-600",children:[a.jsxs("span",{children:["Descuento (",k,"%):"]}),a.jsxs("span",{children:["-$",H.toLocaleString()]})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{children:["$",q.toLocaleString()]})]}),b==="Efectivo"&&N&&parseFloat(N)>=q&&a.jsxs("div",{className:"flex justify-between text-blue-600",children:[a.jsx("span",{children:"Cambio:"}),a.jsxs("span",{children:["$",(parseFloat(N)-q).toLocaleString()]})]})]}),M.sale&&a.jsx("p",{className:"text-red-500 text-sm mt-4",children:M.sale}),a.jsx("button",{onClick:L,disabled:d||l.length===0,className:"w-full btn-rosema mt-4 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Procesando...":`Procesar Venta - $${q.toLocaleString()}`})]})]})]})},KD=()=>{var x,v,y,D,I,j,te,B,V;const[t,e]=T.useState([]),[r,n]=T.useState([]),[s,i]=T.useState(!1),[o,l]=T.useState(null),[u,d]=T.useState({}),[h,f]=T.useState({startDate:"",endDate:"",productName:"",providerName:"",paymentMethod:"",customerName:""}),[p,b]=T.useState(1),[_]=T.useState(10);T.useEffect(()=>{k(),P()},[]),T.useEffect(()=>{N()},[t,h]);const k=async()=>{try{i(!0),l(null);const L=await nD();e(L)}catch(L){console.error("Error cargando ventas:",L),l("Error al cargar las ventas")}finally{i(!1)}},P=async()=>{try{const L=await Hl("today"),O=await Hl("week"),H=await Hl("month");d({today:L,week:O,month:H})}catch(L){console.error("Error cargando estadísticas:",L)}},N=()=>{let L=[...t];if(h.startDate){const O=new Date(h.startDate);L=L.filter(H=>new Date(H.createdAt)>=O)}if(h.endDate){const O=new Date(h.endDate);O.setHours(23,59,59,999),L=L.filter(H=>new Date(H.createdAt)<=O)}if(h.productName){const O=h.productName.toLowerCase();L=L.filter(H=>{var q;return(q=H.items)==null?void 0:q.some(J=>{var A,Q;return((A=J.productName)==null?void 0:A.toLowerCase().includes(O))||((Q=J.articulo)==null?void 0:Q.toLowerCase().includes(O))})})}if(h.providerName){const O=h.providerName.toLowerCase();L=L.filter(H=>{var q;return(q=H.items)==null?void 0:q.some(J=>{var A;return(A=J.providerName)==null?void 0:A.toLowerCase().includes(O)})})}if(h.paymentMethod&&(L=L.filter(O=>O.paymentMethod===h.paymentMethod)),h.customerName){const O=h.customerName.toLowerCase();L=L.filter(H=>{var q;return(q=H.customerName)==null?void 0:q.toLowerCase().includes(O)})}n(L),b(1)},w=(L,O)=>{f(H=>({...H,[L]:O}))},S=()=>{f({startDate:"",endDate:"",productName:"",providerName:"",paymentMethod:"",customerName:""})},R=L=>new Date(L).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),M=()=>{const L=(p-1)*_,O=L+_;return r.slice(L,O)},$=Math.ceil(r.length/_),E=M();return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:[a.jsxs("div",{className:"text-3xl font-bold text-green-600 mb-2",children:["$",((v=(x=u.today)==null?void 0:x.totalRevenue)==null?void 0:v.toLocaleString())||0]}),a.jsx("div",{className:"text-gray-600",children:"Ventas Hoy"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[((y=u.today)==null?void 0:y.totalSales)||0," transacciones"]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:[a.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:["$",((I=(D=u.week)==null?void 0:D.totalRevenue)==null?void 0:I.toLocaleString())||0]}),a.jsx("div",{className:"text-gray-600",children:"Esta Semana"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[((j=u.week)==null?void 0:j.totalSales)||0," transacciones"]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:[a.jsxs("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:["$",((B=(te=u.month)==null?void 0:te.totalRevenue)==null?void 0:B.toLocaleString())||0]}),a.jsx("div",{className:"text-gray-600",children:"Este Mes"}),a.jsxs("div",{className:"text-sm text-gray-500",children:[((V=u.month)==null?void 0:V.totalSales)||0," transacciones"]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtros de Búsqueda"}),a.jsx("button",{onClick:S,className:"btn-secondary text-sm",children:"Limpiar Filtros"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Inicio"}),a.jsx("input",{type:"date",value:h.startDate,onChange:L=>w("startDate",L.target.value),className:"w-full input-rosema"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Fin"}),a.jsx("input",{type:"date",value:h.endDate,onChange:L=>w("endDate",L.target.value),className:"w-full input-rosema"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Producto"}),a.jsx("input",{type:"text",value:h.productName,onChange:L=>w("productName",L.target.value),placeholder:"Nombre del producto",className:"w-full input-rosema"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proveedor"}),a.jsx("input",{type:"text",value:h.providerName,onChange:L=>w("providerName",L.target.value),placeholder:"Nombre del proveedor",className:"w-full input-rosema"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Método de Pago"}),a.jsxs("select",{value:h.paymentMethod,onChange:L=>w("paymentMethod",L.target.value),className:"w-full input-rosema",children:[a.jsx("option",{value:"",children:"Todos"}),a.jsx("option",{value:"Efectivo",children:"Efectivo"}),a.jsx("option",{value:"Tarjeta",children:"Tarjeta"}),a.jsx("option",{value:"Transferencia",children:"Transferencia"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente"}),a.jsx("input",{type:"text",value:h.customerName,onChange:L=>w("customerName",L.target.value),placeholder:"Nombre del cliente",className:"w-full input-rosema"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Historial de Ventas (",r.length,")"]}),a.jsxs("button",{onClick:k,className:"btn-secondary flex items-center space-x-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),a.jsx("span",{children:"Actualizar"})]})]})}),s?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Cargando ventas..."})]}):o?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"text-red-600 mb-4",children:a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),a.jsx("p",{className:"text-red-600 mb-4",children:o}),a.jsx("button",{onClick:k,className:"btn-rosema",children:"Reintentar"})]}):r.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),a.jsx("p",{className:"text-gray-600 mb-4",children:"No se encontraron ventas"}),a.jsx("p",{className:"text-sm text-gray-500",children:t.length===0?"No hay ventas registradas":"Intenta ajustar los filtros de búsqueda"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"N° Venta"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Productos"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Método Pago"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(L=>{var O,H;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:R(L.createdAt)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:L.saleNumber||L.id.slice(-8)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:L.customerName||"Cliente general"}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:a.jsxs("div",{className:"max-w-xs",children:[(O=L.items)==null?void 0:O.slice(0,2).map((q,J)=>a.jsxs("div",{className:"truncate",children:[q.quantity,"x ",q.productName||q.articulo,q.talle&&q.color&&a.jsxs("span",{className:"text-gray-500",children:[" (",q.talle,"/",q.color,")"]})]},J)),((H=L.items)==null?void 0:H.length)>2&&a.jsxs("div",{className:"text-gray-500 text-xs",children:["+",L.items.length-2," más..."]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L.paymentMethod==="Efectivo"?"bg-green-100 text-green-800":L.paymentMethod==="Tarjeta"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:L.paymentMethod})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["$",(L.total||0).toLocaleString()]})]},L.id)})})]})}),$>1&&a.jsxs("div",{className:"px-6 py-3 border-t border-gray-200 flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-gray-700",children:["Mostrando ",(p-1)*_+1," a ",Math.min(p*_,r.length)," de ",r.length," ventas"]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>b(L=>Math.max(1,L-1)),disabled:p===1,className:"px-3 py-1 border border-gray-300 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Anterior"}),Array.from({length:Math.min(5,$)},(L,O)=>{const H=O+1;return a.jsx("button",{onClick:()=>b(H),className:`px-3 py-1 border rounded text-sm ${p===H?"bg-red-600 text-white border-red-600":"border-gray-300 hover:bg-gray-50"}`,children:H},H)}),a.jsx("button",{onClick:()=>b(L=>Math.min($,L+1)),disabled:p===$,className:"px-3 py-1 border border-gray-300 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Siguiente"})]})]})]})]})]})},QD=()=>{var i;const[t,e]=T.useState("sales"),[r,n]=T.useState(null),s=o=>{n(o)};return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Sistema de Ventas"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Gestión completa de ventas con productos y variantes"})]}),a.jsxs("div",{className:"flex space-x-4",children:[a.jsx("button",{onClick:()=>e("sales"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${t==="sales"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Nueva Venta"}),a.jsx("button",{onClick:()=>e("history"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${t==="history"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Historial"})]})]})})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:t==="sales"?a.jsx(GD,{onSaleComplete:s}):a.jsx(KD,{})}),r&&a.jsx("div",{className:"fixed bottom-4 right-4 bg-green-600 text-white p-4 rounded-lg shadow-lg max-w-sm",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("svg",{className:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"¡Venta procesada!"}),a.jsxs("p",{className:"text-sm opacity-90",children:["Total: $",(i=r.total)==null?void 0:i.toLocaleString()]})]}),a.jsx("button",{onClick:()=>n(null),className:"ml-4 text-white hover:text-gray-200",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]})},XD=(t,e={},r=[])=>{const{searchTerm:n="",sizeFilter:s="",categoryFilter:i="all",sortBy:o="created",sortOrder:l="asc"}=e;let u=[...t];if(i!=="all"&&(u=u.filter(f=>f.categoria===i)),s.trim()){const f=s.toUpperCase().trim(),b={1:"S",2:"M",3:"L",4:"XL",5:"XXL",6:"XXXL",7:"4XL",8:"5XL",9:"6XL",10:"7XL",S:"1",M:"2",L:"3",XL:"4",XXL:"5",XXXL:"6","4XL":"7","5XL":"8","6XL":"9","7XL":"10"}[f],_=[f];b&&_.push(b),u=u.filter(k=>k.variantes&&Array.isArray(k.variantes)&&k.variantes.some(P=>{if(!P.talle)return!1;const N=P.talle.toUpperCase().trim();return _.includes(N)}))}let d=[],h=[];if(n.trim()){const f=n.toLowerCase(),p={};r.forEach(b=>{var _;p[b.id]=((_=b.proveedor)==null?void 0:_.toLowerCase())||""}),u.forEach(b=>{var N,w,S;let _=!1,k=!1;(p[b.proveedorId]||"").includes(f)&&(_=!0),((N=b.articulo)!=null&&N.toLowerCase().includes(f)||(w=b.id)!=null&&w.toLowerCase().includes(f)||(S=b.tags)!=null&&S.some(R=>R.toLowerCase().includes(f))||b.proveedorId&&b.proveedorId.toString().toLowerCase().includes(f)||b.variantes&&Array.isArray(b.variantes)&&b.variantes.some(R=>{var M;return(M=R.talle)==null?void 0:M.toLowerCase().includes(f)}))&&(k=!0),_?d.push(b):k&&h.push(b)}),u=[...d,...h]}return n.trim()||u.sort((f,p)=>{let b,_;switch(o){case"created":return b=f.createdAt?new Date(f.createdAt.seconds?f.createdAt.seconds*1e3:f.createdAt):new Date(0),_=p.createdAt?new Date(p.createdAt.seconds?p.createdAt.seconds*1e3:p.createdAt):new Date(0),_-b;case"name":b=f.articulo||"",_=p.articulo||"";break;case"price":b=f.precioCosto||0,_=p.precioCosto||0;break;case"stock":b=Ii(f),_=Ii(p);break;case"category":b=f.categoria||"",_=p.categoria||"";break;default:return b=f.createdAt?new Date(f.createdAt.seconds?f.createdAt.seconds*1e3:f.createdAt):new Date(0),_=p.createdAt?new Date(p.createdAt.seconds?p.createdAt.seconds*1e3:p.createdAt):new Date(0),_-b}return typeof b=="string"?l==="asc"?b.localeCompare(_):_.localeCompare(b):l==="asc"?b-_:_-b}),u},YD=(t,e)=>{if(!e.trim())return[];const r=e.toLowerCase(),n=t.filter(i=>{var o,l,u,d,h;return((o=i.articulo)==null?void 0:o.toLowerCase().includes(r))||((l=i.id)==null?void 0:l.toLowerCase().includes(r))||((u=i.codigoBarras)==null?void 0:u.toLowerCase().includes(r))||((d=i.descripcion)==null?void 0:d.toLowerCase().includes(r))||((h=i.tags)==null?void 0:h.some(f=>f.toLowerCase().includes(r)))||i.proveedorId&&i.proveedorId.toString().toLowerCase().includes(r)||i.variantes&&Array.isArray(i.variantes)&&i.variantes.some(f=>{var p;return(p=f.talle)==null?void 0:p.toLowerCase().includes(r)})}),s=n.find(i=>i.codigoBarras===e||i.id===e);return s?[s,...n.filter(i=>i.codigoBarras!==e&&i.id!==e)]:n},rm=(t,e=5)=>{const r=Ii(t);return r===0?{status:"out",label:"Sin Stock",color:"red",bgColor:"bg-red-100",textColor:"text-red-800"}:r<=e?{status:"low",label:"Stock Bajo",color:"yellow",bgColor:"bg-yellow-100",textColor:"text-yellow-800"}:{status:"good",label:"En Stock",color:"green",bgColor:"bg-green-100",textColor:"text-green-800"}},JD=(t=[],e=[])=>{const[r,n]=T.useState(""),[s,i]=T.useState(""),[o,l]=T.useState("all"),[u,d]=T.useState("created"),[h,f]=T.useState("asc"),[p,b]=T.useState(!1),_=T.useMemo(()=>({searchTerm:r,sizeFilter:s,categoryFilter:o,sortBy:u,sortOrder:h}),[r,s,o,u,h]),k=T.useMemo(()=>XD(t,_,e),[t,_,e]),P=T.useMemo(()=>r.trim()?YD(t,r):[],[t,r]),N=T.useCallback(y=>{n(y),b(!!y.trim())},[]),w=T.useCallback(y=>{i(y)},[]),S=T.useCallback(y=>{l(y)},[]),R=T.useCallback(y=>{d(y)},[]),M=T.useCallback(y=>{f(y)},[]),$=T.useCallback(()=>{n(""),b(!1)},[]),E=T.useCallback(()=>{i("")},[]),x=T.useCallback(()=>{n(""),i(""),l("all"),d("created"),f("asc"),b(!1)},[]),v=T.useMemo(()=>{const y=t.length,D=k.length,I=r.trim()||s.trim()||o!=="all";return{total:y,filtered:D,hasActiveFilters:I,hiddenCount:y-D}},[t.length,k.length,r,s,o]);return{searchTerm:r,sizeFilter:s,categoryFilter:o,sortBy:u,sortOrder:h,showResults:p,filteredProducts:k,searchResults:P,filterStats:v,handleSearch:N,handleSizeFilter:w,handleCategoryChange:S,handleSortChange:R,handleOrderChange:M,clearSearch:$,clearSizeFilter:E,clearAllFilters:x,setShowResults:b,filters:_}},ZD=({isOpen:t,onClose:e,onSubmit:r,product:n=null,mode:s="create"})=>{const{providers:i,loadProviders:o}=Do(),[l,u]=T.useState({id:"",articulo:"",descripcion:"",categoria:"",subcategorias:[],temporada:"",proveedorId:"",precioCosto:"",precioVentaSugerido:"",gananciaPercent:50,variantes:[],tags:[],imagenes:[]}),[d,h]=T.useState({}),[f,p]=T.useState(!1),[b,_]=T.useState(!1),[k,P]=T.useState(""),[N,w]=T.useState([]),[S,R]=T.useState(""),[M,$]=T.useState(""),[E,x]=T.useState([]),[v,y]=T.useState([]),[D,I]=T.useState(!1),j=["mujer","hombre","niños-bebes","otros"],te=["verano","invierno","otoño","primavera","todo el año"],B=["remeras","pantalones","vestidos","faldas","shorts","buzos","camperas","jeans","camisas","blusas","sweaters","abrigos","ropa interior","calzado","accesorios","carteras","cinturones"];T.useEffect(()=>{t&&o()},[t,o]),T.useEffect(()=>{if(k.trim()){const U=i.filter(Y=>Y.proveedor.toLowerCase().includes(k.toLowerCase()));w(U)}else w([])},[k,i]),T.useEffect(()=>{if(n&&s==="edit"){if(u({id:n.id||"",articulo:n.articulo||"",descripcion:n.descripcion||"",categoria:n.categoria||"",subcategorias:n.subcategorias||[],temporada:n.temporada||"",proveedorId:n.proveedorId||"",precioCosto:n.precioCosto||"",precioVentaSugerido:V(n.precioCosto,50),gananciaPercent:50,variantes:n.variantes||[],tags:n.tags||[],imagenes:n.imagenes||[]}),n.proveedorId&&i.length>0){const U=i.find(Y=>Y.id===n.proveedorId);U&&P(U.proveedor)}}else s==="create"&&(u({id:"",articulo:"",descripcion:"",categoria:"",subcategorias:[],temporada:"",proveedorId:"",precioCosto:"",precioVentaSugerido:"",gananciaPercent:50,variantes:[],tags:[],imagenes:[]}),P(""))},[n,s,i]);const V=(U,Y)=>{if(!U||!Y)return"";const de=parseFloat(U),Ne=parseFloat(Y);return Math.round(de*(1+Ne/100))},L=(U,Y)=>{if(!U||!Y)return 0;const de=parseFloat(U),Ne=parseFloat(Y);return Math.round((Ne-de)/de*100)},O=(U,Y)=>{if(u(de=>({...de,[U]:Y})),U==="precioCosto"||U==="gananciaPercent"){const de=V(U==="precioCosto"?Y:l.precioCosto,U==="gananciaPercent"?Y:l.gananciaPercent);u(Ne=>({...Ne,precioVentaSugerido:de}))}if(U==="precioVentaSugerido"){const de=L(l.precioCosto,Y);u(Ne=>({...Ne,gananciaPercent:de}))}d[U]&&h(de=>({...de,[U]:null}))},H=()=>{const U={talle:"",color:"",stock:0,precioVenta:l.precioVentaSugerido||0};u(Y=>({...Y,variantes:[...Y.variantes,U]}))},q=U=>{u(Y=>({...Y,variantes:Y.variantes.filter((de,Ne)=>Ne!==U)}))},J=(U,Y,de)=>{u(Ne=>({...Ne,variantes:Ne.variantes.map((Zt,$t)=>$t===U?{...Zt,[Y]:de}:Zt)}))},A=()=>{if(!l.precioVentaSugerido){alert("Primero ingresa un precio de venta sugerido");return}u(U=>({...U,variantes:U.variantes.map(Y=>({...Y,precioVenta:l.precioVentaSugerido}))}))},Q=()=>{S.trim()&&!l.tags.includes(S.trim())&&(u(U=>({...U,tags:[...U.tags,S.trim()]})),R(""))},ae=U=>{u(Y=>({...Y,tags:Y.tags.filter(de=>de!==U)}))},le=U=>{l.subcategorias.includes(U)||u(Y=>({...Y,subcategorias:[...Y.subcategorias,U]}))},ee=U=>{u(Y=>({...Y,subcategorias:Y.subcategorias.filter(de=>de!==U)}))},ue=U=>{u(Y=>({...Y,proveedorId:U.id})),P(U.proveedor),w([])},ye=U=>{const Y=Array.from(U.target.files);if(Y.length===0)return;const de=["image/jpeg","image/jpg","image/png","image/webp"],Ne=Y.filter($t=>de.includes($t.type));if(Ne.length!==Y.length&&alert("Solo se permiten archivos de imagen (JPG, PNG, WEBP)"),E.length+Ne.length>5){alert("Máximo 5 imágenes permitidas");return}x($t=>[...$t,...Ne]),Ne.forEach($t=>{const As=new FileReader;As.onload=Oo=>{y(Tu=>[...Tu,{file:$t,url:Oo.target.result,name:$t.name}])},As.readAsDataURL($t)})},tt=U=>{x(Y=>Y.filter((de,Ne)=>Ne!==U)),y(Y=>Y.filter((de,Ne)=>Ne!==U))},Bt=async()=>{if(E.length===0)return[];I(!0);const U=E.map(async Y=>{const de=`productos/${l.id}/${Date.now()}-${Y.name}`,Ne=fR(wR,de);try{const Zt=await hR(Ne,Y);return await mR(Zt.ref)}catch(Zt){throw console.error("Error uploading image:",Zt),Zt}});try{const Y=await Promise.all(U);return I(!1),Y}catch(Y){throw I(!1),Y}},xr=()=>{const U={};return l.id.trim()||(U.id="El código de barras es obligatorio"),l.articulo.trim()||(U.articulo="El nombre del artículo es obligatorio"),l.categoria||(U.categoria="La categoría es obligatoria"),l.proveedorId||(U.proveedorId="El proveedor es obligatorio"),l.precioCosto||(U.precioCosto="El costo por unidad es obligatorio"),l.variantes.forEach((Y,de)=>{Y.precioVenta||(U[`variante_${de}_precio`]="El precio de venta es obligatorio")}),h(U),Object.keys(U).length===0},yr=async U=>{if(U.preventDefault(),!!xr()){p(!0);try{let Y=l.imagenes||[];if(E.length>0){const Ne=await Bt();Y=[...Y,...Ne]}const de={...l,imagenes:Y};await r(de),e()}catch(Y){console.error("Error al guardar producto:",Y),alert("Error al guardar el producto: "+Y.message)}finally{p(!1)}}},W=()=>{u({id:"",articulo:"",descripcion:"",categoria:"",subcategorias:[],temporada:"",proveedorId:"",precioCosto:"",precioVentaSugerido:"",gananciaPercent:50,variantes:[],tags:[],imagenes:[]}),h({}),P(""),w([]),x([]),y([]),I(!1),e()};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s==="create"?"Agregar Nuevo Producto":"Editar Producto"}),a.jsx("button",{onClick:W,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("form",{onSubmit:yr,className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código de Barras *"}),a.jsx("input",{type:"text",value:l.id,onChange:U=>O("id",U.target.value),className:`w-full input-rosema ${d.id?"border-red-500":""}`,placeholder:"Ingrese código de barras"}),d.id&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.id})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Artículo *"}),a.jsx("input",{type:"text",value:l.articulo,onChange:U=>O("articulo",U.target.value),className:`w-full input-rosema ${d.articulo?"border-red-500":""}`,placeholder:"Ingrese nombre del artículo"}),d.articulo&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.articulo})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),a.jsx("textarea",{value:l.descripcion,onChange:U=>O("descripcion",U.target.value),className:"w-full input-rosema",rows:"3",placeholder:"Descripción del producto"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría *"}),a.jsxs("select",{value:l.categoria,onChange:U=>O("categoria",U.target.value),className:`w-full input-rosema ${d.categoria?"border-red-500":""}`,children:[a.jsx("option",{value:"",children:"Seleccionar categoría"}),j.map(U=>a.jsx("option",{value:U,children:U},U))]}),d.categoria&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.categoria})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Temporada"}),a.jsxs("select",{value:l.temporada,onChange:U=>O("temporada",U.target.value),className:"w-full input-rosema",children:[a.jsx("option",{value:"",children:"Seleccionar temporada"}),te.map(U=>a.jsx("option",{value:U,children:U},U))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subcategorías"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:l.subcategorias.map(U=>a.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm flex items-center",children:[U,a.jsx("button",{type:"button",onClick:()=>ee(U),className:"ml-2 text-blue-600 hover:text-blue-800",children:"×"})]},U))}),a.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(U=>a.jsx("button",{type:"button",onClick:()=>le(U),className:`px-3 py-1 text-sm rounded-full border transition-colors ${l.subcategorias.includes(U)?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:U},U))}),a.jsxs("div",{className:"flex mt-2",children:[a.jsx("input",{type:"text",value:M,onChange:U=>$(U.target.value),className:"flex-1 input-rosema",placeholder:"Nueva subcategoría",onKeyPress:U=>{U.key==="Enter"&&(U.preventDefault(),M.trim()&&(le(M.trim()),$("")))}}),a.jsx("button",{type:"button",onClick:()=>{M.trim()&&(le(M.trim()),$(""))},className:"ml-2 btn-secondary",children:"Agregar"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Proveedor *"}),a.jsxs("div",{className:"flex",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx("input",{type:"text",value:k,onChange:U=>P(U.target.value),className:`w-full input-rosema ${d.proveedorId?"border-red-500":""}`,placeholder:"Buscar proveedor..."}),N.length>0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:N.map(U=>a.jsxs("button",{type:"button",onClick:()=>ue(U),className:"w-full text-left px-4 py-2 hover:bg-gray-50 transition-colors",children:[a.jsx("div",{className:"font-medium",children:U.proveedor}),a.jsx("div",{className:"text-sm text-gray-500",children:U.categoria})]},U.id))})]}),a.jsx("button",{type:"button",onClick:()=>_(!0),className:"ml-2 btn-secondary whitespace-nowrap",children:"+ Nuevo Proveedor"})]}),d.proveedorId&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.proveedorId})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Costo por Unidad *"}),a.jsx("input",{type:"number",value:l.precioCosto,onChange:U=>O("precioCosto",U.target.value),className:`w-full input-rosema ${d.precioCosto?"border-red-500":""}`,placeholder:"0",min:"0",step:"0.01"}),d.precioCosto&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.precioCosto})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio de Venta Sugerido"}),a.jsx("input",{type:"number",value:l.precioVentaSugerido,onChange:U=>O("precioVentaSugerido",U.target.value),className:"w-full input-rosema",placeholder:"0",min:"0",step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"% Ganancia"}),a.jsx("input",{type:"number",value:l.gananciaPercent,onChange:U=>O("gananciaPercent",U.target.value),className:"w-full input-rosema",placeholder:"0",min:"0",step:"0.1"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Variantes (Tallas, Colores, Stock)"}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"button",onClick:A,className:"btn-secondary text-sm",children:"Aplicar precio a todas"}),a.jsx("button",{type:"button",onClick:H,className:"btn-rosema text-sm",children:"+ Agregar Variante"})]})]}),l.variantes.length>0&&a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border border-gray-200 rounded-lg",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Talla"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Color"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Stock"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Precio Venta *"}),a.jsx("th",{className:"px-4 py-2 text-center text-sm font-medium text-gray-700",children:"Acciones"})]})}),a.jsx("tbody",{children:l.variantes.map((U,Y)=>a.jsxs("tr",{className:"border-t border-gray-200",children:[a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"text",value:U.talle,onChange:de=>J(Y,"talle",de.target.value),className:"w-full input-rosema",placeholder:"XS, S, M..."})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"text",value:U.color,onChange:de=>J(Y,"color",de.target.value),className:"w-full input-rosema",placeholder:"Rojo, Azul..."})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"number",value:U.stock,onChange:de=>J(Y,"stock",parseInt(de.target.value)||0),className:"w-full input-rosema",min:"0"})}),a.jsxs("td",{className:"px-4 py-2",children:[a.jsx("input",{type:"number",value:U.precioVenta,onChange:de=>J(Y,"precioVenta",parseFloat(de.target.value)||0),className:`w-full input-rosema ${d[`variante_${Y}_precio`]?"border-red-500":""}`,min:"0",step:"0.01"}),d[`variante_${Y}_precio`]&&a.jsx("p",{className:"text-red-500 text-xs mt-1",children:d[`variante_${Y}_precio`]})]}),a.jsx("td",{className:"px-4 py-2 text-center",children:a.jsx("button",{type:"button",onClick:()=>q(Y),className:"text-red-600 hover:text-red-800 transition-colors",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},Y))})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:l.tags.map(U=>a.jsxs("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-sm flex items-center",children:[U,a.jsx("button",{type:"button",onClick:()=>ae(U),className:"ml-2 text-green-600 hover:text-green-800",children:"×"})]},U))}),a.jsxs("div",{className:"flex",children:[a.jsx("input",{type:"text",value:S,onChange:U=>R(U.target.value),className:"flex-1 input-rosema",placeholder:"Agregar tag (ej: invierno, fiesta, jean)",onKeyPress:U=>{U.key==="Enter"&&(U.preventDefault(),Q())}}),a.jsx("button",{type:"button",onClick:Q,className:"ml-2 btn-secondary",children:"Agregar"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imágenes del Producto"}),l.imagenes&&l.imagenes.length>0&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Imágenes actuales:"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:l.imagenes.map((U,Y)=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:U,alt:`Imagen ${Y+1}`,className:"w-full object-contain rounded-lg border border-gray-200 max-h-64"}),a.jsx("button",{type:"button",onClick:()=>{const de=l.imagenes.filter((Ne,Zt)=>Zt!==Y);u(Ne=>({...Ne,imagenes:de}))},className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600 transition-colors",children:"×"})]},Y))})]}),v.length>0&&a.jsxs("div",{className:"mb-4",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Nuevas imágenes a subir:"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:v.map((U,Y)=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:U.url,alt:U.name,className:"w-full object-contain rounded-lg border border-gray-200 max-h-64"}),a.jsx("button",{type:"button",onClick:()=>tt(Y),className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600 transition-colors",children:"×"})]},Y))})]}),a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[a.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:ye,className:"hidden",id:"image-upload"}),a.jsxs("label",{htmlFor:"image-upload",className:"cursor-pointer flex flex-col items-center",children:[a.jsx("svg",{className:"w-12 h-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),a.jsx("span",{className:"text-sm text-gray-600",children:"Haz clic para seleccionar imágenes"}),a.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, WEBP (máximo 5 imágenes)"})]})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:W,className:"btn-secondary",disabled:f,children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn-rosema",disabled:f||D,children:D?"Subiendo imágenes...":f?"Guardando...":s==="create"?"Crear Producto":"Actualizar Producto"})]})]})]})}):null},e4=({isOpen:t,onClose:e,product:r})=>{const[n,s]=T.useState(!1),[i,o]=T.useState("2x1"),[l,u]=T.useState("");if(!t||!r)return null;const h=(()=>{if(!r.variantes||r.variantes.length===0)return r.precioCosto||0;const k=r.variantes.reduce((P,N)=>P+(N.precioVenta||0),0);return Math.round(k/r.variantes.length)})(),f=l?parseFloat(l):h,b=(k=>{const P=[];for(let N=0;N<k.length;N++){const w=k[N];w.match(/[0-9]/)?P.push("thin","thick","thin","thick"):w.match(/[A-Z]/)?P.push("thick","thin","thick","thin"):P.push("thin","thin","thick","thick")}return P})(r.id),_=()=>{const k=window.open("","_blank"),P=i==="2x1"?"2in":i==="1.5x1"?"1.5in":"2.5in",N="1in";k.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Código de Barras - ${r.articulo}</title>
          <style>
            @page {
              size: ${P} ${N};
              margin: 0;
            }
            body {
              margin: 0;
              padding: 4px;
              font-family: Arial, sans-serif;
              width: ${P};
              height: ${N};
              display: flex;
              flex-direction: column;
              justify-content: center;
              align-items: center;
              box-sizing: border-box;
            }
            .product-name {
              font-size: 8px;
              font-weight: bold;
              text-align: center;
              margin-bottom: 2px;
              line-height: 1;
              max-height: 16px;
              overflow: hidden;
            }
            .barcode-container {
              display: flex;
              align-items: end;
              justify-content: center;
              margin: 2px 0;
            }
            .barcode {
              display: flex;
              align-items: end;
              height: 20px;
            }
            .bar {
              background-color: black;
              margin-right: 1px;
            }
            .bar.thin {
              width: 1px;
              height: 20px;
            }
            .bar.thick {
              width: 2px;
              height: 20px;
            }
            .code-text {
              font-size: 6px;
              font-weight: bold;
              text-align: center;
              margin-top: 1px;
              letter-spacing: 1px;
            }
            .price {
              font-size: 7px;
              font-weight: bold;
              text-align: center;
              margin-top: 1px;
            }
          </style>
        </head>
        <body>
          <div class="product-name">${r.articulo}</div>
          <div class="barcode-container">
            <div class="barcode">
              ${b.map(w=>`<div class="bar ${w}"></div>`).join("")}
            </div>
          </div>
          <div class="code-text">${r.id}</div>
          ${n?`<div class="price">$${f.toLocaleString()}</div>`:""}
        </body>
      </html>
    `),k.document.close(),k.focus(),setTimeout(()=>{k.print(),k.close()},250)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Imprimir Código de Barras"}),a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"bg-white border-2 border-gray-300 rounded-lg p-4 mb-6 text-center",children:[a.jsx("div",{className:"text-xs font-bold mb-2 text-gray-800",children:r.articulo}),a.jsx("div",{className:"flex justify-center items-end mb-2",children:a.jsx("div",{className:"flex items-end",style:{height:"40px"},children:b.map((k,P)=>a.jsx("div",{className:"bg-black mr-px",style:{width:k==="thick"?"3px":"1px",height:"40px"}},P))})}),a.jsx("div",{className:"text-xs font-bold mb-1 tracking-wider",children:r.id}),n&&a.jsxs("div",{className:"text-sm font-bold text-green-600",children:["$",f.toLocaleString()]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tamaño de Etiqueta"}),a.jsxs("select",{value:i,onChange:k=>o(k.target.value),className:"w-full input-rosema",children:[a.jsx("option",{value:"1.5x1",children:'1.5" x 1" pulgadas'}),a.jsx("option",{value:"2x1",children:'2" x 1" pulgadas (Recomendado)'}),a.jsx("option",{value:"2.5x1",children:'2.5" x 1" pulgadas'})]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"showPrice",checked:n,onChange:k=>s(k.target.checked),className:"h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"showPrice",className:"ml-2 text-sm text-gray-700",children:"Incluir precio en la etiqueta"})]}),n&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio a mostrar"}),a.jsx("input",{type:"number",value:l,onChange:k=>u(k.target.value),placeholder:`Precio promedio: $${h.toLocaleString()}`,className:"w-full input-rosema",min:"0",step:"0.01"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Deja vacío para usar el precio promedio del producto"})]})]}),a.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:a.jsxs("div",{className:"text-sm",children:[a.jsx("div",{className:"font-medium text-gray-900",children:r.articulo}),a.jsxs("div",{className:"text-gray-600",children:["Código: ",r.id]}),a.jsxs("div",{className:"text-gray-600",children:["Precio promedio: $",h.toLocaleString()]})]})}),a.jsxs("div",{className:"flex space-x-3 mt-6",children:[a.jsx("button",{onClick:e,className:"flex-1 btn-secondary",children:"Cancelar"}),a.jsxs("button",{onClick:_,className:"flex-1 btn-rosema flex items-center justify-center space-x-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),a.jsx("span",{children:"Imprimir"})]})]})]})]})})},t4=({title:t,value:e,color:r="blue",format:n="number",subtitle:s,className:i=""})=>{const o=(d,h)=>{switch(h){case"price":return kt(d);case"percentage":return`${d}%`;case"number":default:return typeof d=="number"?d.toLocaleString():d}},l={red:"text-red-600",blue:"text-blue-600",green:"text-green-600",yellow:"text-yellow-600",purple:"text-purple-600",gray:"text-gray-600"},u=l[r]||l.blue;return a.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 text-center ${i}`,children:[a.jsx("div",{className:`text-3xl font-bold mb-2 ${u}`,children:o(e,n)}),a.jsx("div",{className:"text-gray-600 font-medium",children:t}),s&&a.jsx("div",{className:"text-sm text-gray-500 mt-1",children:s})]})},r4=({stats:t})=>{const e=[{title:"Total Productos",value:t.totalProducts,color:"red",format:"number"},{title:"Stock Total",value:t.totalStock,color:"blue",format:"number"},{title:"Stock Bajo",value:t.lowStockProducts,color:"yellow",format:"number"},{title:"Sin Stock",value:t.outOfStockProducts,color:"red",format:"number"},{title:"Costo Total",value:t.totalCost||0,color:"purple",format:"price"},{title:"Ganancia Esperada",value:t.expectedProfit||0,color:"green",format:"price"}];return a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-6 mb-6",children:e.map((r,n)=>a.jsx(t4,{title:r.title,value:r.value,color:r.color,format:r.format},n))})},n4=({searchTerm:t,sizeFilter:e,categoryFilter:r,sortBy:n,sortOrder:s,onSearchChange:i,onSizeFilterChange:o,onCategoryChange:l,onSortChange:u,onOrderChange:d,onClearSearch:h,onClearSizeFilter:f})=>a.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(iN,{value:t,onChange:i,onClear:h,placeholder:"Buscar por código, nombre, tags o proveedor..."}),a.jsxs("select",{value:r,onChange:p=>l(p.target.value),className:"input-rosema",children:[a.jsx("option",{value:"all",children:"Todas las categorías"}),ND.map(p=>a.jsx("option",{value:p.value,children:p.label},p.value))]}),a.jsx("select",{value:n,onChange:p=>u(p.target.value),className:"input-rosema",children:CD.map(p=>a.jsx("option",{value:p.value,children:p.label},p.value))}),a.jsx("select",{value:s,onChange:p=>d(p.target.value),className:"input-rosema",children:SD.map(p=>a.jsx("option",{value:p.value,children:p.label},p.value))})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:e,onChange:p=>o(p.target.value),placeholder:"Filtrar por talle específico (ej: 2, M, XL)...",className:"input-rosema pr-10"}),e&&a.jsx("button",{onClick:f,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",title:"Limpiar filtro de talle",children:"✕"})]}),a.jsx("div",{className:"md:col-span-3 flex items-center",children:a.jsx("span",{className:"text-sm text-gray-500",children:"💡 Tip: El filtro de talle busca productos que tengan ese talle específico en sus variantes"})})]})]})}),s4=({products:t,providers:e,onView:r,onEdit:n,onDelete:s,onPrintBarcode:i})=>{const o=l=>{const u=e.find(d=>d.id===l);return u?u.proveedor:"Proveedor no encontrado"};return a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Producto"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoría"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Proveedor"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio Costo"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio Venta"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha Creación"}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(l=>{const u=Ii(l),d=rN(l),h=rm(l),f=_a(l.createdAt);return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.articulo||"Sin nombre"}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Código: ",l.id]}),l.tags&&l.tags.length>0&&a.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[l.tags.slice(0,3).map(p=>a.jsx("span",{className:"inline-block bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded",children:p},p)),l.tags.length>3&&a.jsxs("span",{className:"text-xs text-gray-400",children:["+",l.tags.length-3]})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:l.categoria||"Sin categoría"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:o(l.proveedorId)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:kt(l.precioCosto||0)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:kt(d)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${h.bgColor} ${h.textColor}`,children:[u," unidades"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:l.createdAt?a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:f.date}),a.jsx("div",{className:"text-xs text-gray-500",children:f.time})]}):a.jsx("span",{className:"text-gray-400 text-sm",children:"Sin fecha"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("button",{onClick:()=>r(l),className:"text-green-600 hover:text-green-900 transition-colors px-2 py-1 text-sm",title:"Ver detalles",children:"Ver"}),a.jsx("button",{onClick:()=>n(l),className:"text-blue-600 hover:text-blue-900 transition-colors px-2 py-1 text-sm",title:"Editar",children:"Editar"}),a.jsx("button",{onClick:()=>i(l),className:"text-purple-600 hover:text-purple-900 transition-colors px-2 py-1 text-sm",title:"Imprimir código",children:"Imprimir"}),a.jsx("button",{onClick:()=>s(l.id),className:"text-red-600 hover:text-red-900 transition-colors px-2 py-1 text-sm",title:"Eliminar",children:"Eliminar"})]})})]},l.id)})})]})})},i4=({isOpen:t,onClose:e,title:r,children:n,size:s="md",showCloseButton:i=!0,closeOnOverlayClick:o=!0,className:l=""})=>{if(T.useEffect(()=>{const h=f=>{f.key==="Escape"&&t&&e()};return t&&(document.addEventListener("keydown",h),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",h),document.body.style.overflow="unset"}},[t,e]),!t)return null;const u={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl",full:"max-w-full mx-4"},d=h=>{h.target===h.currentTarget&&o&&e()};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:d,children:a.jsxs("div",{className:`bg-white rounded-lg shadow-xl w-full ${u[s]} max-h-[90vh] overflow-y-auto ${l}`,onClick:h=>h.stopPropagation(),children:[(r||i)&&a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r&&a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r}),i&&a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors p-1",title:"Cerrar",children:a.jsx("span",{className:"text-2xl",children:"×"})})]}),a.jsx("div",{className:"p-6",children:n})]})})},a4=({isOpen:t,onClose:e,product:r,providers:n,onEdit:s,onPrintBarcode:i})=>{if(!r)return null;const o=h=>{const f=n.find(p=>p.id===h);return f?f.proveedor:"Proveedor no encontrado"},l=Ii(r),u=rN(r),d=rm(r);return a.jsx(i4,{isOpen:t,onClose:e,title:"Detalles del Producto",size:"lg",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Código de Barras"}),a.jsx("p",{className:"text-gray-900 font-mono text-lg",children:r.id})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Nombre del Artículo"}),a.jsx("p",{className:"text-gray-900 text-lg",children:r.articulo})]})]}),r.descripcion&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Descripción"}),a.jsx("p",{className:"text-gray-900",children:r.descripcion})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Categoría"}),a.jsx("p",{className:"text-gray-900",children:r.categoria})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Temporada"}),a.jsx("p",{className:"text-gray-900",children:r.temporada||"No especificada"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Proveedor"}),a.jsx("p",{className:"text-gray-900",children:o(r.proveedorId)})]})]}),r.subcategorias&&r.subcategorias.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Subcategorías"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:r.subcategorias.map(h=>a.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm",children:h},h))})]}),r.tags&&r.tags.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map(h=>a.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-sm",children:h},h))})]}),r.imagenes&&r.imagenes.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-3",children:"Imágenes del Producto"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.imagenes.map((h,f)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:h,alt:`${r.articulo} - Imagen ${f+1}`,className:"w-full object-contain rounded-lg border border-gray-200 max-h-64 cursor-pointer",onClick:()=>window.open(h,"_blank")}),a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 rounded-lg transition-all flex items-center justify-center",children:a.jsx("span",{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity text-sm",children:"Ver imagen"})})]},f))})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Precio de Costo"}),a.jsx("p",{className:"text-gray-900 text-lg font-semibold",children:kt(r.precioCosto||0)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Precio de Venta Promedio"}),a.jsx("p",{className:"text-green-600 text-lg font-semibold",children:kt(u)})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Stock Total"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"text-gray-900 text-lg font-semibold",children:[l," unidades"]}),a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${d.bgColor} ${d.textColor}`,children:d.label})]})]})}),r.variantes&&r.variantes.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-3",children:"Variantes"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border border-gray-200 rounded-lg",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Talla"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Color"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Stock"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-700",children:"Precio Venta"})]})}),a.jsx("tbody",{children:r.variantes.map((h,f)=>{const p=rm({variantes:[h]});return a.jsxs("tr",{className:"border-t border-gray-200",children:[a.jsx("td",{className:"px-4 py-2",children:h.talle||"N/A"}),a.jsx("td",{className:"px-4 py-2",children:h.color||"N/A"}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${p.bgColor} ${p.textColor}`,children:h.stock||0})}),a.jsx("td",{className:"px-4 py-2",children:kt(h.precioVenta||0)})]},f)})})]})})]}),r.createdAt&&a.jsxs("div",{className:"text-sm text-gray-500 border-t border-gray-200 pt-4",children:[a.jsxs("p",{children:["Creado: ",_a(r.createdAt).date," a las ",_a(r.createdAt).time]}),r.updatedAt&&a.jsxs("p",{children:["Última actualización: ",_a(r.updatedAt).date," a las ",_a(r.updatedAt).time]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[a.jsxs("button",{onClick:()=>i(r),className:"btn-secondary flex items-center space-x-2",children:[a.jsx("span",{children:"📄"}),a.jsx("span",{children:"Imprimir Código"})]}),a.jsxs("button",{onClick:()=>{e(),s(r)},className:"btn-rosema flex items-center space-x-2",children:[a.jsx("span",{children:"✏️"}),a.jsx("span",{children:"Editar"})]})]})]})})},o4=({message:t,title:e="Error",onRetry:r,retryText:n="Reintentar",className:s="",variant:i="default"})=>{const o={default:{container:"bg-red-50 border border-red-200 text-red-800",title:"text-red-900",button:"bg-red-600 hover:bg-red-700 text-white"},warning:{container:"bg-yellow-50 border border-yellow-200 text-yellow-800",title:"text-yellow-900",button:"bg-yellow-600 hover:bg-yellow-700 text-white"},info:{container:"bg-blue-50 border border-blue-200 text-blue-800",title:"text-blue-900",button:"bg-blue-600 hover:bg-blue-700 text-white"}},l=o[i]||o.default;return a.jsx("div",{className:`rounded-lg p-4 ${l.container} ${s}`,children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("span",{className:"text-xl",children:"⚠️"})}),a.jsxs("div",{className:"ml-3 flex-1",children:[a.jsx("h3",{className:`text-sm font-medium ${l.title}`,children:e}),a.jsx("div",{className:"mt-2 text-sm",children:a.jsx("p",{children:t})}),r&&a.jsx("div",{className:"mt-4",children:a.jsx("button",{onClick:r,className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${l.button}`,children:n})})]})]})})},l4=()=>{var q,J;const{products:t,loading:e,error:r,loadProducts:n,addProduct:s,updateProductData:i,removeProduct:o,createSampleData:l}=Su(),{providers:u,loadProviders:d}=Do(),{searchTerm:h,sizeFilter:f,categoryFilter:p,sortBy:b,sortOrder:_,filteredProducts:k,handleSearch:P,handleSizeFilter:N,handleCategoryChange:w,handleSortChange:S,handleOrderChange:R,clearSearch:M,clearSizeFilter:$}=JD(t,u),{openModal:E,closeModal:x,isModalOpen:v,getModalData:y}=nN(["productForm","productDetails","deleteConfirm","barcodePrint"]);T.useEffect(()=>{n(),d()},[n,d]);const D=dD(t),I=()=>{E("productForm",{mode:"create",product:null})},j=A=>{E("productForm",{mode:"edit",product:A})},te=A=>{E("productDetails",A)},B=A=>{E("deleteConfirm",A)},V=A=>{E("barcodePrint",A)},L=async A=>{try{const Q=y("productForm");let ae;Q.mode==="create"?(ae=await s(A),confirm(ns.SUCCESS.PRODUCT_CREATED+" ¿Deseas imprimir el código de barras?")&&E("barcodePrint",ae)):(await i(Q.product.id,A),alert(ns.SUCCESS.PRODUCT_UPDATED)),x("productForm"),await n()}catch(Q){throw console.error("Error al guardar producto:",Q),Q}},O=async()=>{try{const A=y("deleteConfirm");await o(A),x("deleteConfirm"),alert(ns.SUCCESS.PRODUCT_DELETED)}catch(A){alert("Error al eliminar producto: "+A.message)}},H=async()=>{if(confirm(ns.CONFIRM.CREATE_SAMPLE_DATA))try{await l(),alert("Productos de ejemplo creados exitosamente")}catch(A){alert("Error al crear productos: "+A.message)}};return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Productos"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Gestión de inventario y catálogo"})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs("button",{onClick:I,className:"btn-rosema flex items-center space-x-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),a.jsx("span",{children:"Agregar Producto"})]}),a.jsxs("button",{className:"btn-secondary flex items-center space-x-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),a.jsx("span",{children:"Imprimir Códigos"})]})]})]}),a.jsx(r4,{stats:D}),a.jsx(n4,{searchTerm:h,sizeFilter:f,categoryFilter:p,sortBy:b,sortOrder:_,onSearchChange:P,onSizeFilterChange:N,onCategoryChange:w,onSortChange:S,onOrderChange:R,onClearSearch:M,onClearSizeFilter:$}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Catálogo de Productos (",k.length,")"]}),t.length===0&&a.jsx("button",{onClick:H,className:"btn-secondary text-sm",children:"Crear productos de ejemplo"})]})}),e?a.jsx(aN,{text:"Cargando productos..."}):r?a.jsx(o4,{message:`Error al cargar productos: ${r}`,onRetry:n}):k.length===0?a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"text-6xl mb-4",children:"📦"}),a.jsx("p",{className:"text-gray-600 mb-4",children:t.length===0?"No hay productos registrados":"No se encontraron productos con los filtros aplicados"}),t.length===0&&a.jsxs("div",{className:"space-x-3",children:[a.jsx("button",{onClick:I,className:"btn-rosema",children:"Agregar Primer Producto"}),a.jsx("button",{onClick:H,className:"btn-secondary",children:"Crear Productos de Ejemplo"})]})]}):a.jsx(s4,{products:k,providers:u,onView:te,onEdit:j,onDelete:B,onPrintBarcode:V})]}),a.jsx(ZD,{isOpen:v("productForm"),onClose:()=>x("productForm"),onSubmit:L,product:(q=y("productForm"))==null?void 0:q.product,mode:((J=y("productForm"))==null?void 0:J.mode)||"create"}),v("deleteConfirm")&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("span",{className:"text-2xl mr-3",children:"⚠️"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Confirmar Eliminación"})]}),a.jsx("p",{className:"text-gray-600 mb-6",children:ns.CONFIRM.DELETE_PRODUCT}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:()=>x("deleteConfirm"),className:"flex-1 btn-secondary",children:"Cancelar"}),a.jsx("button",{onClick:O,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:"Eliminar"})]})]})})}),a.jsx(a4,{isOpen:v("productDetails"),onClose:()=>x("productDetails"),product:y("productDetails"),providers:u,onEdit:j,onPrintBarcode:V}),a.jsx(e4,{isOpen:v("barcodePrint"),onClose:()=>x("barcodePrint"),product:y("barcodePrint")})]})},c4=()=>{const[t,e]=T.useState([]),[r,n]=T.useState(!1),[s,i]=T.useState(null),[o,l]=T.useState([]),u=T.useCallback(async()=>{n(!0),i(null);try{const E=await Lo();return e(E),E}catch(E){i(E.message||"Error al cargar clientes"),console.error("Error loading customers:",E)}finally{n(!1)}},[]),d=T.useCallback(async E=>{if(!E.trim())return l([]),e([]),[];n(!0),i(null);try{const x=await XR(E);return l(x),e(x),x}catch(x){return i(x.message||"Error en la búsqueda"),console.error("Error searching customers:",x),[]}finally{n(!1)}},[]),h=T.useCallback(async E=>{n(!0),i(null);try{return await ip(E)}catch(x){throw i(x.message||"Error al obtener cliente"),console.error("Error getting customer:",x),x}finally{n(!1)}},[]),f=T.useCallback(async E=>{try{return await Kb(E)}catch(x){return console.error("Error getting customer history:",x),[]}},[]),p=T.useCallback(async E=>{try{return await ZR(E)}catch(x){throw console.error("Error getting customer analysis:",x),x}},[]),b=T.useCallback(async E=>{n(!0),i(null);try{const x=await Hb(E);return e(v=>[x,...v]),x}catch(x){throw i(x.message||"Error al crear cliente"),console.error("Error adding customer:",x),x}finally{n(!1)}},[]),_=T.useCallback(async(E,x)=>{n(!0),i(null);try{const v=await Gb(E,x);return e(y=>y.map(D=>D.id===E?{...D,...v}:D)),v}catch(v){throw i(v.message||"Error al actualizar cliente"),console.error("Error updating customer:",v),v}finally{n(!1)}},[]),k=T.useCallback(async E=>{n(!0),i(null);try{return await QR(E),e(x=>x.filter(v=>v.id!==E)),E}catch(x){throw i(x.message||"Error al eliminar cliente"),console.error("Error removing customer:",x),x}finally{n(!1)}},[]),P=T.useCallback(()=>{l([]),e([]),i(null)},[]),N=T.useCallback(async()=>{try{return await YR()}catch(E){return console.error("Error getting customer stats:",E),{totalCustomers:t.length,activeCustomers:t.filter(x=>x.totalCompras>0).length,newCustomersThisMonth:0,topCustomers:[],averageSpending:0,totalRevenue:0}}},[t]),w=T.useCallback(()=>{const E={totalCustomers:t.length,activeCustomers:t.filter(v=>v.totalCompras>0).length,newCustomers:0,averageSpending:0,totalRevenue:0},x=new Date;return x.setDate(1),x.setHours(0,0,0,0),E.newCustomers=t.filter(v=>v.createdAt?(v.createdAt.seconds?new Date(v.createdAt.seconds*1e3):new Date(v.createdAt))>=x:!1).length,E.totalRevenue=t.reduce((v,y)=>v+(y.montoTotalGastado||0),0),E.averageSpending=t.length>0?E.totalRevenue/t.length:0,E},[t]),S=T.useCallback(async(E=10)=>{try{return await JR(E)}catch(x){return console.error("Error getting top customers:",x),t.filter(v=>v.totalCompras>0).sort((v,y)=>(y.montoTotalGastado||0)-(v.montoTotalGastado||0)).slice(0,E)}},[t]),R=T.useCallback(async(E,x)=>{try{await Qb(E,x),await u()}catch(v){console.error("Error updating customer stats from sale:",v)}},[u]),M=T.useCallback(E=>{let x=[...t];return E.hasCompras&&(x=x.filter(v=>v.totalCompras>0)),E.minSpending&&(x=x.filter(v=>(v.montoTotalGastado||0)>=E.minSpending)),E.tags&&E.tags.length>0&&(x=x.filter(v=>v.tags&&v.tags.some(y=>E.tags.includes(y)))),x},[t]),$=T.useCallback((E,x)=>t.filter(v=>{if(!v.createdAt)return!1;const y=v.createdAt.seconds?new Date(v.createdAt.seconds*1e3):new Date(v.createdAt);return y>=E&&y<=x}),[t]);return{customers:t,loading:r,error:s,searchResults:o,loadCustomers:u,searchCustomersByTerm:d,getCustomer:h,addCustomer:b,updateCustomerData:_,removeCustomer:k,clearSearch:P,getCustomerHistory:f,getCustomerAnalysis:p,updateCustomerStatsFromSale:R,getCustomerStatistics:N,getCustomerStatsLocal:w,getTopCustomersData:S,filterCustomers:M,getCustomersByDateRange:$}},u4=({customer:t,isOpen:e,onClose:r,onSave:n,loading:s})=>{const[i,o]=T.useState({nombre:"",telefono:"",email:"",direccion:"",fechaNacimiento:"",notas:"",tags:[]}),[l,u]=T.useState(""),[d,h]=T.useState({});T.useEffect(()=>{o(t?{nombre:t.nombre||"",telefono:t.telefono||"",email:t.email||"",direccion:t.direccion||"",fechaNacimiento:t.fechaNacimiento?t.fechaNacimiento.seconds?new Date(t.fechaNacimiento.seconds*1e3).toISOString().split("T")[0]:new Date(t.fechaNacimiento).toISOString().split("T")[0]:"",notas:t.notas||"",tags:t.tags||[]}:{nombre:"",telefono:"",email:"",direccion:"",fechaNacimiento:"",notas:"",tags:[]}),h({})},[t,e]);const f=N=>{const{name:w,value:S}=N.target;o(R=>({...R,[w]:S})),d[w]&&h(R=>({...R,[w]:""}))},p=()=>{l.trim()&&!i.tags.includes(l.trim())&&(o(N=>({...N,tags:[...N.tags,l.trim()]})),u(""))},b=N=>{o(w=>({...w,tags:w.tags.filter(S=>S!==N)}))},_=N=>{N.key==="Enter"&&(N.preventDefault(),p())},k=()=>{const N={};return i.nombre.trim()||(N.nombre="El nombre es requerido"),i.email&&!/\S+@\S+\.\S+/.test(i.email)&&(N.email="Email inválido"),i.telefono&&!/^\d{10,}$/.test(i.telefono.replace(/\D/g,""))&&(N.telefono="Teléfono debe tener al menos 10 dígitos"),h(N),Object.keys(N).length===0},P=async N=>{if(N.preventDefault(),!!k())try{const w={...i,fechaNacimiento:i.fechaNacimiento?new Date(i.fechaNacimiento):null};await n(w),r()}catch(w){console.error("Error al guardar cliente:",w)}};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Editar Cliente":"Nuevo Cliente"}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",disabled:s,children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre Completo *"}),a.jsx("input",{type:"text",name:"nombre",value:i.nombre,onChange:f,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent ${d.nombre?"border-red-500":"border-gray-300"}`,placeholder:"Ingrese el nombre completo",disabled:s}),d.nombre&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.nombre})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teléfono"}),a.jsx("input",{type:"tel",name:"telefono",value:i.telefono,onChange:f,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent ${d.telefono?"border-red-500":"border-gray-300"}`,placeholder:"Ej: 260 438-1502",disabled:s}),d.telefono&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.telefono})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),a.jsx("input",{type:"email",name:"email",value:i.email,onChange:f,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent ${d.email?"border-red-500":"border-gray-300"}`,placeholder:"cliente@email.com",disabled:s}),d.email&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.email})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha de Nacimiento"}),a.jsx("input",{type:"date",name:"fechaNacimiento",value:i.fechaNacimiento,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",disabled:s})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dirección"}),a.jsx("input",{type:"text",name:"direccion",value:i.direccion,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Dirección completa",disabled:s})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsx("input",{type:"text",value:l,onChange:N=>u(N.target.value),onKeyPress:_,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Agregar tag (ej: VIP, Mayorista, etc.)",disabled:s}),a.jsx("button",{type:"button",onClick:p,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",disabled:s||!l.trim(),children:"Agregar"})]}),i.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:i.tags.map((N,w)=>a.jsxs("span",{className:"inline-flex items-center gap-1 bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm",children:[N,a.jsx("button",{type:"button",onClick:()=>b(N),className:"text-red-600 hover:text-red-800",disabled:s,children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},w))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notas"}),a.jsx("textarea",{name:"notas",value:i.notas,onChange:f,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Notas adicionales sobre el cliente...",disabled:s})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:s,children:"Cancelar"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",disabled:s,children:s?"Guardando...":t?"Actualizar":"Crear Cliente"})]})]})]})}):null},d4=({customer:t,isOpen:e,onClose:r,onEdit:n,onDelete:s,onLoadHistory:i,onLoadAnalysis:o})=>{const[l,u]=T.useState("info"),[d,h]=T.useState([]),[f,p]=T.useState(null),[b,_]=T.useState(!1);T.useEffect(()=>{e&&t&&k()},[e,t]);const k=async()=>{if(t){_(!0);try{if(i){const R=await i(t.id);h(R)}if(o){const R=await o(t.id);p(R)}}catch(R){console.error("Error cargando datos del cliente:",R)}finally{_(!1)}}},P=R=>R?(R.seconds?new Date(R.seconds*1e3):new Date(R)).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"N/A",N=R=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(R||0),w=R=>{if(!R)return null;const M=R.seconds?new Date(R.seconds*1e3):new Date(R),$=new Date;let E=$.getFullYear()-M.getFullYear();const x=$.getMonth()-M.getMonth();return(x<0||x===0&&$.getDate()<M.getDate())&&E--,E};if(!e||!t)return null;const S=w(t.fechaNacimiento);return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.nombre}),a.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-600",children:[t.telefono&&a.jsxs("span",{children:["📞 ",t.telefono]}),t.email&&a.jsxs("span",{children:["✉️ ",t.email]}),S&&a.jsxs("span",{children:["🎂 ",S," años"]})]})]}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"p-6 bg-gray-50 border-b border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.totalCompras||0}),a.jsx("div",{className:"text-sm text-gray-600",children:"Compras Realizadas"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:N(t.montoTotalGastado)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total Gastado"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.totalCompras>0?N((t.montoTotalGastado||0)/t.totalCompras):N(0)}),a.jsx("div",{className:"text-sm text-gray-600",children:"Promedio por Compra"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.ultimaCompra?P(t.ultimaCompra):"Nunca"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Última Compra"})]})]})}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"flex space-x-8 px-6",children:[a.jsx("button",{onClick:()=>u("info"),className:`py-4 px-1 border-b-2 font-medium text-sm ${l==="info"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Información Personal"}),a.jsx("button",{onClick:()=>u("history"),className:`py-4 px-1 border-b-2 font-medium text-sm ${l==="history"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Historial de Compras"}),a.jsx("button",{onClick:()=>u("preferences"),className:`py-4 px-1 border-b-2 font-medium text-sm ${l==="preferences"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Preferencias"})]})}),a.jsxs("div",{className:"p-6",children:[b&&a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto mb-2"}),a.jsx("div",{className:"text-gray-600",children:"Cargando datos..."})]}),l==="info"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Información de Contacto"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Teléfono"}),a.jsx("p",{className:"text-gray-900",children:t.telefono||"No especificado"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),a.jsx("p",{className:"text-gray-900",children:t.email||"No especificado"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Dirección"}),a.jsx("p",{className:"text-gray-900",children:t.direccion||"No especificada"})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Información Personal"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Fecha de Nacimiento"}),a.jsxs("p",{className:"text-gray-900",children:[t.fechaNacimiento?P(t.fechaNacimiento):"No especificada",S&&a.jsxs("span",{className:"text-gray-500 ml-2",children:["(",S," años)"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cliente desde"}),a.jsx("p",{className:"text-gray-900",children:P(t.createdAt)})]})]})]})]}),t.tags&&t.tags.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((R,M)=>a.jsx("span",{className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm",children:R},M))})]}),t.notas&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Notas"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:t.notas})})]})]}),l==="history"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Historial de Compras"}),d.length>0?a.jsx("div",{className:"space-y-4",children:d.map(R=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"font-medium text-gray-900",children:["Venta #",R.saleNumber||R.id]}),a.jsx("p",{className:"text-sm text-gray-600",children:P(R.saleDate)})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-lg font-semibold text-green-600",children:N(R.total)}),a.jsx("div",{className:"text-sm text-gray-600",children:R.paymentMethod})]})]}),R.items&&R.items.length>0&&a.jsx("div",{className:"border-t border-gray-100 pt-3",children:a.jsx("div",{className:"space-y-2",children:R.items.map((M,$)=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{className:"text-gray-900",children:[M.name||M.productName,M.talle&&a.jsxs("span",{className:"text-gray-500",children:[" - ",M.talle]}),M.color&&a.jsxs("span",{className:"text-gray-500",children:[" - ",M.color]})]}),a.jsxs("span",{className:"text-gray-600",children:[M.quantity,"x ",N(M.price)]})]},$))})})]},R.id))}):a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),a.jsx("p",{children:"No hay compras registradas"})]})]}),l==="preferences"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Análisis de Preferencias"}),f?a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.preferences.topSizes.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Talles Más Comprados"}),a.jsx("div",{className:"space-y-2",children:f.preferences.topSizes.map((R,M)=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-900",children:R.size}),a.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm",children:[R.count," veces"]})]},M))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Estadísticas de Compra"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Valor promedio por compra:"}),a.jsx("span",{className:"font-medium",children:N(f.preferences.averageOrderValue)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Frecuencia de compra:"}),a.jsxs("span",{className:"font-medium",children:[f.preferences.purchaseFrequency," compras"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Última compra:"}),a.jsx("span",{className:"font-medium",children:f.preferences.lastPurchase?P(f.preferences.lastPurchase):"Nunca"})]})]})]})]}):a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),a.jsx("p",{children:"No hay suficientes datos para mostrar preferencias"})]})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[a.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cerrar"}),a.jsx("button",{onClick:()=>n(t),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Editar"}),a.jsx("button",{onClick:()=>s(t.id),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Eliminar"})]})]})})},h4=()=>{const{customers:t,loading:e,error:r,loadCustomers:n,searchCustomersByTerm:s,addCustomer:i,updateCustomerData:o,removeCustomer:l,clearSearch:u,getCustomerHistory:d,getCustomerAnalysis:h,getCustomerStatsLocal:f,getTopCustomersData:p}=c4(),[b,_]=T.useState(""),[k,P]=T.useState(!1),[N,w]=T.useState("recent"),[S,R]=T.useState(!1),[M,$]=T.useState(!1),[E,x]=T.useState(null),[v,y]=T.useState(null),[D,I]=T.useState([]);T.useEffect(()=>{n(),j()},[n]);const j=async()=>{try{const ee=await p(5);I(ee)}catch(ee){console.error("Error cargando top clientes:",ee)}},te=f(),B=async ee=>{_(ee),ee.trim()?(await s(ee),P(!0)):(await n(),P(!1))},V=()=>{_(""),P(!1),u(),n()},L=()=>{const ee=[...t];switch(N){case"name":return ee.sort((ue,ye)=>ue.nombre.localeCompare(ye.nombre));case"purchases":return ee.sort((ue,ye)=>(ye.totalCompras||0)-(ue.totalCompras||0));case"spending":return ee.sort((ue,ye)=>(ye.montoTotalGastado||0)-(ue.montoTotalGastado||0));case"recent":default:return ee.sort((ue,ye)=>{const tt=ue.ultimaCompra?ue.ultimaCompra.seconds?new Date(ue.ultimaCompra.seconds*1e3):new Date(ue.ultimaCompra):new Date(0);return(ye.ultimaCompra?ye.ultimaCompra.seconds?new Date(ye.ultimaCompra.seconds*1e3):new Date(ye.ultimaCompra):new Date(0))-tt})}},O=()=>{y(null),R(!0)},H=ee=>{y(ee),R(!0),$(!1)},q=ee=>{x(ee),$(!0)},J=async ee=>{try{v?await o(v.id,ee):await i(ee),R(!1),y(null),j()}catch(ue){console.error("Error al guardar cliente:",ue)}},A=async ee=>{if(confirm("¿Estás seguro de que deseas eliminar este cliente? Esta acción no se puede deshacer."))try{await l(ee),$(!1),x(null),j()}catch(ue){console.error("Error al eliminar cliente:",ue)}},Q=ee=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(ee||0),ae=ee=>ee?(ee.seconds?new Date(ee.seconds*1e3):new Date(ee)).toLocaleDateString("es-ES"):"Nunca",le=L();return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestión de Clientes"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Sistema CRM para gestión de clientes y análisis de preferencias"})]}),a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"flex gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx("input",{type:"text",placeholder:"Buscar por nombre, teléfono, email o tags...",value:b,onChange:ee=>B(ee.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})}),b&&a.jsx("button",{onClick:V,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Limpiar"})]})}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[a.jsxs("button",{onClick:O,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Agregar Cliente"]}),a.jsxs("select",{value:N,onChange:ee=>w(ee.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[a.jsx("option",{value:"recent",children:"Última compra"}),a.jsx("option",{value:"name",children:"Nombre A-Z"}),a.jsx("option",{value:"purchases",children:"Más compras"}),a.jsx("option",{value:"spending",children:"Mayor gasto"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[a.jsx("div",{className:"text-3xl font-bold text-red-600 mb-2",children:te.totalCustomers}),a.jsx("div",{className:"text-gray-600",children:"Total Clientes"})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[a.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:te.activeCustomers}),a.jsx("div",{className:"text-gray-600",children:"Clientes Activos"})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[a.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:te.newCustomers}),a.jsx("div",{className:"text-gray-600",children:"Nuevos este Mes"})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[a.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:Q(te.averageSpending)}),a.jsx("div",{className:"text-gray-600",children:"Gasto Promedio"})]})]}),r&&a.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("p",{className:"text-red-600",children:r})}),e&&a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto mb-2"}),a.jsx("div",{className:"text-gray-600",children:"Cargando clientes..."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Lista de Clientes",k&&a.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",le.length," resultados)"]})]})}),a.jsx("div",{className:"p-6",children:le.length>0?a.jsx("div",{className:"space-y-4",children:le.map(ee=>a.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ee.nombre}),a.jsxs("div",{className:"mt-2 space-y-1 text-sm text-gray-600",children:[ee.telefono&&a.jsxs("p",{children:["📞 ",ee.telefono]}),ee.email&&a.jsxs("p",{children:["✉️ ",ee.email]}),a.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[a.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:[ee.totalCompras||0," compras"]}),a.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs",children:Q(ee.montoTotalGastado)}),a.jsxs("span",{className:"text-gray-500 text-xs",children:["Última: ",ae(ee.ultimaCompra)]})]})]}),ee.tags&&ee.tags.length>0&&a.jsx("div",{className:"mt-3",children:a.jsxs("div",{className:"flex flex-wrap gap-1",children:[ee.tags.slice(0,3).map((ue,ye)=>a.jsx("span",{className:"bg-red-100 text-red-700 px-2 py-1 rounded text-xs",children:ue},ye)),ee.tags.length>3&&a.jsxs("span",{className:"text-xs text-gray-500",children:["+",ee.tags.length-3," más"]})]})})]}),a.jsxs("div",{className:"ml-4 flex flex-col gap-2",children:[a.jsx("button",{onClick:()=>q(ee),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Ver detalles"}),a.jsx("button",{onClick:()=>H(ee),className:"text-gray-500 hover:text-gray-700 text-sm",children:"Editar"})]})]})},ee.id))}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-4xl mb-4",children:"👥"}),a.jsx("p",{className:"text-gray-600 mb-2",children:k?"No se encontraron clientes":"No hay clientes registrados"}),a.jsx("p",{className:"text-sm text-gray-500",children:k?"Intenta con otros términos de búsqueda":"Agrega tu primer cliente para comenzar"}),!k&&a.jsx("button",{onClick:O,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Agregar Primer Cliente"})]})})]})}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Top Clientes"}),D.length>0?a.jsx("div",{className:"space-y-3",children:D.map((ee,ue)=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-red-100 text-red-600 rounded-full flex items-center justify-center text-sm font-medium",children:ue+1}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:ee.nombre}),a.jsxs("p",{className:"text-sm text-gray-600",children:[ee.totalCompras," compras"]})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("p",{className:"font-medium text-green-600",children:Q(ee.montoTotalGastado)})})]},ee.id))}):a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay datos suficientes"})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Resumen de Ingresos"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Total facturado:"}),a.jsx("span",{className:"font-medium text-green-600",children:Q(te.totalRevenue)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Promedio por cliente:"}),a.jsx("span",{className:"font-medium",children:Q(te.averageSpending)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Clientes activos:"}),a.jsxs("span",{className:"font-medium",children:[te.activeCustomers," de ",te.totalCustomers]})]})]})]})]})]}),a.jsx(u4,{customer:v,isOpen:S,onClose:()=>{R(!1),y(null)},onSave:J,loading:e}),a.jsx(d4,{customer:E,isOpen:M,onClose:()=>{$(!1),x(null)},onEdit:H,onDelete:A,onLoadHistory:d,onLoadAnalysis:h})]})},m4=({provider:t=null,isOpen:e,onClose:r,onSave:n,loading:s=!1})=>{const[i,o]=T.useState({proveedor:"",cuit:"",whattsapp:"",whattsapp2:"",catalogo:"",web:"",categoria:"",locales:[{direccion:"",area:"",galeria:"",pasillo:"",local:""}],tags:[],instagram:"",tiktok:"",calidad:"",precios:"",notas:"",talles:[]}),[l,u]=T.useState(""),[d,h]=T.useState(""),[f,p]=T.useState(""),b=["mujer","hombre","niños","niñas","bebes","juvenil","ambos","lenceria","importado"],_=["excelente","buena","media","mala"],k=["baratos","buenos","medios","razonable","caro"];T.useEffect(()=>{t&&(o({proveedor:t.proveedor||"",cuit:t.cuit||"",whattsapp:t.whattsapp||"",whattsapp2:t.whattsapp2||"",catalogo:t.catalogo||"",web:t.web||"",categoria:t.categoria||"",locales:t.locales&&t.locales.length>0?t.locales:[{direccion:"",area:"",galeria:"",pasillo:"",local:""}],tags:t.tags||[],instagram:t.instagram||"",tiktok:t.tiktok||"",calidad:t.calidad||"",precios:t.precios||"",notas:t.notas||"",talles:t.talles||[]}),h(t.talles?t.talles.join(", "):""))},[t]);const P=(y,D)=>{o(I=>({...I,[y]:D}))},N=(y,D,I)=>{const j=[...i.locales];j[y]={...j[y],[D]:I},o(te=>({...te,locales:j}))},w=()=>{o(y=>({...y,locales:[...y.locales,{direccion:"",area:"",galeria:"",pasillo:"",local:""}]}))},S=y=>{if(i.locales.length>1){const D=i.locales.filter((I,j)=>j!==y);o(I=>({...I,locales:D}))}},R=()=>{l.trim()&&!i.tags.includes(l.trim())&&(o(y=>({...y,tags:[...y.tags,l.trim()]})),u(""))},M=y=>{o(D=>({...D,tags:D.tags.filter(I=>I!==y)}))},$=y=>{h(y);const D=y.split(",").map(I=>I.trim()).filter(I=>I);o(I=>({...I,talles:D}))},E=y=>{o(D=>({...D,categoria:y})),p("")},x=()=>{f.trim()&&!b.includes(f.trim())&&E(f.trim())},v=y=>{if(y.preventDefault(),!i.proveedor.trim()){alert("El nombre del proveedor es requerido");return}const D=i.locales.filter(j=>j.direccion||j.area||j.galeria||j.pasillo||j.local),I={...i,locales:D.length>0?D:[{direccion:"",area:"",galeria:"",pasillo:"",local:""}]};n(I)};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Editar Proveedor":"Agregar Nuevo Proveedor"})}),a.jsxs("form",{onSubmit:v,className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Proveedor *"}),a.jsx("input",{type:"text",value:i.proveedor,onChange:y=>P("proveedor",y.target.value),className:"w-full input-rosema",placeholder:"Nombre del proveedor",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CUIT"}),a.jsx("input",{type:"text",value:i.cuit,onChange:y=>P("cuit",y.target.value),className:"w-full input-rosema",placeholder:"20-12345678-9"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Principal"}),a.jsx("input",{type:"text",value:i.whattsapp,onChange:y=>P("whattsapp",y.target.value),className:"w-full input-rosema",placeholder:"1123456789"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Alternativo"}),a.jsx("input",{type:"text",value:i.whattsapp2,onChange:y=>P("whattsapp2",y.target.value),className:"w-full input-rosema",placeholder:"1123456789"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Catálogo (Link)"}),a.jsx("input",{type:"url",value:i.catalogo,onChange:y=>P("catalogo",y.target.value),className:"w-full input-rosema",placeholder:"https://wa.me/c/..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Página Web"}),a.jsx("input",{type:"url",value:i.web,onChange:y=>P("web",y.target.value),className:"w-full input-rosema",placeholder:"https://..."})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría"}),a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsxs("select",{value:i.categoria,onChange:y=>E(y.target.value),className:"flex-1 input-rosema",children:[a.jsx("option",{value:"",children:"Seleccionar categoría existente"}),b.map(y=>a.jsx("option",{value:y,children:y},y))]}),a.jsx("input",{type:"text",value:f,onChange:y=>p(y.target.value),placeholder:"Nueva categoría",className:"flex-1 input-rosema"}),a.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"+Nueva"})]}),i.categoria&&a.jsxs("div",{className:"text-sm text-gray-600",children:["Categoría seleccionada: ",a.jsx("span",{className:"font-medium",children:i.categoria})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Locales"}),a.jsx("button",{type:"button",onClick:w,className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700",children:"Agregar Local"})]}),i.locales.map((y,D)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 mb-3",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsxs("h4",{className:"font-medium text-gray-900",children:["Local ",D+1]}),i.locales.length>1&&a.jsx("button",{type:"button",onClick:()=>S(D),className:"text-red-600 hover:text-red-800",children:"Eliminar"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[a.jsx("input",{type:"text",value:y.direccion,onChange:I=>N(D,"direccion",I.target.value),placeholder:"Dirección",className:"input-rosema"}),a.jsx("input",{type:"text",value:y.area,onChange:I=>N(D,"area",I.target.value),placeholder:"Área",className:"input-rosema"}),a.jsx("input",{type:"text",value:y.galeria,onChange:I=>N(D,"galeria",I.target.value),placeholder:"Galería",className:"input-rosema"}),a.jsx("input",{type:"text",value:y.pasillo,onChange:I=>N(D,"pasillo",I.target.value),placeholder:"Pasillo",className:"input-rosema"}),a.jsx("input",{type:"text",value:y.local,onChange:I=>N(D,"local",I.target.value),placeholder:"Local",className:"input-rosema"})]})]},D))]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsx("input",{type:"text",value:l,onChange:y=>u(y.target.value),onKeyPress:y=>y.key==="Enter"&&(y.preventDefault(),R()),placeholder:"Agregar tag",className:"flex-1 input-rosema"}),a.jsx("button",{type:"button",onClick:R,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Agregar"})]}),i.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:i.tags.map((y,D)=>a.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm flex items-center gap-1",children:[y,a.jsx("button",{type:"button",onClick:()=>M(y),className:"text-blue-600 hover:text-blue-800",children:"×"})]},D))})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Instagram"}),a.jsx("input",{type:"url",value:i.instagram,onChange:y=>P("instagram",y.target.value),className:"w-full input-rosema",placeholder:"https://www.instagram.com/..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"TikTok"}),a.jsx("input",{type:"url",value:i.tiktok,onChange:y=>P("tiktok",y.target.value),className:"w-full input-rosema",placeholder:"https://www.tiktok.com/..."})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Calidad"}),a.jsxs("select",{value:i.calidad,onChange:y=>P("calidad",y.target.value),className:"w-full input-rosema",children:[a.jsx("option",{value:"",children:"Seleccionar calidad"}),_.map(y=>a.jsx("option",{value:y,children:y},y))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precios"}),a.jsxs("select",{value:i.precios,onChange:y=>P("precios",y.target.value),className:"w-full input-rosema",children:[a.jsx("option",{value:"",children:"Seleccionar nivel de precios"}),k.map(y=>a.jsx("option",{value:y,children:y},y))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Talles"}),a.jsx("input",{type:"text",value:d,onChange:y=>$(y.target.value),className:"w-full input-rosema",placeholder:"Separar por comas: S, M, L, XL, 38, 40, 42"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Ingrese los talles separados por comas"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas"}),a.jsx("textarea",{value:i.notas,onChange:y=>P("notas",y.target.value),rows:3,className:"w-full input-rosema",placeholder:"Notas adicionales sobre el proveedor..."})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",disabled:s,children:"Cancelar"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",disabled:s,children:[s?"Guardando...":t?"Actualizar":"Crear"," Proveedor"]})]})]})]})}):null},f4=({provider:t,isOpen:e,onClose:r,onEdit:n,onDelete:s,productStats:i={totalComprados:0,totalVendidos:0}})=>{if(!e||!t)return null;const o=u=>u?`https://wa.me/${u.replace(/\D/g,"")}`:null,l=u=>u?u.startsWith("http")?u:`https://${u}`:null;return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.proveedor||"Proveedor sin nombre"}),t.categoria&&a.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium mt-2",children:t.categoria})]}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Estadísticas de Productos y Ventas"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.totalComprados||0}),a.jsx("div",{className:"text-sm text-gray-600",children:"Productos Comprados"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.totalVendidos||0}),a.jsx("div",{className:"text-sm text-gray-600",children:"Productos Vendidos"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.productosActivos||0}),a.jsx("div",{className:"text-sm text-gray-600",children:"Con Stock"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["$",(i.ingresosTotales||0).toLocaleString()]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Ingresos Totales"})]})]}),(i.ultimaCompra||i.ultimaVenta)&&a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.ultimaCompra&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Última Compra:"}),a.jsx("p",{className:"text-gray-900",children:new Date(i.ultimaCompra).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})})]}),i.ultimaVenta&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Última Venta:"}),a.jsx("p",{className:"text-gray-900",children:new Date(i.ultimaVenta).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})})]})]})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Información de Contacto"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.cuit&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CUIT"}),a.jsx("p",{className:"text-gray-900",children:t.cuit})]}),t.whattsapp&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp Principal"}),a.jsx("a",{href:o(t.whattsapp),target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800 hover:underline",children:t.whattsapp})]}),t.whattsapp2&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp Alternativo"}),a.jsx("a",{href:o(t.whattsapp2),target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800 hover:underline",children:t.whattsapp2})]}),t.web&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Página Web"}),a.jsx("a",{href:l(t.web),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline",children:t.web})]}),t.catalogo&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Catálogo"}),a.jsx("a",{href:t.catalogo,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline",children:"Ver catálogo"})]})]})]}),t.locales&&t.locales.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Locales"}),a.jsx("div",{className:"space-y-3",children:t.locales.map((u,d)=>u.direccion||u.area||u.galeria||u.pasillo||u.local?a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["Local ",d+1]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 text-sm",children:[u.direccion&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Dirección:"}),a.jsx("p",{className:"text-gray-900",children:u.direccion})]}),u.area&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Área:"}),a.jsx("p",{className:"text-gray-900",children:u.area})]}),u.galeria&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Galería:"}),a.jsx("p",{className:"text-gray-900",children:u.galeria})]}),u.pasillo&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Pasillo:"}),a.jsx("p",{className:"text-gray-900",children:u.pasillo})]}),u.local&&a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Local:"}),a.jsx("p",{className:"text-gray-900",children:u.local})]})]})]},d):null)})]}),t.tags&&t.tags.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((u,d)=>a.jsx("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:u},d))})]}),(t.instagram||t.tiktok)&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Redes Sociales"}),a.jsxs("div",{className:"flex gap-4",children:[t.instagram&&a.jsxs("a",{href:t.instagram,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-pink-600 hover:text-pink-800 hover:underline",children:[a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})}),"Instagram"]}),t.tiktok&&a.jsxs("a",{href:t.tiktok,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-black hover:text-gray-700 hover:underline",children:[a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"})}),"TikTok"]})]})]}),(t.calidad||t.precios)&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Evaluación"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.calidad&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Calidad"}),a.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${t.calidad==="excelente"?"bg-green-100 text-green-800":t.calidad==="buena"?"bg-blue-100 text-blue-800":t.calidad==="media"?"bg-yellow-100 text-yellow-800":t.calidad==="mala"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:t.calidad})]}),t.precios&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Precios"}),a.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${t.precios==="baratos"?"bg-green-100 text-green-800":t.precios==="buenos"?"bg-blue-100 text-blue-800":t.precios==="medios"||t.precios==="razonable"?"bg-yellow-100 text-yellow-800":t.precios==="caro"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:t.precios})]})]})]}),t.talles&&t.talles.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Talles Disponibles"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:t.talles.map((u,d)=>a.jsx("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded text-sm",children:u},d))})]}),t.notas&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Notas"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:t.notas})})]}),a.jsxs("div",{className:"text-sm text-gray-500 border-t border-gray-200 pt-4",children:[t.createdAt&&a.jsxs("p",{children:["Creado: ",new Date(t.createdAt.seconds*1e3).toLocaleDateString()]}),t.updatedAt&&a.jsxs("p",{children:["Última actualización: ",new Date(t.updatedAt.seconds*1e3).toLocaleDateString()]})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[a.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cerrar"}),a.jsx("button",{onClick:()=>n(t),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Editar"}),a.jsx("button",{onClick:()=>s(t.id),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Eliminar"})]})]})})},p4=()=>{const{providers:t,loading:e,error:r,categories:n,areas:s,galleries:i,loadProviders:o,searchProvidersByTerm:l,filterByCategory:u,filterByArea:d,filterByGallery:h,getProviderStatsLocal:f,getProviderProductStatistics:p,addProvider:b,updateProviderData:_,removeProvider:k,clearSearch:P}=Do(),[N,w]=T.useState(""),[S,R]=T.useState(!1),[M,$]=T.useState(""),[E,x]=T.useState(""),[v,y]=T.useState(""),[D,I]=T.useState(!1),[j,te]=T.useState(!1),[B,V]=T.useState(null),[L,O]=T.useState(null),[H,q]=T.useState({});T.useEffect(()=>{o()},[o]);const J=f(),A=async W=>{w(W),W.trim()?(await l(W),R(!0),$(""),x(""),y("")):(await o(),R(!1))},Q=()=>{w(""),R(!1),$(""),x(""),y(""),P(),o()},ae=async W=>{$(W),x(""),y(""),w(""),R(!0),W?await u(W):(await o(),R(!1))},le=async W=>{x(W),$(""),y(""),w(""),R(!0),W?await d(W):(await o(),R(!1))},ee=async W=>{y(W),$(""),x(""),w(""),R(!0),W?await h(W):(await o(),R(!1))},ue=()=>{O(null),I(!0)},ye=W=>{O(W),I(!0),te(!1)},tt=async W=>{V(W);try{const U=await p(W.id);q(U)}catch(U){console.error("Error al obtener estadísticas de productos:",U),q({totalComprados:0,totalVendidos:0})}te(!0)},Bt=async W=>{try{L?await _(L.id,W):await b(W),I(!1),O(null)}catch(U){console.error("Error al guardar proveedor:",U)}},xr=async W=>{if(confirm("¿Estás seguro de que deseas eliminar este proveedor? Esta acción no se puede deshacer."))try{await k(W),te(!1),V(null)}catch(U){console.error("Error al eliminar proveedor:",U)}},yr=()=>N?`Búsqueda: "${N}"`:M?`Categoría: ${M}`:E?`Área: ${E}`:v?`Galería: ${v}`:"";return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestión de Proveedores"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Sistema completo de gestión de proveedores"})]}),a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"flex gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx("input",{type:"text",placeholder:"Buscar por nombre, tags, talles o dirección...",value:N,onChange:W=>A(W.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})}),(N||M||E||v)&&a.jsx("button",{onClick:Q,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Limpiar"})]})}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[a.jsxs("button",{onClick:ue,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Agregar Proveedor"]}),a.jsxs("select",{value:M,onChange:W=>ae(W.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Todas las categorías"}),n.map(W=>a.jsx("option",{value:W,children:W},W))]}),a.jsxs("select",{value:E,onChange:W=>le(W.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Todas las áreas"}),s.map(W=>a.jsx("option",{value:W,children:W},W))]}),a.jsxs("select",{value:v,onChange:W=>ee(W.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Todas las galerías"}),i.map(W=>a.jsx("option",{value:W,children:W},W))]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[a.jsx("div",{className:"text-3xl font-bold text-red-600 mb-2",children:J.totalProviders}),a.jsx("div",{className:"text-gray-600",children:"Total Proveedores"})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[a.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:J.activeProviders}),a.jsx("div",{className:"text-gray-600",children:"Proveedores Activos"})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[a.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:Object.keys(J.areas).length}),a.jsx("div",{className:"text-gray-600",children:"Áreas Cubiertas"})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[a.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:Object.keys(J.tags).length}),a.jsx("div",{className:"text-gray-600",children:"Tags Únicos"})]})]}),r&&a.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:a.jsx("p",{className:"text-red-600",children:r})}),e&&a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto mb-2"}),a.jsx("div",{className:"text-gray-600",children:"Cargando proveedores..."})]}),!e&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Directorio de Proveedores",(S||M||E||v)&&a.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",t.length," resultados",yr()&&` - ${yr()}`,")"]})]})}),a.jsx("div",{className:"p-6",children:t.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(W=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:W.proveedor||"Sin Nombre"}),W.categoria&&a.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium mt-1",children:W.categoria})]}),a.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[W.locales&&W.locales[0]&&a.jsxs(a.Fragment,{children:[W.locales[0].area&&a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"Área:"})," ",W.locales[0].area]}),W.locales[0].direccion&&a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"Dirección:"})," ",W.locales[0].direccion]}),W.locales[0].galeria&&a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"Galería:"})," ",W.locales[0].galeria]})]}),W.whattsapp&&a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"WhatsApp:"})," ",W.whattsapp]}),W.web&&a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"Web:"}),a.jsx("a",{href:W.web,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline ml-1",children:"Ver sitio"})]}),a.jsxs("div",{className:"flex gap-2 mt-2",children:[W.calidad&&a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${W.calidad==="excelente"?"bg-green-100 text-green-800":W.calidad==="buena"?"bg-blue-100 text-blue-800":W.calidad==="media"?"bg-yellow-100 text-yellow-800":W.calidad==="mala"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:W.calidad}),W.precios&&a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${W.precios==="baratos"?"bg-green-100 text-green-800":W.precios==="buenos"?"bg-blue-100 text-blue-800":W.precios==="medios"||W.precios==="razonable"?"bg-yellow-100 text-yellow-800":W.precios==="caro"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:W.precios})]})]}),W.tags&&W.tags.length>0&&a.jsx("div",{className:"mt-3",children:a.jsxs("div",{className:"flex flex-wrap gap-1",children:[W.tags.slice(0,3).map((U,Y)=>a.jsx("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs",children:U},Y)),W.tags.length>3&&a.jsxs("span",{className:"text-xs text-gray-500",children:["+",W.tags.length-3," más"]})]})}),a.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("button",{onClick:()=>tt(W),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Ver detalles"}),a.jsx("button",{onClick:()=>ye(W),className:"text-gray-500 hover:text-gray-700 text-sm",children:"Editar"})]})})]},W.id))}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-4xl mb-4",children:"🏪"}),a.jsx("p",{className:"text-gray-600 mb-2",children:S||M||E||v?"No se encontraron proveedores":"No hay proveedores disponibles"}),a.jsx("p",{className:"text-sm text-gray-500",children:S||M||E||v?"Intenta con otros términos de búsqueda o filtros":"Agrega tu primer proveedor para comenzar"}),!S&&!M&&!E&&!v&&a.jsx("button",{onClick:ue,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Agregar Primer Proveedor"})]})})]}),Object.keys(J.tags).length>0&&a.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow-sm border p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Tags Más Utilizados"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(J.tags).sort(([,W],[,U])=>U-W).slice(0,15).map(([W,U])=>a.jsxs("span",{className:"bg-red-50 text-red-700 px-3 py-1 rounded-full text-sm border border-red-200 cursor-pointer hover:bg-red-100 transition-colors",onClick:()=>A(W),children:[W," (",U,")"]},W))})]}),Object.keys(J.areas).length>0&&a.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow-sm border p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Áreas con Más Proveedores"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(J.areas).sort(([,W],[,U])=>U-W).slice(0,6).map(([W,U])=>a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>le(W),children:[a.jsx("div",{className:"font-medium text-gray-900",children:W}),a.jsxs("div",{className:"text-sm text-gray-600",children:[U," proveedores"]})]},W))})]}),a.jsx(m4,{provider:L,isOpen:D,onClose:()=>{I(!1),O(null)},onSave:Bt,loading:e}),a.jsx(f4,{provider:B,isOpen:j,onClose:()=>{te(!1),V(null),q({})},onEdit:ye,onDelete:xr,productStats:H})]})},g4=()=>a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"🎯 Metas"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Objetivos comerciales y control de gastos"})]}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[a.jsxs("button",{className:"btn-rosema",children:[a.jsx("span",{className:"mr-2",children:"🎯"}),"Configurar Meta"]}),a.jsxs("button",{className:"btn-secondary",children:[a.jsx("span",{className:"mr-2",children:"💰"}),"Registrar Gasto"]}),a.jsxs("button",{className:"btn-secondary",children:[a.jsx("span",{className:"mr-2",children:"📊"}),"Ver Análisis"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Meta Diaria"}),a.jsx("div",{className:"text-3xl font-bold text-red-600 mb-2",children:"$0"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Objetivo configurado"}),a.jsx("div",{className:"mt-3 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-red-600 h-2 rounded-full",style:{width:"0%"}})}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"0% completado"})]}),a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Meta Semanal"}),a.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"$0"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Objetivo configurado"}),a.jsx("div",{className:"mt-3 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"0%"}})}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"0% completado"})]}),a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Meta Mensual"}),a.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"$0"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Objetivo configurado"}),a.jsx("div",{className:"mt-3 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"0%"}})}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"0% completado"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"card-rosema",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Gastos Fijos Mensuales (Etapa 7)"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-red-500 mr-2",children:"🏠"}),a.jsx("span",{className:"text-gray-700",children:"Alquiler"})]}),a.jsx("span",{className:"font-medium text-gray-900",children:"$0"})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-yellow-500 mr-2",children:"💡"}),a.jsx("span",{className:"text-gray-700",children:"Servicios (luz, agua, etc.)"})]}),a.jsx("span",{className:"font-medium text-gray-900",children:"$0"})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-blue-500 mr-2",children:"👥"}),a.jsx("span",{className:"text-gray-700",children:"Empleados"})]}),a.jsx("span",{className:"font-medium text-gray-900",children:"$0"})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-purple-500 mr-2",children:"📱"}),a.jsx("span",{className:"text-gray-700",children:"Membresías"})]}),a.jsx("span",{className:"font-medium text-gray-900",children:"$0"})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-gray-500 mr-2",children:"📋"}),a.jsx("span",{className:"text-gray-700",children:"Otros gastos operativos"})]}),a.jsx("span",{className:"font-medium text-gray-900",children:"$0"})]})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-semibold text-gray-900",children:"Total Gastos Fijos:"}),a.jsx("span",{className:"font-bold text-red-600 text-lg",children:"$0"})]})})]}),a.jsxs("div",{className:"card-rosema",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Análisis Financiero"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-green-800 font-medium",children:"Ganancias Reales"}),a.jsx("span",{className:"text-green-600 font-bold",children:"$0"})]}),a.jsx("div",{className:"text-sm text-green-700",children:"Ventas - Costos - Gastos Fijos"})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-blue-800 font-medium",children:"Excedente Disponible"}),a.jsx("span",{className:"text-blue-600 font-bold",children:"$0"})]}),a.jsx("div",{className:"text-sm text-blue-700",children:"Para nuevas inversiones"})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-yellow-800 font-medium",children:"Meta Excedente"}),a.jsx("span",{className:"text-yellow-600 font-bold",children:"$2.000.000"})]}),a.jsx("div",{className:"text-sm text-yellow-700",children:"Mínimo recomendado (configurable)"})]})]})]})]}),a.jsxs("div",{className:"card-rosema mt-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Indicador de Inversión"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[a.jsx("div",{className:"text-4xl mb-4",children:"⚠️"}),a.jsx("p",{className:"text-gray-600 mb-2",children:a.jsx("strong",{children:"Excedente insuficiente para nuevas compras"})}),a.jsx("p",{className:"text-sm text-gray-500",children:"Se requiere un excedente mínimo de $2.000.000 antes de realizar nuevas inversiones"}),a.jsx("div",{className:"mt-4 bg-red-100 border border-red-200 rounded-lg p-3",children:a.jsxs("p",{className:"text-red-800 text-sm",children:["🚫 ",a.jsx("strong",{children:"Recomendación:"})," Enfocarse en ventas antes de comprar más inventario"]})})]})]}),a.jsxs("div",{className:"card-rosema mt-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Configuración de Metas"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[a.jsx("div",{className:"text-4xl mb-4",children:"🎯"}),a.jsx("p",{className:"text-gray-600",children:"La configuración de metas se implementará en la Etapa 7"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Incluirá formularios para establecer objetivos y registrar gastos"})]})]})]}),x4=()=>a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"📄 Facturas ARCA"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Sistema de facturación electrónica"})]}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[a.jsxs("button",{className:"btn-rosema",children:[a.jsx("span",{className:"mr-2",children:"➕"}),"Nueva Factura"]}),a.jsxs("button",{className:"btn-secondary",children:[a.jsx("span",{className:"mr-2",children:"📤"}),"Subir a ARCA"]}),a.jsxs("button",{className:"btn-secondary",children:[a.jsx("span",{className:"mr-2",children:"📋"}),"Ver Historial"]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"card-rosema",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Sistema de Facturación (Etapa 8)"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"✅"}),"CRUD completo de facturas"]}),a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"✅"}),"Almacenamiento de PDF en Firebase Storage"]}),a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"✅"}),"Registro automático para pagos electrónicos"]}),a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"✅"}),"Preparación de datos para ARCA"]}),a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("span",{className:"text-green-500 mr-2",children:"✅"}),"Integración con sistema tributario"]})]})]}),a.jsxs("div",{className:"card-rosema",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Facturación Automática"}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-2xl mr-3",children:"💳"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-blue-900",children:"Tarjeta Débito"}),a.jsx("div",{className:"text-sm text-blue-700",children:"Facturación automática"})]})]})}),a.jsx("div",{className:"bg-purple-50 border border-purple-200 p-3 rounded-lg",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-2xl mr-3",children:"💎"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-purple-900",children:"Tarjeta Crédito"}),a.jsx("div",{className:"text-sm text-purple-700",children:"Facturación automática"})]})]})}),a.jsx("div",{className:"bg-green-50 border border-green-200 p-3 rounded-lg",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"text-2xl mr-3",children:"📱"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-green-900",children:"Código QR"}),a.jsx("div",{className:"text-sm text-green-700",children:"Facturación automática"})]})]})})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mt-6",children:[a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-red-600 mb-2",children:"0"}),a.jsx("div",{className:"text-gray-600",children:"Facturas Este Mes"})]}),a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"$0"}),a.jsx("div",{className:"text-gray-600",children:"Total Facturado"})]}),a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"0"}),a.jsx("div",{className:"text-gray-600",children:"Subidas a ARCA"})]}),a.jsxs("div",{className:"card-rosema text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-yellow-600 mb-2",children:"0"}),a.jsx("div",{className:"text-gray-600",children:"Pendientes"})]})]}),a.jsxs("div",{className:"card-rosema mt-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Historial de Facturas"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[a.jsx("div",{className:"text-4xl mb-4",children:"📄"}),a.jsx("p",{className:"text-gray-600",children:"El historial de facturas se mostrará aquí una vez implementado"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Incluirá búsqueda, filtros y descarga de PDFs"})]})]}),a.jsxs("div",{className:"card-rosema mt-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Integración con ARCA"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-red-900 mb-2",children:"🔴 Estado Actual"}),a.jsx("p",{className:"text-sm text-red-700",children:"Sistema no conectado con ARCA"}),a.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Configuración pendiente para Etapa 8"})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"🔵 Próximas Funciones"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[a.jsx("li",{children:"• Conexión API ARCA"}),a.jsx("li",{children:"• Subida automática de facturas"}),a.jsx("li",{children:"• Validación tributaria"}),a.jsx("li",{children:"• Reportes fiscales"})]})]})]})]}),a.jsxs("div",{className:"card-rosema mt-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"⚠️ Información Importante"}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg",children:[a.jsx("p",{className:"text-yellow-800 mb-2",children:a.jsx("strong",{children:"Requisitos para la integración con ARCA:"})}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[a.jsx("li",{children:"• Certificado digital válido"}),a.jsx("li",{children:"• Credenciales de acceso a ARCA"}),a.jsx("li",{children:"• Configuración de datos fiscales de la empresa"}),a.jsx("li",{children:"• Validación de productos y servicios"})]})]})]})]});function y4(){const{isAuthenticated:t,loading:e}=Cu(),r=!1;return e&&!r?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-red-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Cargando Rosema POS..."}),a.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Verificando autenticación"})]})}):a.jsx("div",{className:"App",children:a.jsxs(eS,{children:[a.jsx(Rt,{path:"/login",element:t&&!r?a.jsx(Ol,{to:"/",replace:!0}):a.jsx(NR,{})}),r,t||r?a.jsxs(Rt,{path:"/",element:a.jsx(bR,{}),children:[a.jsx(Rt,{index:!0,element:a.jsx(GR,{})}),a.jsx(Rt,{path:"statistics",element:a.jsx(KR,{})}),a.jsx(Rt,{path:"sales",element:a.jsx(HD,{})}),a.jsx(Rt,{path:"sales-new",element:a.jsx(QD,{})}),a.jsx(Rt,{path:"products",element:a.jsx(l4,{})}),a.jsx(Rt,{path:"customers",element:a.jsx(h4,{})}),a.jsx(Rt,{path:"suppliers",element:a.jsx(p4,{})}),a.jsx(Rt,{path:"goals",element:a.jsx(g4,{})}),a.jsx(Rt,{path:"invoices",element:a.jsx(x4,{})})]}):a.jsx(Rt,{path:"*",element:a.jsx(Ol,{to:"/login",replace:!0})}),a.jsx(Rt,{path:"*",element:a.jsx(Ol,{to:t||r?"/":"/login",replace:!0})})]})})}Ld.createRoot(document.getElementById("root")).render(a.jsx(Zx.StrictMode,{children:a.jsx(lS,{children:a.jsx(y4,{})})}));
//# sourceMappingURL=index-BqMkk_e5.js.map
